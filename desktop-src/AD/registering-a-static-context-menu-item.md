---
title: Registrazione di una voce di menu di scelta rapida statica
description: In questo argomento viene descritta la registrazione di una voce di menu di scelta rapida statica visualizzata per oggetti Active Directory.
ms.assetid: ed945812-3adb-4058-bdb6-8d9d34468265
ms.tgt_platform: multiple
keywords:
- Registrazione di una voce di menu di scelta rapida statica AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 89e3ee5336061ca296e2c94f8907ebd385610494
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "106299560"
---
# <a name="registering-a-static-context-menu-item"></a><span data-ttu-id="f9786-104">Registrazione di una voce di menu di scelta rapida statica</span><span class="sxs-lookup"><span data-stu-id="f9786-104">Registering a Static Context Menu Item</span></span>

<span data-ttu-id="f9786-105">Gli snap-in di MMC amministrativi di Active Directory Domain Services e la shell di Windows forniscono un meccanismo per aggiungere un elemento al menu di scelta rapida visualizzato per gli oggetti in Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="f9786-105">The administrative MMC snap-ins of Active Directory Domain Services and the Windows shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.</span></span> <span data-ttu-id="f9786-106">Il menu di scelta rapida può richiamare qualsiasi file che può essere avviato con l'API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , ad esempio l'URL di un'applicazione o di una pagina Web.</span><span class="sxs-lookup"><span data-stu-id="f9786-106">The context menu can invoke any file that can be started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="f9786-107">Registrazione con Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="f9786-107">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="f9786-108">La registrazione dell'estensione del menu di scelta rapida è specifica di un'impostazione locale.</span><span class="sxs-lookup"><span data-stu-id="f9786-108">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="f9786-109">Se l'estensione del menu di scelta rapida si applica a tutte le impostazioni locali, deve essere registrata nell'oggetto [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) della classe di oggetti in tutti i sottocontenitori delle impostazioni locali nel contenitore degli identificatori di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="f9786-109">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="f9786-110">Se l'estensione del menu di scelta rapida è localizzata per determinate impostazioni locali, deve essere registrata nell'oggetto **displaySpecifier** nel sottocontenitore delle impostazioni locali.</span><span class="sxs-lookup"><span data-stu-id="f9786-110">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale subcontainer.</span></span> <span data-ttu-id="f9786-111">Per ulteriori informazioni sul contenitore e le impostazioni locali per gli identificatori di visualizzazione, vedere la pagina relativa agli [identificatori di visualizzazione](display-specifiers.md) e al [contenitore DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="f9786-111">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="f9786-112">Sono disponibili due attributi per gli identificatori di visualizzazione in cui è possibile registrare una voce di menu di scelta rapida statica, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) e [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="f9786-112">There are two display specifier attributes that a static context menu item can be registered under, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="f9786-113">L'attributo [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) identifica i menu di scelta rapida amministrativi da visualizzare negli snap-in amministrativi del Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="f9786-113">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in the administrative snap-ins of Active Directory Domain Services.</span></span> <span data-ttu-id="f9786-114">Il menu di scelta rapida viene visualizzato quando l'utente Visualizza il menu di scelta rapida per gli oggetti della classe appropriata in uno degli snap-in MMC amministrativi.</span><span class="sxs-lookup"><span data-stu-id="f9786-114">The context menu appears when the user displays the context menu for objects of the appropriate class in one of the administrative MMC snap-ins.</span></span>

<span data-ttu-id="f9786-115">L'attributo [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) identifica i menu di scelta rapida dell'utente finale da visualizzare nella shell di Windows.</span><span class="sxs-lookup"><span data-stu-id="f9786-115">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="f9786-116">Il menu di scelta rapida viene visualizzato quando l'utente Visualizza il menu di scelta rapida per gli oggetti della classe appropriata in Esplora risorse.</span><span class="sxs-lookup"><span data-stu-id="f9786-116">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="f9786-117">A partire da Windows Server 2003, la shell di Windows non Visualizza più gli oggetti provenienti da Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="f9786-117">Beginning with Windows Server 2003, the Windows shell no longer displays objects that are from Active Directory Domain Services.</span></span>

<span data-ttu-id="f9786-118">Tutti questi attributi sono multivalore.</span><span class="sxs-lookup"><span data-stu-id="f9786-118">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="f9786-119">Quando si registra una voce di menu di scelta rapida statica, i valori per gli attributi [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) e [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) richiedono il formato seguente.</span><span class="sxs-lookup"><span data-stu-id="f9786-119">When registering a static context menu item, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<menu text>,<command>
```



<span data-ttu-id="f9786-120">Il " &lt; numero &gt; di ordine" è un numero senza segno che rappresenta la posizione dell'elemento nel menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="f9786-120">The "&lt;order number&gt;" is an unsigned number that represents the item's position in the context menu.</span></span> <span data-ttu-id="f9786-121">Quando viene visualizzato un menu di scelta rapida, i valori vengono ordinati usando un confronto tra il " &lt; numero di ordine" di ogni valore &gt; .</span><span class="sxs-lookup"><span data-stu-id="f9786-121">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="f9786-122">Se più di un valore ha lo stesso " &lt; numero &gt; di ordine", le estensioni del menu di scelta rapida vengono caricate nell'ordine in cui vengono lette dal server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f9786-122">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="f9786-123">Se possibile, usare un " &lt; numero di ordine" non esistente &gt; , ovvero uno che non è stato usato da altri valori nella proprietà.</span><span class="sxs-lookup"><span data-stu-id="f9786-123">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="f9786-124">Non esiste una posizione di inizio prescritta e sono consentiti gap nella &lt; sequenza "Order Number &gt; ".</span><span class="sxs-lookup"><span data-stu-id="f9786-124">There is no prescribed starting position, and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="f9786-125">Il " &lt; testo &gt; di menu" è la stringa visualizzata nel menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="f9786-125">The "&lt;menu text&gt;" is the string displayed in the context menu.</span></span> <span data-ttu-id="f9786-126">Il " &lt; testo &gt; di menu" può includere un carattere "&" che precede il tasto di scelta rapida per la voce di menu.</span><span class="sxs-lookup"><span data-stu-id="f9786-126">The "&lt;menu text&gt;" can include one "&" character that precedes the keyboard shortcut character for the menu item.</span></span> <span data-ttu-id="f9786-127">In questo modo il carattere preceduto sarà sottolineato.</span><span class="sxs-lookup"><span data-stu-id="f9786-127">This will cause the preceded character to be underlined.</span></span> <span data-ttu-id="f9786-128">Se ad esempio il " &lt; testo del menu &gt; " è "&file", il testo del menu verrà visualizzato come "file", la "f" sarà sottolineata e "f" sarà il tasto di scelta rapida per la voce di menu.</span><span class="sxs-lookup"><span data-stu-id="f9786-128">For example, if the "&lt;menu text&gt;" is "&File", the menu text will be displayed as "File", the "F" will be underlined and "F" will be the keyboard shortcut for the menu item.</span></span>

<span data-ttu-id="f9786-129">Il " &lt; comando &gt; " è il programma o il file eseguito dallo snap-in.</span><span class="sxs-lookup"><span data-stu-id="f9786-129">The "&lt;command&gt;" is the program or file executed by the snap-in.</span></span> <span data-ttu-id="f9786-130">È necessario specificare il percorso completo oppure il file deve essere presente nella variabile di ambiente percorso computer.</span><span class="sxs-lookup"><span data-stu-id="f9786-130">Either the full path must be specified or the file must exist in the computer path environment variable.</span></span> <span data-ttu-id="f9786-131">Il file viene richiamato usando la funzione [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) .</span><span class="sxs-lookup"><span data-stu-id="f9786-131">The file is invoked using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) function.</span></span> <span data-ttu-id="f9786-132">Il " &lt; comando &gt; " non può contenere parametri aggiuntivi, ad esempio Notepad.exe Myfile.txt.</span><span class="sxs-lookup"><span data-stu-id="f9786-132">The "&lt;command&gt;" cannot contain additional parameters, for example, Notepad.exe Myfile.txt.</span></span> <span data-ttu-id="f9786-133">Poiché viene usato **ShellExecute** , è possibile usare qualsiasi file o indirizzo che può essere passato a **ShellExecute** per " &lt; Command &gt; ".</span><span class="sxs-lookup"><span data-stu-id="f9786-133">Because **ShellExecute** is used, any file or address that can be passed to **ShellExecute** can be used for "&lt;command&gt;".</span></span> <span data-ttu-id="f9786-134">Se, ad esempio, " &lt; Command &gt; " contiene "d: \\file.txt", d: \\file.txt verrà aperto con l'applicazione associata all'estensione txt.</span><span class="sxs-lookup"><span data-stu-id="f9786-134">For example, if "&lt;command&gt;" contains "d:\\file.txt", d:\\file.txt will be opened with the application associated with the .txt extension.</span></span> <span data-ttu-id="f9786-135">Analogamente, se " &lt; Command &gt; " contiene " https://www.fabrikam.com ", viene aperto il Web browser predefinito e verrà visualizzata la pagina Web specificata.</span><span class="sxs-lookup"><span data-stu-id="f9786-135">Likewise, if "&lt;command&gt;" contains "https://www.fabrikam.com", the default web browser is opened and will display the specified webpage.</span></span> <span data-ttu-id="f9786-136">Sono consentiti percorsi e nomi di applicazioni con spazi.</span><span class="sxs-lookup"><span data-stu-id="f9786-136">Paths and application names with spaces are allowed.</span></span> <span data-ttu-id="f9786-137">Se " &lt; Command &gt; " è un'applicazione, le ADsPath e la classe dell'oggetto selezionato vengono passate come argomenti della riga di comando, separate da uno spazio.</span><span class="sxs-lookup"><span data-stu-id="f9786-137">If "&lt;command&gt;" is an application, the selected object's ADsPath and class are passed as command line arguments, separated by a space.</span></span>

<span data-ttu-id="f9786-138">Nella shell di Windows sono supportate le voci del menu di scelta rapida a selezione multipla.</span><span class="sxs-lookup"><span data-stu-id="f9786-138">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="f9786-139">In questo caso, &lt; &gt; viene richiamato "Command" per ogni oggetto selezionato.</span><span class="sxs-lookup"><span data-stu-id="f9786-139">In this case, the "&lt;command&gt;" is invoked for each selected object.</span></span> <span data-ttu-id="f9786-140">In Active Directory Domain Services gli snap-in di amministrazione, le voci del menu di scelta rapida statico a selezione multipla non sono supportate.</span><span class="sxs-lookup"><span data-stu-id="f9786-140">In Active Directory Domain Services' administrative snap-ins, multiple-selection static context menu items are not supported.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f9786-141">Per la shell di Windows, i dati dell'identificatore di visualizzazione vengono recuperati all'accesso dell'utente e memorizzati nella cache per la sessione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="f9786-141">For the Windows shell, display specifier data is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="f9786-142">Per gli snap-in amministrativi, i dati dell'identificatore di visualizzazione vengono recuperati quando lo snap-in viene caricato e viene memorizzato nella cache per la durata del processo.</span><span class="sxs-lookup"><span data-stu-id="f9786-142">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="f9786-143">Per la shell di Windows, ciò significa che le modifiche apportate agli identificatori di visualizzazione diventano effettive dopo che un utente si disconnette e si riaccende.</span><span class="sxs-lookup"><span data-stu-id="f9786-143">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="f9786-144">Per gli snap-in amministrativi, le modifiche diventano effettive quando lo snap-in o il file della console viene ricaricato; ovvero, se si avvia una nuova istanza del file di console o di una nuova istanza di Mmc.exe e si aggiunge lo snap-in, vengono recuperati i dati degli identificatori di visualizzazione più recenti.</span><span class="sxs-lookup"><span data-stu-id="f9786-144">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded; that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="f9786-145">Per ulteriori informazioni e un esempio di codice, vedere [codice di esempio per l'installazione di una voce di menu di scelta rapida statica](example-code-for-installing-a-static-context-menu-item.md).</span><span class="sxs-lookup"><span data-stu-id="f9786-145">For more information, and a code example, see [Example Code for Installing a Static Context Menu Item](example-code-for-installing-a-static-context-menu-item.md).</span></span>

 

 