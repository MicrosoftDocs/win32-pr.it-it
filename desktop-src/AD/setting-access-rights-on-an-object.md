---
title: Impostazione dei diritti di accesso per un oggetto
description: In questo argomento viene descritto come creare una voce ACE per un diritto di accesso e impostare tale voce sull'elenco DACL di un oggetto.
ms.assetid: c0b45709-4652-46c7-8d52-44076802d109
ms.tgt_platform: multiple
keywords:
- Impostazione dei diritti di accesso per un annuncio di un oggetto
- Oggetti AD, impostazione dei diritti di accesso per un oggetto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2bcf54de381dab2af1dab4ea44654fb0a5682f06
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "104472467"
---
# <a name="setting-access-rights-on-an-object"></a><span data-ttu-id="e3892-105">Impostazione dei diritti di accesso per un oggetto</span><span class="sxs-lookup"><span data-stu-id="e3892-105">Setting Access Rights on an Object</span></span>

<span data-ttu-id="e3892-106">Quando si usano gli oggetti ADSI COM [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (descrittore di sicurezza), [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (DACL e SACL) e [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) per aggiungere una voce ACE a un ACL, si apportano modifiche alla proprietà **ntSecurityDescriptor** dell'oggetto specificato nella cache delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="e3892-106">When using the ADSI COM objects [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (security descriptor), [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (DACLs and SACLs), and [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) to add an ACE to a ACL, you are making changes to the **nTSecurityDescriptor** property of the specified object in the property cache.</span></span> <span data-ttu-id="e3892-107">Ciò significa che è necessario chiamare i metodi sugli oggetti che contengono la nuova voce ACE e il metodo [**IADs. Seinfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) per scrivere il descrittore di sicurezza aggiornato nella directory dalla cache delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="e3892-107">This means put methods on the objects that contain the new ACE and the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method must be called in order to write the updated security descriptor to the directory from the property cache.</span></span>

<span data-ttu-id="e3892-108">Per ulteriori informazioni e un esempio di codice che imposta una voce ACE su un oggetto in Active Directory Domain Services, vedere il [codice di esempio per l'impostazione di una voce ACE in un oggetto directory](example-code-for-setting-an-ace-on-a-directory-object.md).</span><span class="sxs-lookup"><span data-stu-id="e3892-108">For more information and a code example that sets an ACE on an object in Active Directory Domain Services, see [Example Code for Setting an ACE on a Directory Object](example-code-for-setting-an-ace-on-a-directory-object.md).</span></span>

<span data-ttu-id="e3892-109">Utilizzare il seguente processo generale per creare una voce ACE per un diritto di accesso e impostare tale voce sull'elenco DACL di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="e3892-109">Use the following general process to create an ACE for an access right and setting that ACE on the DACL of an object.</span></span>

1.  <span data-ttu-id="e3892-110">Ottiene un puntatore di interfaccia [**IADs**](/windows/desktop/api/iads/nn-iads-iads) all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="e3892-110">Get an [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface pointer to the object.</span></span>
2.  <span data-ttu-id="e3892-111">Usare il metodo [**IADs. Get**](/windows/desktop/api/iads/nf-iads-iads-get) per ottenere il descrittore di sicurezza dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="e3892-111">Use the [**IADs.Get**](/windows/desktop/api/iads/nf-iads-iads-get) method to get the security descriptor of the object.</span></span> <span data-ttu-id="e3892-112">Il nome della proprietà che contiene il descrittore di sicurezza è **ntSecurityDescriptor**.</span><span class="sxs-lookup"><span data-stu-id="e3892-112">The name of the property containing the security descriptor is **nTSecurityDescriptor**.</span></span> <span data-ttu-id="e3892-113">La proprietà verrà restituita come [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) contenente un puntatore [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (il membro **VT** è **VT \_ Dispatch**).</span><span class="sxs-lookup"><span data-stu-id="e3892-113">The property will be returned as a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) containing an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer (the **vt** member is **VT\_DISPATCH**).</span></span> <span data-ttu-id="e3892-114">Chiamare **QueryInterface** su tale puntatore **IDispatch** per ottenere un'interfaccia [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) per usare i metodi su tale interfaccia per accedere all'ACL del descrittore di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="e3892-114">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) interface to use the methods on that interface to access the security descriptor's ACL.</span></span>
3.  <span data-ttu-id="e3892-115">Usare la proprietà [**IADsSecurityDescriptor. DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) per ottenere l'elenco DACL.</span><span class="sxs-lookup"><span data-stu-id="e3892-115">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to get the DACL.</span></span> <span data-ttu-id="e3892-116">Il metodo restituisce un puntatore [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="e3892-116">The method returns an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="e3892-117">Chiamare **QueryInterface** su tale puntatore **IDispatch** per ottenere un'interfaccia [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) per usare i metodi su tale interfaccia per accedere alle singole voci ACE nell'ACL.</span><span class="sxs-lookup"><span data-stu-id="e3892-117">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) interface to use the methods on that interface to access the individual ACEs in the ACL.</span></span>
4.  <span data-ttu-id="e3892-118">Utilizzare [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) per creare l'oggetto ADSI com per la nuova voce ACE e ottenere un puntatore di interfaccia [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) a tale oggetto.</span><span class="sxs-lookup"><span data-stu-id="e3892-118">Use [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to create the ADSI COM object for the new ACE and get an [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface pointer to that object.</span></span> <span data-ttu-id="e3892-119">Tenere presente che l'ID di classe è CLSID \_ AccessControlEntry.</span><span class="sxs-lookup"><span data-stu-id="e3892-119">Be aware that the class ID is CLSID\_AccessControlEntry.</span></span>
5.  <span data-ttu-id="e3892-120">Impostare le proprietà della voce ACE usando i metodi [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) :</span><span class="sxs-lookup"><span data-stu-id="e3892-120">Set the properties of the ACE using the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) methods:</span></span>

    1.  <span data-ttu-id="e3892-121">Usare [**IADsAccessControlEntry::p il \_ trustee UT**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per impostare il trustee a cui si applica questa voce ACE.</span><span class="sxs-lookup"><span data-stu-id="e3892-121">Use [**IADsAccessControlEntry::put\_Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) to set the trustee to whom this ACE applies.</span></span> <span data-ttu-id="e3892-122">Il fiduciario è un utente, un gruppo o un'altra entità di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="e3892-122">The trustee is a user, group, or other security principal.</span></span> <span data-ttu-id="e3892-123">L'applicazione deve usare il valore della proprietà appropriata dall'oggetto utente o gruppo del trustee a cui si vuole applicare la voce ACE.</span><span class="sxs-lookup"><span data-stu-id="e3892-123">Your application should use the value from the appropriate property from the user or group object of the trustee to which you want to apply the ACE.</span></span> <span data-ttu-id="e3892-124">Il trustee viene specificato come **BSTR** e può assumere le forme seguenti:</span><span class="sxs-lookup"><span data-stu-id="e3892-124">The trustee is specified as a **BSTR** and can take the following forms:</span></span>
        -   <span data-ttu-id="e3892-125">Account di dominio (il nome di accesso utilizzato in una versione precedente di Windows NT) nel formato " <domain> \\ <user account> ", dove " &lt; dominio &gt; " è il nome del dominio Windows NT che contiene l'utente e " &lt; account utente &gt; " è la proprietà **sAMAccountName** dell'utente specificato.</span><span class="sxs-lookup"><span data-stu-id="e3892-125">Domain account (the logon name used in a previous version of Windows NT) of the form "<domain>\\<user account>" where "&lt;domain&gt;" is the name of the Windows NT domain that contains the user and "&lt;user account&gt;" is the **sAMAccountName** property of the specified user.</span></span> <span data-ttu-id="e3892-126">Ad esempio: "Fabrikam \\ SergioMelchiori".</span><span class="sxs-lookup"><span data-stu-id="e3892-126">For example: "fabrikam\\jeffsmith".</span></span>
        -   <span data-ttu-id="e3892-127">Entità di sicurezza nota che rappresenta le identità speciali definite dal sistema di sicurezza di Windows NT, ad esempio Everyone, sistema locale, entità autonoma, utente autenticato, proprietario dell'autore e così via.</span><span class="sxs-lookup"><span data-stu-id="e3892-127">Well-known security principal that represents special identities defined by the Windows NT security system, such as everyone, local system, principal self, authenticated user, creator owner, and so on.</span></span> <span data-ttu-id="e3892-128">Gli oggetti che rappresentano le entità di sicurezza note vengono archiviati nel contenitore delle entità di sicurezza noto sotto il contenitore di configurazione.</span><span class="sxs-lookup"><span data-stu-id="e3892-128">The objects representing the well-known security principals are stored in the Well Known Security Principals container beneath the Configuration container.</span></span> <span data-ttu-id="e3892-129">Ad esempio, accesso anonimo.</span><span class="sxs-lookup"><span data-stu-id="e3892-129">For example, anonymous logon.</span></span>
        -   <span data-ttu-id="e3892-130">Gruppo incorporato che rappresenta i gruppi di utenti predefiniti definiti dal sistema di sicurezza di Windows NT.</span><span class="sxs-lookup"><span data-stu-id="e3892-130">Built-in group that represent the built-in user groups defined by the Windows NT security system.</span></span> <span data-ttu-id="e3892-131">Il formato è "BUILTin \\ <group name> ", dove " &lt; nome gruppo &gt; " è il nome del gruppo di utenti predefinito.</span><span class="sxs-lookup"><span data-stu-id="e3892-131">It has the form "BUILTIN\\<group name>" where "&lt;group name&gt;" is the name of the built-in user group.</span></span> <span data-ttu-id="e3892-132">Gli oggetti che rappresentano i gruppi predefiniti vengono archiviati nel contenitore incorporato sotto il contenitore di dominio.</span><span class="sxs-lookup"><span data-stu-id="e3892-132">The objects representing the built-in groups are stored in the Builtin container beneath the domain container.</span></span> <span data-ttu-id="e3892-133">Ad esempio, "BUILTin \\ Administrators".</span><span class="sxs-lookup"><span data-stu-id="e3892-133">For example, "BUILTIN\\Administrators".</span></span>
        -   <span data-ttu-id="e3892-134">SID (formato stringa) dell'utente specificato, ovvero la proprietà **objectSID** dell'utente specificato.</span><span class="sxs-lookup"><span data-stu-id="e3892-134">SID (string format) of the specified user, which is the **objectSID** property of the specified user.</span></span> <span data-ttu-id="e3892-135">È possibile eseguire la conversione in formato stringa usando la funzione [**ConvertSidToStringSid**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) nell'API di sicurezza Win32.</span><span class="sxs-lookup"><span data-stu-id="e3892-135">You can convert to string form using the [**ConvertSidToStringSid**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) function in the Win32 Security API.</span></span> <span data-ttu-id="e3892-136">Ad esempio: "S-1-5-32-548".</span><span class="sxs-lookup"><span data-stu-id="e3892-136">For example: "S-1-5-32-548".</span></span>
    2.  <span data-ttu-id="e3892-137">Usare la proprietà [**IADsAccessControlEntry. AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per impostare la maschera che specifica il diritto di accesso.</span><span class="sxs-lookup"><span data-stu-id="e3892-137">Use the [**IADsAccessControlEntry.AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to set the mask that specifies the access right.</span></span> <span data-ttu-id="e3892-138">L'enumerazione [**Ads \_ Rights \_ enum**](/windows/win32/api/iads/ne-iads-ads_rights_enum) specifica i diritti di accesso che è possibile impostare in un oggetto directory.</span><span class="sxs-lookup"><span data-stu-id="e3892-138">The [**ADS\_RIGHTS\_ENUM**](/windows/win32/api/iads/ne-iads-ads_rights_enum) enumeration specifies the access rights you can set on a directory object.</span></span>
    3.  <span data-ttu-id="e3892-139">Usare la proprietà [**IADsAccessControlEntry. AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per specificare se consentire o negare i diritti di accesso impostati da **accessMask**.</span><span class="sxs-lookup"><span data-stu-id="e3892-139">Use the [**IADsAccessControlEntry.AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether to allow or deny the access rights set by **AccessMask**.</span></span> <span data-ttu-id="e3892-140">Per i diritti standard, questo può essere **Ads \_ ACETYPE \_ accesso \_ consentito** o **Ads \_ ACETYPE \_ accesso \_ negato**.</span><span class="sxs-lookup"><span data-stu-id="e3892-140">For standard rights, this can be **ADS\_ACETYPE\_ACCESS\_ALLOWED** or **ADS\_ACETYPE\_ACCESS\_DENIED**.</span></span> <span data-ttu-id="e3892-141">Per i diritti specifici dell'oggetto, ovvero i diritti che si applicano a una parte specifica di un oggetto o a un tipo specifico di oggetto, usare **Ads \_ ACETYPE \_ Access \_ allowed \_ Object** o **Ads \_ ACETYPE \_ Access \_ Denied \_** Object.</span><span class="sxs-lookup"><span data-stu-id="e3892-141">For object-specific rights (rights that apply to a specific part of an object or to a specific type of object), use **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT**.</span></span> <span data-ttu-id="e3892-142">L'enumerazione [**Ads \_ ACETYPE \_ enum**](/windows/win32/api/iads/ne-iads-ads_acetype_enum) specifica i tipi di accesso che è possibile impostare in una voce ACE.</span><span class="sxs-lookup"><span data-stu-id="e3892-142">The [**ADS\_ACETYPE\_ENUM**](/windows/win32/api/iads/ne-iads-ads_acetype_enum) enumeration specifies the access types you can set on an ACE.</span></span>
    4.  <span data-ttu-id="e3892-143">Usare la proprietà [**IADsAccessControlEntry. AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per specificare se gli altri contenitori o oggetti sotto l'oggetto specificato possono ereditare la voce ACE.</span><span class="sxs-lookup"><span data-stu-id="e3892-143">Use the [**IADsAccessControlEntry.AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether other containers or objects beneath the specified object can inherit the ACE.</span></span> <span data-ttu-id="e3892-144">L'enumerazione [**Ads \_ ACEFLAG \_ enum**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum) specifica i flag di ereditarietà che è possibile impostare in una voce ACE.</span><span class="sxs-lookup"><span data-stu-id="e3892-144">The [**ADS\_ACEFLAG\_ENUM**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum) enumeration specifies the inheritance flags you can set on an ACE.</span></span>
    5.  <span data-ttu-id="e3892-145">Usare la proprietà [**IADsAccessControlEntry. Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per specificare se il diritto si applica a una parte specifica dell'oggetto, a un tipo di oggetto ereditato o a entrambi.</span><span class="sxs-lookup"><span data-stu-id="e3892-145">Use the [**IADsAccessControlEntry.Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether the right applies to a specific part of the object, an inherited object type, or both.</span></span>
    6.  <span data-ttu-id="e3892-146">Se **Flags** è impostato **sul \_ tipo di oggetto flag Ads \_ \_ \_ presente**, impostare la proprietà [**IADSACCESSCONTROLENTRY. ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) o specificare una stringa contenente il GUID della classe di oggetti (per **Ads \_ Rights \_ DS \_ Create \_ figlio** o **Ads \_ right \_ DS \_ Delete \_ child**), Property, Property set, convalidated Write o Extended right che la voce ACE si applica a.</span><span class="sxs-lookup"><span data-stu-id="e3892-146">If **Flags** is set to **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property o specify a string containing the GUID of the object class (for **ADS\_RIGHT\_DS\_CREATE\_CHILD** or **ADS\_RIGHT\_DS\_DELETE\_CHILD**), property, property set, validated write, or extended right that the ACE applies to.</span></span> <span data-ttu-id="e3892-147">Il GUID deve essere specificato come una stringa del formato prodotto dalla funzione [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) nella libreria com.</span><span class="sxs-lookup"><span data-stu-id="e3892-147">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>
    7.  <span data-ttu-id="e3892-148">Se **Flags** è impostato **sul \_ flag ADS il tipo di \_ \_ oggetto ereditato \_ \_ presente**, impostare la proprietà [**IADSACCESSCONTROLENTRY. InheritedObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) per specificare una stringa che contiene il GUID della classe di oggetti ereditata a cui si applica la voce ACE.</span><span class="sxs-lookup"><span data-stu-id="e3892-148">If **Flags** is set to **ADS\_FLAG\_INHERITED\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.InheritedObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify a string that contains the GUID of the inherited object class that the ACE applies to.</span></span> <span data-ttu-id="e3892-149">Il GUID deve essere specificato come una stringa del formato prodotto dalla funzione [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) nella libreria com.</span><span class="sxs-lookup"><span data-stu-id="e3892-149">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>

6.  <span data-ttu-id="e3892-150">Usare il metodo **QueryInterface** sull'oggetto [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) per ottenere un puntatore [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="e3892-150">Use the **QueryInterface** method on the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) object to get an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="e3892-151">Il metodo [**IADsAccessControlList. AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) richiede un puntatore di interfaccia **IDispatch** alla voce ACE.</span><span class="sxs-lookup"><span data-stu-id="e3892-151">The [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) method requires an **IDispatch** interface pointer to the ACE.</span></span>
7.  <span data-ttu-id="e3892-152">Usare [**IADsAccessControlList. AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) per aggiungere la nuova voce ACE all'elenco DACL.</span><span class="sxs-lookup"><span data-stu-id="e3892-152">Use [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) to add the new ACE to the DACL.</span></span> <span data-ttu-id="e3892-153">Tenere presente che l'ordine delle voci ACE nell'ACL può influire sulla valutazione dell'accesso all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="e3892-153">Be aware that the order of the ACEs within the ACL can affect the evaluation of access to the object.</span></span> <span data-ttu-id="e3892-154">Per accedere correttamente all'oggetto, potrebbe essere necessario creare un nuovo ACL, aggiungere le voci ACE dall'ACL esistente nell'ordine corretto al nuovo ACL, quindi sostituire l'ACL esistente nel descrittore di sicurezza con il nuovo ACL.</span><span class="sxs-lookup"><span data-stu-id="e3892-154">The correct access to the object may require you to create an new ACL, add the ACEs from the existing ACL in the correct order to the new ACL, and then replace the existing ACL in the security descriptor with the new ACL.</span></span> <span data-ttu-id="e3892-155">Per ulteriori informazioni, vedere [Order of ACE in a DACL](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl).</span><span class="sxs-lookup"><span data-stu-id="e3892-155">For more information, see [Order of ACEs in a DACL](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl).</span></span>
8.  <span data-ttu-id="e3892-156">Utilizzare la proprietà [**IADsSecurityDescriptor. DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) per scrivere l'elenco DACL contenente la nuova voce ACE nel descrittore di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="e3892-156">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to write the DACL containing the new ACE to the security descriptor.</span></span> <span data-ttu-id="e3892-157">Per ulteriori informazioni sugli elenchi DACL, vedere [DACL null e elenchi DACL vuoti](null-dacls-and-empty-dacls.md).</span><span class="sxs-lookup"><span data-stu-id="e3892-157">For more information about DACLs, see [Null DACLs and Empty DACLs](null-dacls-and-empty-dacls.md).</span></span>
9.  <span data-ttu-id="e3892-158">Usare il metodo [**IADs. Put**](/windows/desktop/api/iads/nf-iads-iads-put) per scrivere il descrittore di sicurezza nella proprietà **ntSecurityDescriptor** dell'oggetto nella cache delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="e3892-158">Use the [**IADs.Put**](/windows/desktop/api/iads/nf-iads-iads-put) method to write the security descriptor to the object's **nTSecurityDescriptor** property to the property cache.</span></span>
10. <span data-ttu-id="e3892-159">Usare il metodo [**IADs. seinfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) per aggiornare la proprietà nell'oggetto nella directory.</span><span class="sxs-lookup"><span data-stu-id="e3892-159">Use the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method to update the property on the object in the directory.</span></span>

 

 