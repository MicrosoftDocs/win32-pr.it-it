---
title: Finestre delle proprietà Active Directory utenti e computer
description: Lo snap-in MMC utenti e computer Active Directory è progettato per visualizzare una finestra delle proprietà per vari oggetti in un server Active Directory.
ms.assetid: 38032d89-9549-475c-90aa-dac5cfe11084
ms.tgt_platform: multiple
keywords:
- Active Directory finestre delle proprietà utenti e computer AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30ea24f34e86f21af178e975852accb667bb69e4
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724666"
---
# <a name="active-directory-users-and-computers-property-sheets"></a><span data-ttu-id="b4fe4-104">Finestre delle proprietà Active Directory utenti e computer</span><span class="sxs-lookup"><span data-stu-id="b4fe4-104">Active Directory Users and Computers Property Sheets</span></span>

<span data-ttu-id="b4fe4-105">Lo snap-in MMC utenti e computer Active Directory è progettato per visualizzare una finestra delle proprietà per vari oggetti in un server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-105">The Active Directory Users and Computers MMC snap-in is designed to display a property sheet for various objects in an Active Directory server.</span></span> <span data-ttu-id="b4fe4-106">La finestra delle proprietà contiene una o più pagine utilizzate per visualizzare e modificare i dati degli oggetti.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-106">The property sheet contains one or more pages that are used to view and modify object data.</span></span> <span data-ttu-id="b4fe4-107">Per i diversi tipi di oggetto sono visualizzati diversi set di pagine.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-107">Different object types have different sets of pages displayed for them.</span></span> <span data-ttu-id="b4fe4-108">Lo snap-in MMC utenti e computer Active Directory consente inoltre ai fornitori di terze parti di aggiungere pagine personalizzate alla finestra delle proprietà per un tipo specifico di oggetto.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-108">The Active Directory Users and Computers MMC snap-in also enables third party vendors to add custom pages to the property sheet for a specific type of object.</span></span> <span data-ttu-id="b4fe4-109">Per altre informazioni, vedere [pagine delle proprietà da usare con gli identificatori di visualizzazione](property-pages-for-use-with-display-specifiers.md).</span><span class="sxs-lookup"><span data-stu-id="b4fe4-109">For more information, see [Property Pages for Use with Display Specifiers](property-pages-for-use-with-display-specifiers.md).</span></span>

<span data-ttu-id="b4fe4-110">Alcune applicazioni, diverse dallo snap-in MMC Active Directory utenti e computer, devono fornire all'utente la possibilità di visualizzare e modificare gli attributi per un oggetto in un server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-110">Some applications, other than the Active Directory Users and Computers MMC snap-in, must provide the user with the ability view and edit attributes for an object in an Active Directory server.</span></span> <span data-ttu-id="b4fe4-111">L'applicazione può implementare le proprie finestre delle proprietà, ma è preferibile offrire un'interfaccia utente coerente per ridurre la confusione e i tempi di apprendimento.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-111">The application could implement its own property sheets, but it is better to offer a consistent user interface to reduce confusion and learning time.</span></span> <span data-ttu-id="b4fe4-112">Fortunatamente, lo snap-in MMC Active Directory utenti e computer consente a qualsiasi applicazione COM OLE di visualizzare una finestra delle proprietà per un oggetto identico alla finestra delle proprietà visualizzata dallo snap-in MMC utenti e computer Active Directory per lo stesso oggetto.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-112">Fortunately, the Active Directory Users and Computers MMC snap-in allows any OLE COM application to display a property sheet for an object that is identical to the property sheet that would be displayed by the Active Directory Users and Computers MMC snap-in for the same object.</span></span>

<span data-ttu-id="b4fe4-113">Per ulteriori informazioni e un esempio di codice che ospita una finestra delle proprietà Active Directory utenti e computer, vedere l'esempio PropSheetHost in Platform Software Development Kit (SDK).</span><span class="sxs-lookup"><span data-stu-id="b4fe4-113">For more information and a code example that hosts an Active Directory Users and Computers property sheet, see the PropSheetHost sample in the Platform Software Development Kit (SDK).</span></span>

## <a name="developer-audience"></a><span data-ttu-id="b4fe4-114">Sviluppatori</span><span class="sxs-lookup"><span data-stu-id="b4fe4-114">Developer Audience</span></span>

<span data-ttu-id="b4fe4-115">In questa documentazione si presuppone che il lettore abbia familiarità con l'operazione COM e lo sviluppo di componenti con C++.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-115">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="b4fe4-116">Attualmente, non è possibile creare un'estensione della finestra delle proprietà Active Directory utilizzando Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-116">Currently, it is not possible to create an Active Directory property sheet extension using Visual Basic.</span></span>

## <a name="hosting-an-active-directory-users-and-computers-property-sheet"></a><span data-ttu-id="b4fe4-117">Hosting di una finestra delle proprietà di utenti e computer Active Directory</span><span class="sxs-lookup"><span data-stu-id="b4fe4-117">Hosting an Active Directory Users and Computers Property Sheet</span></span>

<span data-ttu-id="b4fe4-118">**Per visualizzare una finestra delle proprietà per un oggetto in un server Active Directory**</span><span class="sxs-lookup"><span data-stu-id="b4fe4-118">**To display a property sheet for an object in an Active Directory server**</span></span>

1.  <span data-ttu-id="b4fe4-119">Creare una finestra che può essere utilizzata per elaborare i messaggi.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-119">Create a window that can be used to process messages.</span></span> <span data-ttu-id="b4fe4-120">Può trattarsi di una finestra esistente o di una finestra a scopo speciale.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-120">This can be an existing window or a special purpose window.</span></span> <span data-ttu-id="b4fe4-121">Questa operazione è nota come *finestra nascosta*.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-121">This is known as the *hidden window*.</span></span>
2.  <span data-ttu-id="b4fe4-122">Creare un oggetto OLE COM derivato da [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span><span class="sxs-lookup"><span data-stu-id="b4fe4-122">Create an OLE COM object that is derived from [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span></span> <span data-ttu-id="b4fe4-123">Questo oggetto dati deve supportare i formati di dati seguenti:</span><span class="sxs-lookup"><span data-stu-id="b4fe4-123">This data object must support the following data formats:</span></span>

    -   <span data-ttu-id="b4fe4-124">[**CFSTR \_ DSOBJECTNAMES**](cfstr-dsobjectnames.md) questo formato dati contiene un [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) che identifica l'oggetto a cui si applica la finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-124">[**CFSTR\_DSOBJECTNAMES**](cfstr-dsobjectnames.md) This data format contains a [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) that identifies the object that the property sheet applies to.</span></span> <span data-ttu-id="b4fe4-125">Quando si ospita una finestra delle proprietà, nell'elenco seguente vengono mostrati i membri più significativi della struttura **DSOBJECTNAMES** .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-125">When hosting a property sheet, the more significant members of the **DSOBJECTNAMES** structure are shown in the following list.</span></span>

        <span data-ttu-id="b4fe4-126">**clsidNamespace** Riservati.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-126">**clsidNamespace** Reserved.</span></span> <span data-ttu-id="b4fe4-127">Impostare questo valore su un GUID per l'applicazione nel caso in cui venga usato in futuro.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-127">Set this to a GUID for your application here in case that it is used in the future.</span></span>
        
        <span data-ttu-id="b4fe4-128">**aObjects** Contiene una matrice di strutture [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-128">**aObjects** Contains an array of [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structures.</span></span> <span data-ttu-id="b4fe4-129">Ogni struttura **DSBOJECT** rappresenta un singolo oggetto directory.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-129">Each **DSBOJECT** structure represents a single directory object.</span></span> <span data-ttu-id="b4fe4-130">Il membro **cItems** contiene il numero di elementi nella matrice.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-130">The **cItems** member contains the number of elements in the array.</span></span> <span data-ttu-id="b4fe4-131">Viene utilizzato solo il primo oggetto in questa matrice.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-131">Only the first object in this array is used.</span></span> <span data-ttu-id="b4fe4-132">Gli altri oggetti vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-132">Other objects are ignored.</span></span>

    -   <span data-ttu-id="b4fe4-133">[**CFSTR \_ DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) questo formato dati contiene una struttura [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) che contiene i dati che verranno utilizzati dalle pagine delle proprietà, ad esempio la posizione in cui caricare le pagine delle proprietà, il server e le credenziali da utilizzare e così via.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-133">[**CFSTR\_DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) This data format contains a [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) structure that contains data that will be used by the property pages, such as where to load the property pages from, the server and credentials to use, and so on.</span></span> <span data-ttu-id="b4fe4-134">I membri più significativi di **DSDISPLAYSPECOPTIONS** sono indicati nell'elenco seguente.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-134">The more significant members of the **DSDISPLAYSPECOPTIONS** are shown in the following list.</span></span>

        <span data-ttu-id="b4fe4-135">**offsetAttribPrefix** La stringa del prefisso dell'attributo determina la posizione in cui viene ottenuto l'elenco di pagine delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-135">**offsetAttribPrefix** The attribute prefix string determines where the list of property pages is obtained.</span></span> <span data-ttu-id="b4fe4-136">Deve contenere una delle stringhe seguenti.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-136">This must contain one of the following strings.</span></span>

        

        | <span data-ttu-id="b4fe4-137">Stringa prefisso attributo</span><span class="sxs-lookup"><span data-stu-id="b4fe4-137">Attribute prefix string</span></span> | <span data-ttu-id="b4fe4-138">Descrizione</span><span class="sxs-lookup"><span data-stu-id="b4fe4-138">Description</span></span>                                              |
        |-------------------------|----------------------------------------------------------------------------------------------------------------------|
        | <span data-ttu-id="b4fe4-139">admin</span><span class="sxs-lookup"><span data-stu-id="b4fe4-139">"admin"</span></span><br/>      | <span data-ttu-id="b4fe4-140">Le pagine delle proprietà vengono caricate dall'attributo [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-140">The property pages are loaded from the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) attribute.</span></span><br/> |
        | <span data-ttu-id="b4fe4-141">Shell</span><span class="sxs-lookup"><span data-stu-id="b4fe4-141">"shell"</span></span><br/>      | <span data-ttu-id="b4fe4-142">Le pagine delle proprietà vengono caricate dall'attributo [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-142">The property pages are loaded from the [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute.</span></span><br/> |

        


    -   <span data-ttu-id="b4fe4-143">[**CFSTR \_ DS \_ PROPSHEETCONFIG**](cfstr-ds-propsheetconfig.md) questo formato dati contiene una struttura [**PROPSHEETCFG**](propsheetcfg.md) che contiene i dati dell'host della finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-143">[**CFSTR\_DS\_PROPSHEETCONFIG**](cfstr-ds-propsheetconfig.md) This data format contains a [**PROPSHEETCFG**](propsheetcfg.md) structure that contains property sheet host data.</span></span> <span data-ttu-id="b4fe4-144">Quando si ospita una finestra delle proprietà, i membri più significativi della struttura **PROPSHEETCFG** contengono i dati mostrati nell'elenco seguente.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-144">When hosting a property sheet, the more significant members of the **PROPSHEETCFG** structure contain the data shown in the following list.</span></span>

        <span data-ttu-id="b4fe4-145">**lNotifyHandle** Deve essere zero.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-145">**lNotifyHandle** Must be zero.</span></span>
        <span data-ttu-id="b4fe4-146">**hwndParentSheet**  Contiene l'handle della finestra per ricevere i messaggi di notifica delle modifiche di [**WM \_ ADSPROP \_ \_**](wm-adsprop-notify-change.md) quando qualcosa in una delle pagine cambia e viene applicato.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-146">**hwndParentSheet**  Contains the handle of the window to receive [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) messages when something in one of the pages changes and is applied.</span></span> <span data-ttu-id="b4fe4-147">Può essere **null** se questo messaggio non è necessario.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-147">Can be **NULL** if this message is not desired.</span></span>

        <span data-ttu-id="b4fe4-148">**hwndHidden** Contiene l'handle della finestra per la ricezione [**del \_ foglio DSA WM \_ \_ creare \_**](wm-dsa-sheet-create-notify.md) una notifica e la [**chiusura del foglio DSA WM messaggi di \_ \_ \_ \_ notifica**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-148">**hwndHidden** Contains the handle of the window to receive [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) and [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) messages.</span></span> <span data-ttu-id="b4fe4-149">Impostarlo sull'handle della finestra nascosta.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-149">Set this to the handle of your hidden window.</span></span>

        <span data-ttu-id="b4fe4-150">**wParamSheetClose** Contiene un identificatore definito dall'applicazione restituito in *wParam* nel messaggio di notifica di [**\_ chiusura del \_ foglio \_ \_ DSA WM**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-150">**wParamSheetClose** Contains an application-defined identifier that is returned in the *wParam* in the [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="b4fe4-151">Se questo membro è zero, il messaggio di **\_ \_ \_ chiusura \_ del foglio DSA WM** non verrà inserito nella finestra nascosta.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-151">If this member is zero, the **WM\_DSA\_SHEET\_CLOSE\_NOTIFY** message will not be posted to the hidden window.</span></span>


3.  <span data-ttu-id="b4fe4-152">Creare un'istanza dell'oggetto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) e ottenere l'interfaccia [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-152">Create an instance of the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and obtain the [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface for the object.</span></span> <span data-ttu-id="b4fe4-153">È anche possibile duplicare il comportamento dell'oggetto **CLSID \_ DsPropertyPages** .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-153">It is also possible to duplicate the behavior of the **CLSID\_DsPropertyPages** object.</span></span> <span data-ttu-id="b4fe4-154">Per ulteriori informazioni, vedere duplicazione del comportamento dell'oggetto CLSID \_ DsPropertyPages.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-154">For more information, see Duplicating the Behavior of the CLSID\_DsPropertyPages Object.</span></span>
4.  <span data-ttu-id="b4fe4-155">Inizializzare l'oggetto [**\_ DsPropertyPages CLSID**](guids-of-user-interface-elements.md) chiamando il metodo [**IShellExtInit:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-155">Initialize the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object by calling the [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method.</span></span> <span data-ttu-id="b4fe4-156">I parametri *pidlFolder* e *hkeyProgID* non vengono utilizzati in questo metodo.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-156">The *pidlFolder* and *hkeyProgID* parameters are not used in this method.</span></span> <span data-ttu-id="b4fe4-157">Il parametro *pdtobj* è il puntatore all'oggetto dati creato nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-157">The *pdtobj* parameter is the pointer to the data object created in Step 2.</span></span> <span data-ttu-id="b4fe4-158">Quando viene chiamato il metodo **IShellExtInit:: Initialize** , l' **oggetto \_ DsPropertyPages CLSID** salverà un riferimento all'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-158">When the **IShellExtInit::Initialize** method is called, the **CLSID\_DsPropertyPages** object will save a reference to the data object.</span></span>
5.  <span data-ttu-id="b4fe4-159">Ottenere l'interfaccia [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) per l'oggetto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) e chiamare il metodo [**IShellPropSheetExt:: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-159">Obtain the [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface for the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and call the [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method.</span></span> <span data-ttu-id="b4fe4-160">Il parametro *lpfnAddPage* è l'indirizzo di una funzione di callback che è necessario implementare.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-160">The *lpfnAddPage* parameter is the address of a callback function that you must implement.</span></span> <span data-ttu-id="b4fe4-161">Il formato di questa funzione è illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-161">The format of this function is shown below.</span></span> <span data-ttu-id="b4fe4-162">Se la funzione di callback viene dichiarata come membro di una classe C++, la funzione di callback deve essere dichiarata come **statica**.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-162">If the callback function is declared as a member of a C++ class, the callback function must be declared as **static**.</span></span> <span data-ttu-id="b4fe4-163">Il parametro *lParam* è un valore definito dall'applicazione che può essere utilizzato per identificare l'oggetto che implementa la funzione di callback.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-163">The *lParam* parameter is an application-defined value that can be used to identify the object that implements the callback function.</span></span> <span data-ttu-id="b4fe4-164">Quando viene chiamato il metodo **IShellPropSheetExt:: AddPages** , l'oggetto **CLSID \_ DsPropertyPages** otterrà i dati dall'oggetto dati ed enumera le pagine delle proprietà registrate per gli identificatori di visualizzazione dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-164">When the **IShellPropSheetExt::AddPages** method is called, the **CLSID\_DsPropertyPages** object will obtain the data from the data object and enumerate the property pages registered for the object display specifiers.</span></span> <span data-ttu-id="b4fe4-165">L'oggetto **CLSID \_ DsPropertyPages** enumera quindi gli oggetti della pagina delle proprietà, chiamando il metodo **IShellPropSheetExt:: AddPages** di ciascun oggetto.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-165">The **CLSID\_DsPropertyPages** object will then enumerate the property page objects, calling each object's **IShellPropSheetExt::AddPages** method.</span></span>

    ```C++
    BOOL CALLBACK AddPagesCallback(HPROPSHEETPAGE, LPARAM)
    ```

    

6.  <span data-ttu-id="b4fe4-166">Ogni pagina aggiunta dagli oggetti della pagina delle proprietà comporterà la chiamata della funzione di callback con l'handle per la pagina delle proprietà e il valore definito dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-166">Each page added by the property page objects will result in your callback function being called with the handle to the property page and the application-defined value.</span></span> <span data-ttu-id="b4fe4-167">La funzione di callback deve archiviare ogni handle di pagina delle proprietà passato.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-167">Your callback function must store each property page handle that is passed.</span></span> <span data-ttu-id="b4fe4-168">Quando il metodo [**IShellPropSheetExt:: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) dell'oggetto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) restituisce, tutte le pagine sono state aggiunte tramite la funzione di callback.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-168">When the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method returns, all pages will have been added via your callback function.</span></span>
7.  <span data-ttu-id="b4fe4-169">Compilare una struttura [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) per visualizzare la finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-169">Fill in a [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) structure to display the property sheet.</span></span> <span data-ttu-id="b4fe4-170">Il membro **phpage** riceve un puntatore a una matrice di handle di pagina raccolti dalla funzione di callback.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-170">The **phpage** member receives a pointer to an array of page handles that were collected by your callback function.</span></span> <span data-ttu-id="b4fe4-171">Il membro **nPages** riceve il numero di pagine nella matrice di handle di pagina.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-171">The **nPages** member receives the number of pages in the page handle array.</span></span>
8.  <span data-ttu-id="b4fe4-172">Consente di visualizzare la finestra delle proprietà chiamando la funzione [**PropertySheet**](/windows/win32/api/prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-172">Display the property sheet by calling the [**PropertySheet**](/windows/win32/api/prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="b4fe4-173">Se i dati in una pagina vengono modificati e si fa clic sui pulsanti **OK** o **applica** , la finestra identificata dal **membro hwndParentSheet** della struttura [**PROPSHEETCFG**](propsheetcfg.md) riceverà un messaggio di [**notifica di \_ \_ \_ modifica di WM ADSPROP**](wm-adsprop-notify-change.md) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-173">If the data in any page is changed and the **OK** or **Apply** buttons are clicked, the window identified by the **hwndParentSheet** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) message.</span></span> <span data-ttu-id="b4fe4-174">Questo messaggio è esclusivamente una notifica e non richiede alcuna azione specifica.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-174">This message is strictly a notification and requires no specific action.</span></span>

<span data-ttu-id="b4fe4-175">Quando la pagina viene chiusa, la finestra identificata dal membro **hwndHidden** della struttura [**PROPSHEETCFG**](propsheetcfg.md) riceverà un messaggio [**di \_ \_ notifica di \_ chiusura \_ del foglio DSA WM**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-175">When the page is closed, the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="b4fe4-176">Questo messaggio è esclusivamente una notifica e non richiede l'esecuzione di un'azione specifica.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-176">This message is strictly a notification and requires no specific action to be performed.</span></span>

<span data-ttu-id="b4fe4-177">In alcuni casi, è necessario che nelle finestre delle proprietà esistenti venga visualizzata una finestra delle proprietà secondaria.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-177">In some cases, the existing property sheets will need to display a secondary property sheet.</span></span> <span data-ttu-id="b4fe4-178">Se, ad esempio, si visualizza la finestra delle proprietà per un oggetto utente e si seleziona il **membro della** pagina, verrà visualizzato un elenco di gruppi di cui l'utente è membro.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-178">For example, if you display the property sheet for a user object and select the **Member Of** page, a list of groups that the user is a member of will be displayed.</span></span> <span data-ttu-id="b4fe4-179">Se si fa doppio clic su uno di questi gruppi nell'elenco, verrà visualizzata la finestra delle proprietà per tale gruppo.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-179">If you double-click one of these groups in the list, the property sheet for that group will be displayed.</span></span> <span data-ttu-id="b4fe4-180">La finestra delle proprietà primaria non Visualizza il foglio secondario da solo.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-180">The primary property sheet does not display the secondary sheet by itself.</span></span> <span data-ttu-id="b4fe4-181">Richiede che l'host visualizzi il foglio secondario inviando il messaggio di  [**\_ \_ \_ \_ notifica di un foglio DSA WM**](wm-dsa-sheet-create-notify.md) alla finestra identificata dal membro hwndHidden della struttura [**PROPSHEETCFG**](propsheetcfg.md) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-181">It requests that the host display the secondary sheet by sending a [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) message to the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure.</span></span> <span data-ttu-id="b4fe4-182">Il *wParam* del **\_ foglio DSA WM \_ \_ Crea \_ notifica** messaggio è un puntatore a una struttura [**di \_ \_ \_ informazioni della pagina DSA sec**](dsa-sec-page-info.md) che contiene informazioni sulla finestra delle proprietà secondaria e sull'oggetto che rappresenta.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-182">The *wParam* of the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message is a pointer to a [**DSA\_SEC\_PAGE\_INFO**](dsa-sec-page-info.md) structure that contains information about the secondary property sheet and the object that it represents.</span></span> <span data-ttu-id="b4fe4-183">In risposta a questo messaggio, l'host della finestra delle proprietà deve visualizzare la finestra delle proprietà secondaria nello stesso modo illustrato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-183">In response to this message, the property sheet host must display the secondary property sheet in the same manner as shown above.</span></span> <span data-ttu-id="b4fe4-184">Al termine dell'elaborazione del messaggio **WM \_ DSA \_ \_ Create \_ Notify** , il destinatario del messaggio deve liberare la struttura di **\_ informazioni della \_ pagina \_ DSA sec** passando il valore *wParam* alla funzione [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-184">After processing the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message, the message receiver must free the **DSA\_SEC\_PAGE\_INFO** structure by passing the *wParam* value to the [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) function.</span></span>

## <a name="duplicating-the-behavior-of-the-clsid_dspropertypages-object"></a><span data-ttu-id="b4fe4-185">Duplicazione del comportamento dell' \_ oggetto DSPROPERTYPAGES CLSID</span><span class="sxs-lookup"><span data-stu-id="b4fe4-185">Duplicating the Behavior of the CLSID\_DsPropertyPages Object</span></span>

<span data-ttu-id="b4fe4-186">**Per duplicare il comportamento dell' \_ oggetto DSPROPERTYPAGES CLSID**</span><span class="sxs-lookup"><span data-stu-id="b4fe4-186">**To duplicate the behavior of the CLSID\_DsPropertyPages object**</span></span>

1.  <span data-ttu-id="b4fe4-187">Enumerare i valori nell'attributo [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) o [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) per l'identificatore di visualizzazione per la classe di oggetti.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-187">Enumerate the values in the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) or [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute for the display specifier for the object class.</span></span> <span data-ttu-id="b4fe4-188">Ogni valore è una stringa che contiene un numero, seguito da una virgola, seguita dalla rappresentazione di stringa dell'identificatore di classe dell'estensione della pagina delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-188">Each value is a string that contains a number, followed by a comma, followed by the string representation of the class identifier of the property page extension.</span></span> <span data-ttu-id="b4fe4-189">Per ulteriori informazioni sul formato delle pagine delle proprietà, vedere la pagina relativa alla [registrazione dell'oggetto com della pagina delle proprietà in un identificatore di visualizzazione](registering-the-property-page-com-object-in-a-display-specifier.md).</span><span class="sxs-lookup"><span data-stu-id="b4fe4-189">For more information about the format of the property pages display specifier values, see [Registering the Property Page COM Object in a Display Specifier](registering-the-property-page-com-object-in-a-display-specifier.md).</span></span>
2.  <span data-ttu-id="b4fe4-190">Converte ogni stringa dell'identificatore di classe in un **CLSID** usando la funzione [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="b4fe4-190">Convert each class identifier string into a **CLSID** using the [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>
3.  <span data-ttu-id="b4fe4-191">Ordinare gli identificatori della classe di estensione in base al numero che precede ogni stringa dell'identificatore di classe nel valore dell'attributo.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-191">Sort the extension class identifiers by the number that precedes each class identifier string in the attribute value.</span></span> <span data-ttu-id="b4fe4-192">Se due numeri sono identici, ordinare gli identificatori di classe nell'ordine in cui i valori degli attributi vengono ottenuti dal server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-192">If two numbers are identical, sort the class identifiers in the order that the attribute values are obtained from the Active Directory server.</span></span>
4.  <span data-ttu-id="b4fe4-193">Enumerare gli identificatori della classe di estensione, creando un'istanza di ogni estensione.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-193">Enumerate the extension class identifiers, creating an instance of each extension.</span></span>
5.  <span data-ttu-id="b4fe4-194">Per ogni estensione, nell'ordine ordinato in precedenza, chiamare l'estensione [**IShellExtInit:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) con le stesse informazioni descritte nel passaggio 4 della procedura relativa alla finestra delle proprietà Hosting a Active Directory Users and Computers.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-194">For each extension, in the order sorted above, call the extension's [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) with the same information described in Step 4 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>
6.  <span data-ttu-id="b4fe4-195">Per ogni estensione, nell'ordine ordinato sopra, chiamare [**IShellPropSheetExt:: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) dell'estensione con le stesse informazioni descritte nel passaggio 5 della procedura relativa alla finestra delle proprietà hosting di un Active Directory utenti e computer.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-195">For each extension, in the order sorted above, call the extension's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) with the same information described in Step 5 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>

<span data-ttu-id="b4fe4-196">Se possibile, utilizzare l'oggetto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) per creare le pagine, anziché eseguire manualmente questa operazione.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-196">If possible, use the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object to create the pages rather than do this manually.</span></span> <span data-ttu-id="b4fe4-197">Il **CLSID \_ DsPropertyPages** è stato ottimizzato e gestirà correttamente i casi di errore, ad esempio quando non è disponibile alcun identificatore di visualizzazione per le impostazioni locali correnti.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-197">The **CLSID\_DsPropertyPages** has been optimized and will correctly handle failure cases, such as when no display specifier is available for the current locale.</span></span> <span data-ttu-id="b4fe4-198">Inoltre, l' **oggetto \_ DsPropertyPages CLSID** potrebbe cambiare in futuro, il che significa che le finestre delle proprietà potrebbero non corrispondere esattamente a quelle visualizzate dallo snap-in MMC utenti e computer Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-198">Also, the **CLSID\_DsPropertyPages** object may change in the future, which means your property sheets may not exactly match those displayed by the Active Directory Users and Computers MMC snap-in.</span></span>

## <a name="special-programming-elements"></a><span data-ttu-id="b4fe4-199">Particolari elementi di programmazione</span><span class="sxs-lookup"><span data-stu-id="b4fe4-199">Special Programming Elements</span></span>

<span data-ttu-id="b4fe4-200">Attualmente, gli elementi di programmazione seguenti non sono definiti in un file di intestazione pubblicato.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-200">Currently, the following programming elements are not defined in a published header file.</span></span> <span data-ttu-id="b4fe4-201">Per usare questi elementi, è necessario definirli nel formato esatto indicato nella pagina di riferimento specifica.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-201">To use these elements, you must define them yourself in the exact format shown in the particular reference page.</span></span>

-   [<span data-ttu-id="b4fe4-202">**\_PROPSHEETCONFIG DS \_ CFSTR**</span><span class="sxs-lookup"><span data-stu-id="b4fe4-202">**CFSTR\_DS\_PROPSHEETCONFIG**</span></span>](cfstr-ds-propsheetconfig.md)
-   [<span data-ttu-id="b4fe4-203">**PROPSHEETCFG**</span><span class="sxs-lookup"><span data-stu-id="b4fe4-203">**PROPSHEETCFG**</span></span>](propsheetcfg.md)
-   [<span data-ttu-id="b4fe4-204">**\_notifica di \_ chiusura del foglio DSA \_ WM \_**</span><span class="sxs-lookup"><span data-stu-id="b4fe4-204">**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**</span></span>](wm-dsa-sheet-close-notify.md)
-   [<span data-ttu-id="b4fe4-205">**\_ \_ \_ creazione \_ notifica foglio DSA WM**</span><span class="sxs-lookup"><span data-stu-id="b4fe4-205">**WM\_DSA\_SHEET\_CREATE\_NOTIFY**</span></span>](wm-dsa-sheet-create-notify.md)
-   [<span data-ttu-id="b4fe4-206">**\_ \_ informazioni pagina di DSA sec \_**</span><span class="sxs-lookup"><span data-stu-id="b4fe4-206">**DSA\_SEC\_PAGE\_INFO**</span></span>](dsa-sec-page-info.md)

## <a name="example-code"></a><span data-ttu-id="b4fe4-207">Codice di esempio</span><span class="sxs-lookup"><span data-stu-id="b4fe4-207">Example Code</span></span>

<span data-ttu-id="b4fe4-208">Nell'esempio di codice C++ riportato di seguito viene illustrato un modo sicuro per definire questi elementi che continueranno a funzionare anche se questi elementi sono definiti in un file di intestazione pubblicato in futuro.</span><span class="sxs-lookup"><span data-stu-id="b4fe4-208">The following C++ code example shows a safe way to define these elements that will continue to work even if these elements are defined in a published header file in the future.</span></span>


```C++
#ifndef CFSTR_DS_PROPSHEETCONFIG
    #define CFSTR_DS_PROPSHEETCONFIG_W L"DsPropSheetCfgClipFormat"
    #define CFSTR_DS_PROPSHEETCONFIG_A "DsPropSheetCfgClipFormat"

    #ifdef UNICODE
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_W
    #else
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_A
    #endif //UNICODE
#endif //CFSTR_DS_PROPSHEETCONFIG


#ifndef WM_ADSPROP_SHEET_CREATE
    #define WM_ADSPROP_SHEET_CREATE (WM_USER + 1108)
#endif


#ifndef WM_DSA_SHEET_CREATE_NOTIFY
    #define WM_DSA_SHEET_CREATE_NOTIFY (WM_USER + 6)
#endif


#ifndef WM_DSA_SHEET_CLOSE_NOTIFY
    #define WM_DSA_SHEET_CLOSE_NOTIFY (WM_USER + 5) 
#endif


#ifndef DSA_SEC_PAGE_INFO
    typedef struct _DSA_SEC_PAGE_INFO
    {
        HWND    hwndParentSheet;
        DWORD   offsetTitle;
        DSOBJECTNAMES dsObjectNames;
    } DSA_SEC_PAGE_INFO, *PDSA_SEC_PAGE_INFO;
#endif //DSA_SEC_PAGE_INFO

#ifndef PROPSHEETCFG
    typedef struct _PROPSHEETCFG
    {  
        LONG_PTR lNotifyHandle;  
        HWND hwndParentSheet;  
        HWND hwndHidden;  
        WPARAM wParamSheetClose;
    } PROPSHEETCFG, *PPROPSHEETCFG;
#endif //PROPSHEETCFG
```



 

