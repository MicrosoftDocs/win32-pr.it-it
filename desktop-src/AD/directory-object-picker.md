---
title: Selezione oggetti directory
description: La finestra di dialogo Selezione oggetti directory consente a un utente di selezionare uno o più oggetti dal catalogo globale, da un dominio o da un computer o da un gruppo di lavoro.
ms.assetid: 5b3e5d71-afd2-49db-b3a2-f9a49f0b2b3a
ms.tgt_platform: multiple
keywords:
- Active Directory selezione oggetti
- ANNUNCIO selezione oggetti
- oggetti AD, selezione oggetti
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24f6ba7fd053aa8ab3245bf72c693f0a887aa983
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "104046521"
---
# <a name="directory-object-picker"></a><span data-ttu-id="25274-106">Selezione oggetti directory</span><span class="sxs-lookup"><span data-stu-id="25274-106">Directory Object Picker</span></span>

<span data-ttu-id="25274-107">La finestra di dialogo Selezione oggetti directory consente a un utente di selezionare uno o più oggetti dal catalogo globale, da un dominio o da un computer o da un gruppo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="25274-107">The directory object picker dialog box enables a user to select one or more objects from either the global catalog, a domain or computer, or a workgroup.</span></span> <span data-ttu-id="25274-108">I tipi di oggetto da cui un utente può selezionare includono oggetti utente, contatto, gruppo e computer.</span><span class="sxs-lookup"><span data-stu-id="25274-108">The object types from which a user can select include user, contact, group, and computer objects.</span></span> <span data-ttu-id="25274-109">Per ulteriori informazioni su Active Directory Domain Services, vedere [Active Directory Domain Services](active-directory-domain-services.md).</span><span class="sxs-lookup"><span data-stu-id="25274-109">For more information about Active Directory Domain Services, see [Active Directory Domain Services](active-directory-domain-services.md).</span></span>

<span data-ttu-id="25274-110">Per visualizzare una finestra di dialogo di selezione oggetti:</span><span class="sxs-lookup"><span data-stu-id="25274-110">To display an object picker dialog box:</span></span>

1.  <span data-ttu-id="25274-111">Chiamare la funzione [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) o [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) per creare un'istanza dell'interfaccia [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) .</span><span class="sxs-lookup"><span data-stu-id="25274-111">Call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) function to create an instance of the [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) interface.</span></span>
2.  <span data-ttu-id="25274-112">Chiamare il metodo [**IDsObjectPicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) per inizializzare la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="25274-112">Call the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method to initialize the dialog box.</span></span>
3.  <span data-ttu-id="25274-113">Chiamare il metodo [**IDsObjectPicker:: InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) per visualizzare la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="25274-113">Call the [**IDsObjectPicker::InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) method to display the dialog box.</span></span>
4.  <span data-ttu-id="25274-114">Chiamare il metodo [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) dell'istanza [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) restituita dalla finestra di dialogo di selezione oggetti per recuperare i dati dell' [**elenco di \_ selezione di DSOP \_ DS \_ \_ CFSTR**](cfstr-dsop-ds-selection-list.md) .</span><span class="sxs-lookup"><span data-stu-id="25274-114">Call the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method of the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) instance returned by the object picker dialog box to retrieve the [**CFSTR\_DSOP\_DS\_SELECTION\_LIST**](cfstr-dsop-ds-selection-list.md) data.</span></span> <span data-ttu-id="25274-115">Il formato degli Appunti dell' **elenco di selezione di CFSTR \_ DSOP \_ \_ \_ DS** fornisce un **HGLOBAL** che contiene una struttura di [**\_ \_ elenco di selezione DS**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) .</span><span class="sxs-lookup"><span data-stu-id="25274-115">The **CFSTR\_DSOP\_DS\_SELECTION\_LIST** clipboard format provides an **HGLOBAL** that contains a [**DS\_SELECTION\_LIST**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) structure.</span></span> <span data-ttu-id="25274-116">La struttura dell' **\_ \_ elenco di selezione DS** contiene i dati relativi agli elementi selezionati nella finestra di dialogo Selezione oggetti.</span><span class="sxs-lookup"><span data-stu-id="25274-116">The **DS\_SELECTION\_LIST** structure contains data about the items selected in the object picker dialog box.</span></span>

<span data-ttu-id="25274-117">Se per un oggetto è necessario l'ID di sicurezza (SID), questo deve essere richiesto direttamente dal selettore oggetti aggiungendo l'attributo **objectSID** all'elenco di attributi da recuperare per l'oggetto selezionato.</span><span class="sxs-lookup"><span data-stu-id="25274-117">If the Security Identifier (SID) is required for an object, this should be requested directly from the object picker by adding the **objectSID** attribute to the list of attributes to retrieve for the selected object.</span></span> <span data-ttu-id="25274-118">Non è consigliabile passare il nome dell'oggetto restituito alla funzione [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) o [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) perché la ricerca del nome sarà ridondante e in alcuni casi potrebbe non riuscire.</span><span class="sxs-lookup"><span data-stu-id="25274-118">Passing the returned object name to the [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) or [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) function is not recommended because the name lookup will be redundant and may fail in some cases.</span></span>

<span data-ttu-id="25274-119">Se viene salvato un riferimento a tutti gli oggetti selezionati, il nome distinto non deve essere salvato perché l'oggetto può essere spostato, rinominato o può essere modificato a causa di differenze delle impostazioni locali.</span><span class="sxs-lookup"><span data-stu-id="25274-119">If a reference to any selected objects will be saved, the distinguished name should not be saved because the object may move, get renamed, or may change due to locale differences.</span></span> <span data-ttu-id="25274-120">Per le entità di sicurezza, il **objectSID** deve essere richiesto per l'oggetto e salvato in modo sicuro.</span><span class="sxs-lookup"><span data-stu-id="25274-120">For security principals, the **objectSID** should be requested for the object and securely saved.</span></span> <span data-ttu-id="25274-121">Se il nome dell'entità di sicurezza è necessario in un secondo momento, può essere recuperato con la funzione [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) .</span><span class="sxs-lookup"><span data-stu-id="25274-121">If the name of the security principal is needed later, it can be retrieved with the [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) function.</span></span> <span data-ttu-id="25274-122">Per tutti gli altri oggetti, il **objectGUID** deve essere richiesto e salvato.</span><span class="sxs-lookup"><span data-stu-id="25274-122">For all other objects, the **objectGUID** should be requested and saved.</span></span>

## <a name="initialization"></a><span data-ttu-id="25274-123">Inizializzazione</span><span class="sxs-lookup"><span data-stu-id="25274-123">Initialization</span></span>

<span data-ttu-id="25274-124">Quando viene inizializzata la finestra di dialogo di selezione oggetti, viene specificato un set di tipi di ambito e filtri.</span><span class="sxs-lookup"><span data-stu-id="25274-124">When the object picker dialog box is initialized, a set of scope types and filters is specified.</span></span> <span data-ttu-id="25274-125">I tipi di ambito specificati determinano i percorsi, i domini o i computer, ad esempio, da cui un utente può selezionare gli oggetti.</span><span class="sxs-lookup"><span data-stu-id="25274-125">The specified scope types determine the locations, domains or computers for example, from which a user can select objects.</span></span> <span data-ttu-id="25274-126">I filtri determinano i tipi di oggetti che un utente può selezionare da un determinato tipo di ambito.</span><span class="sxs-lookup"><span data-stu-id="25274-126">The filters determine the types of objects that a user can select from a given scope type.</span></span> <span data-ttu-id="25274-127">Per ulteriori informazioni, vedere la sezione Scopes and filters riportata di seguito.</span><span class="sxs-lookup"><span data-stu-id="25274-127">For more information, see the Scopes and Filters section below.</span></span>

<span data-ttu-id="25274-128">Per impostazione predefinita, un utente può selezionare un singolo oggetto nella finestra di dialogo Selezione oggetti directory.</span><span class="sxs-lookup"><span data-stu-id="25274-128">By default, a user can select a single object in the directory object picker dialog box.</span></span> <span data-ttu-id="25274-129">Per abilitare più selezioni, impostare il flag **\_ \_ MultiSelect del flag DSOP** nel membro **flOptions** della struttura delle [**\_ \_ informazioni di inizializzazione di DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) quando la finestra di dialogo è stata inizializzata.</span><span class="sxs-lookup"><span data-stu-id="25274-129">To enable multiple selections, set the **DSOP\_FLAG\_MULTISELECT** flag in the **flOptions** member of the [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure when the dialog box initialized.</span></span>

## <a name="scopes-and-filters"></a><span data-ttu-id="25274-130">Ambiti e filtri</span><span class="sxs-lookup"><span data-stu-id="25274-130">Scopes and Filters</span></span>

<span data-ttu-id="25274-131">Nell'elenco **a discesa Cerca in** sono inclusi gli ambiti da cui un utente può selezionare gli oggetti.</span><span class="sxs-lookup"><span data-stu-id="25274-131">The **Look in** drop-down list contains the scopes from which a user can select objects.</span></span> <span data-ttu-id="25274-132">Un ambito è un dominio, un computer, un gruppo di lavoro o un catalogo globale che archivia i dati relativi a e fornisce l'accesso a un set di oggetti disponibili.</span><span class="sxs-lookup"><span data-stu-id="25274-132">A scope is a domain, computer, workgroup, or global catalog that stores data about, and provides access to, a set of available objects.</span></span> <span data-ttu-id="25274-133">Le voci nell'elenco ambito dipendono dai tipi di ambito e dal computer di destinazione specificati quando il metodo [**IDsObjectPicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) è stato chiamato per l'ultima volta per inizializzare la finestra di dialogo Selezione oggetti.</span><span class="sxs-lookup"><span data-stu-id="25274-133">The entries in the scope list depend on the scope types and the target computer specified when the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method was last called to initialize the object picker dialog box.</span></span>

<span data-ttu-id="25274-134">Un tipo di ambito è una categoria generica di ambiti, ad esempio tutti i domini nell'azienda a cui appartiene il computer di destinazione, o il catalogo globale per l'azienda del computer di destinazione o il computer di destinazione.</span><span class="sxs-lookup"><span data-stu-id="25274-134">A scope type is a generic category of scopes, such as all domains in the enterprise to which the target computer belongs, or the global catalog for the target computer's enterprise, or the target computer itself.</span></span> <span data-ttu-id="25274-135">Per ogni tipo di ambito specificato, nella finestra di dialogo viene utilizzato il contesto del computer di destinazione per determinare le voci dell'elenco di ambiti.</span><span class="sxs-lookup"><span data-stu-id="25274-135">For each specified scope type, the dialog box uses the context of the target computer to determine the scope list entries.</span></span>

<span data-ttu-id="25274-136">Il metodo [**IDsObjectPicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) accetta un puntatore a una struttura di [**\_ \_ informazioni init DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) che contiene una matrice di strutture di [**\_ \_ \_ informazioni di inizializzazione dell'ambito DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) .</span><span class="sxs-lookup"><span data-stu-id="25274-136">The [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method takes a pointer to a [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure that contains an array of [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structures.</span></span> <span data-ttu-id="25274-137">Ogni voce nella matrice **DSOP \_ scope \_ init \_ info** specifica uno o più tipi di ambito, nonché filtri applicabili e altri attributi.</span><span class="sxs-lookup"><span data-stu-id="25274-137">Each entry in the **DSOP\_SCOPE\_INIT\_INFO** array specifies one or more scope types as well as applicable filters and other attributes.</span></span> <span data-ttu-id="25274-138">I filtri determinano i tipi di oggetti, ad esempio utenti, gruppi, contatti e computer, che l'utente può selezionare da un determinato tipo di ambito.</span><span class="sxs-lookup"><span data-stu-id="25274-138">The filters determine the types of objects, such as users, groups, contacts, and computers, that the user can select from a given scope type.</span></span> <span data-ttu-id="25274-139">Quando l'utente seleziona un ambito dall'elenco, la finestra di dialogo Applica i filtri per il tipo di ambito per visualizzare un elenco di oggetti da cui l'utente può selezionare.</span><span class="sxs-lookup"><span data-stu-id="25274-139">When the user selects a scope from the list, the dialog box applies the filters for that scope type to display a list of objects from which the user can select.</span></span>

<span data-ttu-id="25274-140">Ogni struttura di [**\_ \_ \_ informazioni di inizializzazione dell'ambito DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) contiene una struttura di [**\_ \_ flag di filtro DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) che specifica i filtri per il tipo di ambito.</span><span class="sxs-lookup"><span data-stu-id="25274-140">Each [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structure contains a [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure that specifies the filters for that scope type.</span></span> <span data-ttu-id="25274-141">La struttura dei **\_ \_ flag di filtro DSOP** distingue tra gli ambiti di livello superiore e inferiore:</span><span class="sxs-lookup"><span data-stu-id="25274-141">The **DSOP\_FILTER\_FLAGS** structure distinguishes between up-level and down-level scopes:</span></span>

-   <span data-ttu-id="25274-142">Un ambito di livello superiore è un catalogo globale o un dominio che supporta il [provider LDAP](/windows/desktop/ADSI/adsi-ldap-provider)ADSI.</span><span class="sxs-lookup"><span data-stu-id="25274-142">An up-level scope is a global catalog or a domain that supports the ADSI [LDAP provider](/windows/desktop/ADSI/adsi-ldap-provider).</span></span>
-   <span data-ttu-id="25274-143">Un ambito di livello inferiore include gruppi di lavoro e tutti i singoli computer.</span><span class="sxs-lookup"><span data-stu-id="25274-143">A down-level scope includes workgroups and all individual computers.</span></span> <span data-ttu-id="25274-144">Nella finestra di dialogo viene utilizzato il provider ADSI WinNT per accedere a un ambito di livello inferiore.</span><span class="sxs-lookup"><span data-stu-id="25274-144">The dialog box uses the ADSI WinNT provider to access a down-level scope.</span></span>

<span data-ttu-id="25274-145">Sono disponibili due set di flag di filtro definiti per l'utilizzo nella struttura dei [**\_ \_ flag di filtro DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) : uno per gli ambiti di livello superiore e uno per gli ambiti di livello inferiore.</span><span class="sxs-lookup"><span data-stu-id="25274-145">There are two sets of filter flags defined for use in the [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure: one for up-level scopes and one for down-level scopes.</span></span> <span data-ttu-id="25274-146">Il membro di **livello** superiore della struttura dei **\_ \_ flag di filtro DSOP** è una struttura di [**\_ \_ \_ flag di filtro di livello superiore DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) che specifica i filtri per gli ambiti di livello superiore.</span><span class="sxs-lookup"><span data-stu-id="25274-146">The **Uplevel** member of the **DSOP\_FILTER\_FLAGS** structure is a [**DSOP\_UPLEVEL\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) structure that specifies the filters for up-level scopes.</span></span> <span data-ttu-id="25274-147">Il membro **flDownlevel** della struttura **dei \_ \_ flag di filtro DSOP** è un set di flag che specificano i filtri per gli ambiti di livello inferiore.</span><span class="sxs-lookup"><span data-stu-id="25274-147">The **flDownlevel** member of the **DSOP\_FILTER\_FLAGS** structure is a set of flags that specify the filters for down-level scopes.</span></span>

 

 