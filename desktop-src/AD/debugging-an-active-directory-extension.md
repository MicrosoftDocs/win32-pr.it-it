---
title: Debug di un'estensione Active Directory
description: La finestra delle proprietà del servizio Microsoft Active Directory directory, il menu di scelta rapida e le estensioni della creazione guidata oggetto illustrate in questo argomento sono implementate come server COM in-process.
ms.assetid: 8c280084-fd2f-4d34-a119-d4e925a68a5c
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fc8d9646f4ccc2e8c740a81ddb48422881744f5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "104046530"
---
# <a name="debugging-an-active-directory-extension"></a><span data-ttu-id="f7e56-103">Debug di un'estensione Active Directory</span><span class="sxs-lookup"><span data-stu-id="f7e56-103">Debugging an Active Directory Extension</span></span>

<span data-ttu-id="f7e56-104">La finestra delle proprietà del servizio Microsoft Active Directory directory, il menu di scelta rapida e le estensioni della creazione guidata oggetto illustrate in questo argomento sono implementate come server COM in-process.</span><span class="sxs-lookup"><span data-stu-id="f7e56-104">The Microsoft Active Directory directory service property sheet, context menu, and object creation wizard extensions documented in this topic are implemented as COM in-proc servers.</span></span> <span data-ttu-id="f7e56-105">Ovvero ogni estensione è una DLL che viene eseguita nel contesto del processo host.</span><span class="sxs-lookup"><span data-stu-id="f7e56-105">That is, each extension is a DLL that runs in the context of the host process.</span></span> <span data-ttu-id="f7e56-106">Per eseguire il debug dell'estensione, è necessario associare l'estensione a un'applicazione ed eseguire l'applicazione in un debugger.</span><span class="sxs-lookup"><span data-stu-id="f7e56-106">To debug the extension, it is necessary to associate the extension with an application and run the application in a debugger.</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-windows-shell"></a><span data-ttu-id="f7e56-107">Debug di estensioni Active Directory visualizzate nella shell di Windows</span><span class="sxs-lookup"><span data-stu-id="f7e56-107">Debugging Active Directory Extensions Displayed in the Windows Shell</span></span>

<span data-ttu-id="f7e56-108">Le estensioni Active Directory visualizzate nella shell di Windows vengono caricate nel contesto del processo di Explorer.exe.</span><span class="sxs-lookup"><span data-stu-id="f7e56-108">Active Directory extensions displayed in the Windows shell are loaded in the context of the Explorer.exe process.</span></span> <span data-ttu-id="f7e56-109">È possibile eseguire il debug di queste estensioni come un'estensione della shell standard.</span><span class="sxs-lookup"><span data-stu-id="f7e56-109">These extensions can be debugged like a standard shell extension.</span></span> <span data-ttu-id="f7e56-110">Per ulteriori informazioni sul debug delle estensioni della shell, vedere [debug con la shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="f7e56-110">For more information about debugging shell extensions, see [Debugging with the Shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-active-directory-mmc-snap-ins"></a><span data-ttu-id="f7e56-111">Debug di estensioni Active Directory visualizzate nella Active Directory MMC Snap-Ins</span><span class="sxs-lookup"><span data-stu-id="f7e56-111">Debugging Active Directory Extensions Displayed in the Active Directory MMC Snap-Ins</span></span>

<span data-ttu-id="f7e56-112">Active Directory estensioni visualizzate nell'Active Directory snap-in MMC amministrativi vengono caricati nel contesto di Microsoft Management Console.</span><span class="sxs-lookup"><span data-stu-id="f7e56-112">Active Directory extensions displayed in the Active Directory administrative MMC snap-ins are loaded in the context of the Microsoft Management Console.</span></span> <span data-ttu-id="f7e56-113">Per eseguire il debug di un'estensione, individuare Mmc.exe nel sistema locale e impostare il debugger per utilizzarlo come applicazione per il debug.</span><span class="sxs-lookup"><span data-stu-id="f7e56-113">To debug an extension, locate Mmc.exe on the local system and set the debugger to use this as the application for debugging.</span></span> <span data-ttu-id="f7e56-114">Nella maggior parte dei sistemi, Mmc.exe si trova nella directory di sistema di Windows, ad esempio C: \\ WinNT \\ system32.</span><span class="sxs-lookup"><span data-stu-id="f7e56-114">On most systems, Mmc.exe is located in the Windows system directory, for example, C:\\WINNT\\System32.</span></span> <span data-ttu-id="f7e56-115">A seconda del debugger, è possibile che non sia necessario impostare la DLL di estensione in modo che venga caricata anche dal debugger.</span><span class="sxs-lookup"><span data-stu-id="f7e56-115">Depending on the debugger, you may or may not have to set the extension DLL to also be loaded by the debugger.</span></span> <span data-ttu-id="f7e56-116">Molti debugger consentono inoltre di aggiungere il debugger a un processo MMC in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="f7e56-116">Many debuggers also allow you to attach the debugger to a running MMC process.</span></span> <span data-ttu-id="f7e56-117">Per ulteriori informazioni, vedere il manuale dell'utente del debugger.</span><span class="sxs-lookup"><span data-stu-id="f7e56-117">For more information, see your debugger User's Guide.</span></span>

<span data-ttu-id="f7e56-118">Può essere utile fare in modo che MMC carichi automaticamente uno snap-in specifico.</span><span class="sxs-lookup"><span data-stu-id="f7e56-118">It can be convenient to have MMC automatically load a specific snap-in.</span></span> <span data-ttu-id="f7e56-119">A tale scopo, impostare gli argomenti dell'applicazione sul percorso e il nome file di un file MSC.</span><span class="sxs-lookup"><span data-stu-id="f7e56-119">To do this, set the application arguments to the path and file name of an MSC file.</span></span> <span data-ttu-id="f7e56-120">Può trattarsi di un file MSC installato dal sistema o di uno creato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="f7e56-120">This can either be a system-installed MSC file or one you create.</span></span> <span data-ttu-id="f7e56-121">È possibile creare un file MSC attenendosi alla seguente procedura.</span><span class="sxs-lookup"><span data-stu-id="f7e56-121">An MSC file can be created by following these steps.</span></span>

1.  <span data-ttu-id="f7e56-122">Eseguire Mmc.exe.</span><span class="sxs-lookup"><span data-stu-id="f7e56-122">Run Mmc.exe.</span></span>
2.  <span data-ttu-id="f7e56-123">Caricare lo snap-in desiderato selezionando **file**  -  **Aggiungi/Rimuovi snap-in...** dal menu MMC e selezionando lo snap-in desiderato.</span><span class="sxs-lookup"><span data-stu-id="f7e56-123">Load the desired snap-in by selecting **File** - **Add/Remove Snap-in...** in the MMC menu and select the desired snap-in.</span></span>
3.  <span data-ttu-id="f7e56-124">Salvare il file msc selezionando **file**  -  **Salva con nome** dal menu MMC.</span><span class="sxs-lookup"><span data-stu-id="f7e56-124">Save the MSC file by selecting **File** - **Save As...** in the MMC menu.</span></span>

<span data-ttu-id="f7e56-125">Se non si imposta un file MSC di avvio, è necessario caricare manualmente lo snap-in quando si esegue l'applicazione nel debugger.</span><span class="sxs-lookup"><span data-stu-id="f7e56-125">If you do not set a start-up MSC file, you must manually load the desired snap-in when you run the application in the debugger.</span></span>

<span data-ttu-id="f7e56-126">Quando l'applicazione host viene eseguita nel debugger, il debugger può visualizzare un messaggio di avviso che informa che l'applicazione in esecuzione non contiene alcun simbolo di debug.</span><span class="sxs-lookup"><span data-stu-id="f7e56-126">When the host application is run in the debugger, the debugger may display a warning message stating that the application being run does not contain any debug symbols.</span></span> <span data-ttu-id="f7e56-127">Questo comportamento è previsto e può essere ignorato perché si esegue effettivamente il debug della DLL, non dell'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="f7e56-127">This is expected and can safely be ignored because you are actually debugging the DLL, not the host application.</span></span>

<span data-ttu-id="f7e56-128">Nella maggior parte dei casi, l'estensione non verrà chiamata fino a quando l'utente non esegue un'azione che causa il caricamento e l'inizializzazione dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="f7e56-128">In most cases, the extension will not be called until the user performs some action that causes the extension to be loaded and initialized.</span></span> <span data-ttu-id="f7e56-129">Se, ad esempio, si esegue il debug di un'estensione del menu di scelta rapida visualizzata per gli oggetti utente, l'estensione non verrà caricata finché non viene visualizzata la prima volta il menu di scelta rapida per un oggetto utente.</span><span class="sxs-lookup"><span data-stu-id="f7e56-129">For example, if you are debugging a context menu extension displayed for user objects, the extension will not load until the first time the context menu for a user object is displayed.</span></span>

<span data-ttu-id="f7e56-130">A questo punto dovrebbe essere possibile impostare i punti di interruzione e visualizzare l'output di debug.</span><span class="sxs-lookup"><span data-stu-id="f7e56-130">You should now be able to set breakpoints and view debug output.</span></span> <span data-ttu-id="f7e56-131">Se l'estensione non sembra carica, impostare un punto di interruzione nella funzione [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) dell'estensione.</span><span class="sxs-lookup"><span data-stu-id="f7e56-131">If the extension does not appear to load, set a breakpoint in the extension's [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) function.</span></span> <span data-ttu-id="f7e56-132">Se **DllGetClassObject** non viene chiamato, è probabile che l'estensione non sia registrata correttamente.</span><span class="sxs-lookup"><span data-stu-id="f7e56-132">If **DllGetClassObject** is not called, the extension is probably not registered correctly.</span></span>

<span data-ttu-id="f7e56-133">Al termine del debug, uscire da MMC e il debugger dovrebbe scaricarlo normalmente.</span><span class="sxs-lookup"><span data-stu-id="f7e56-133">When the debug is complete, exit MMC and the debugger should unload normally.</span></span>

 

 