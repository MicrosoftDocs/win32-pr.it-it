---
title: Enumerazione degli utenti
description: A differenza dei domini di Windows NT 4,0, gli utenti di Windows 2000 possono essere inseriti in qualsiasi contenitore o unità organizzativa in un dominio e nella radice del dominio.
ms.assetid: 4a35af7a-f43b-4cf9-a030-77f6c2518ae7
ms.tgt_platform: multiple
keywords:
- Enumerazione degli utenti AD
- utenti AD, enumerazione di un utente
- Active Directory, utilizzo di, utenti, enumerazione di un utente
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e922d92f4313ed0238ff068f7ae1c0fbf693d497
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "106299584"
---
# <a name="enumerating-users"></a><span data-ttu-id="dfe8a-106">Enumerazione degli utenti</span><span class="sxs-lookup"><span data-stu-id="dfe8a-106">Enumerating Users</span></span>

<span data-ttu-id="dfe8a-107">A differenza dei domini di Windows NT 4,0, gli utenti di Windows 2000 possono essere inseriti in qualsiasi contenitore o unità organizzativa in un dominio e nella radice del dominio.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-107">Unlike Windows NT 4.0 domains, Windows 2000 users can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="dfe8a-108">Questo significa che gli utenti possono trovarsi in numerose posizioni nella gerarchia di directory.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-108">This means that users can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="dfe8a-109">Sono pertanto disponibili due opzioni per l'enumerazione degli utenti:</span><span class="sxs-lookup"><span data-stu-id="dfe8a-109">Therefore, you have two choices for enumerating users:</span></span>

-   <span data-ttu-id="dfe8a-110">Enumerare gli utenti direttamente contenuti in un contenitore, OU o alla radice del dominio:</span><span class="sxs-lookup"><span data-stu-id="dfe8a-110">Enumerate the users directly contained in a container, OU, or at the root of the domain:</span></span>

    <span data-ttu-id="dfe8a-111">Associare in modo esplicito all'oggetto contenitore che contiene gli utenti di cui si è interessati per l'enumerazione, impostare un filtro contenente "User" come classe usando la proprietà [**IADsContainer. Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) e usare il metodo [**IADsContainer:: Get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) per enumerare gli oggetti utente.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-111">Explicitly bind to the container object that contains the users you are interested in enumerating, set a filter containing "user" as the class using the [**IADsContainer.Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the user objects.</span></span>

    <span data-ttu-id="dfe8a-112">Questa tecnica può essere utilizzata per enumerare gli utenti direttamente contenuti in un contenitore o in un oggetto OU.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-112">This technique can be used to enumerate users that are directly contained in a container or OU object.</span></span> <span data-ttu-id="dfe8a-113">Se il contenitore contiene altri contenitori che possono potenzialmente contenere altri utenti, è necessario eseguire l'associazione a tali contenitori ed enumerare in modo ricorsivo gli utenti in tali contenitori.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-113">If the container contains other containers that can potentially contain other users, you must bind to those containers and recursively enumerate the users on those containers.</span></span> <span data-ttu-id="dfe8a-114">Se non è necessario modificare gli oggetti utente ed è necessario leggere solo proprietà specifiche, usare la ricerca completa descritta nell'opzione 2.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-114">If it is not required that you manipulate the user objects, and only need to read specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="dfe8a-115">Poiché l'enumerazione restituisce i puntatori agli oggetti ADSI COM che rappresentano ogni oggetto utente, è possibile chiamare [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) per ottenere i puntatori dell'interfaccia [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser)e [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) per l'oggetto utente.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-115">Because enumeration returns pointers to ADSI COM objects representing each user object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the user object.</span></span> <span data-ttu-id="dfe8a-116">Ciò significa che è possibile ottenere i puntatori di interfaccia a ogni oggetto utente enumerato in un contenitore senza dover associare in modo esplicito a ogni oggetto utente.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-116">This means you can get interface pointers to each enumerated user object in a container without having to explicitly bind to each user object.</span></span> <span data-ttu-id="dfe8a-117">Per eseguire operazioni su tutti gli utenti direttamente all'interno di un contenitore, l'enumerazione evita di dover associare ogni utente per chiamare i metodi **IADs** o **IADsUser** .</span><span class="sxs-lookup"><span data-stu-id="dfe8a-117">To perform operations on all the users directly within a container, enumeration avoids having to bind to each user in order to call **IADs** or **IADsUser** methods.</span></span> <span data-ttu-id="dfe8a-118">Per recuperare proprietà specifiche dagli utenti, usare [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) come descritto nell'opzione 2.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-118">To retrieve specific properties from users, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in option 2.</span></span>

-   <span data-ttu-id="dfe8a-119">Eseguire una ricerca completa di (& (objectClass = user) (objectCategory = person)) per trovare tutti gli utenti in un albero:</span><span class="sxs-lookup"><span data-stu-id="dfe8a-119">Perform a deep search for (&(objectClass=user)(objectCategory=person)) to find all users in a tree:</span></span>

    <span data-ttu-id="dfe8a-120">Per prima cosa, eseguire l'associazione all'oggetto contenitore in cui iniziare la ricerca.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-120">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="dfe8a-121">Ad esempio, per trovare tutti gli utenti in un dominio, effettuare l'associazione alla radice del dominio; per trovare tutti gli utenti nella foresta, effettuare l'associazione al catalogo globale e cercare dalla radice del GC.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-121">For example, to find all users in a domain, bind to root of the domain; to find all users in the forest, bind to the global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="dfe8a-122">Usare quindi [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) per eseguire una query usando un filtro di ricerca contenente (& (objectClass = user) (objectCategory = person)) e la preferenza di ricerca del \_ sottoalbero con ambito Ads \_ .</span><span class="sxs-lookup"><span data-stu-id="dfe8a-122">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter containing (&(objectClass=user)(objectCategory=person)) and search preference of ADS\_SCOPE\_SUBTREE.</span></span>

    <span data-ttu-id="dfe8a-123">È possibile eseguire una ricerca con una preferenza di ricerca dell' \_ ambito Ads \_ unlivello per limitare la ricerca ai contenuti diretti dell'oggetto contenitore associato.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-123">You can perform a search with a search preference of ADS\_SCOPE\_ONELEVEL to limit the search to the direct contents of the container object that you bound to.</span></span>

    <span data-ttu-id="dfe8a-124">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) recupera solo i valori delle proprietà specifiche degli utenti.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-124">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from users.</span></span> <span data-ttu-id="dfe8a-125">Per recuperare i valori, usare **IDirectorySearch**.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-125">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="dfe8a-126">Per modificare gli oggetti utente restituiti da una ricerca, ovvero si desidera utilizzare i metodi [**IADs**](/windows/desktop/api/iads/nn-iads-iads) o [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) , è necessario associarli in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-126">To manipulate the user objects returned from a search, that is, you want to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) methods, you must explicitly bind to them.</span></span> <span data-ttu-id="dfe8a-127">A tale scopo, specificare **Distinguishname** come una delle proprietà da restituire dalla ricerca e utilizzare i nomi distinti restituiti per eseguire l'associazione a ogni utente restituito nella ricerca.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-127">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each user returned in the search.</span></span>

    <span data-ttu-id="dfe8a-128">Vengono recuperate solo le proprietà specifiche.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-128">Only specific properties are retrieved.</span></span> <span data-ttu-id="dfe8a-129">Non è possibile recuperare tutti gli attributi senza specificare in modo esplicito ogni attributo possibile della classe utente.</span><span class="sxs-lookup"><span data-stu-id="dfe8a-129">You cannot retrieve all attributes without explicitly specifying every possible attribute of the user class.</span></span>

 

 