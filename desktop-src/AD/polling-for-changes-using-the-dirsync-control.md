---
title: Polling delle modifiche tramite il controllo DirSync
description: Il controllo Active Directory Directory Synchronization (DirSync) è un'estensione del server LDAP che consente a un'applicazione di eseguire la ricerca in una partizione di directory per gli oggetti che sono stati modificati dopo uno stato precedente.
ms.assetid: f77caeb3-bfc9-4ae6-8d1d-73f4ee554336
ms.tgt_platform: multiple
keywords:
- Polling delle modifiche tramite il controllo DirSync AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c3d105757d39bc25bd10df21ab68c4d1d1202be
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724471"
---
# <a name="polling-for-changes-using-the-dirsync-control"></a><span data-ttu-id="d4432-104">Polling delle modifiche tramite il controllo DirSync</span><span class="sxs-lookup"><span data-stu-id="d4432-104">Polling for Changes Using the DirSync Control</span></span>

<span data-ttu-id="d4432-105">Il controllo Active Directory Directory Synchronization (DirSync) è un'estensione del server LDAP che consente a un'applicazione di eseguire la ricerca in una partizione di directory per gli oggetti che sono stati modificati dopo uno stato precedente.</span><span class="sxs-lookup"><span data-stu-id="d4432-105">Active Directory directory synchronization (DirSync) control is an LDAP server extension that enables an application to search an directory partition for objects that have changed since a previous state.</span></span>

<span data-ttu-id="d4432-106">Usare il controllo DirSync tramite ADSI specificando la preferenza di ricerca **Ads \_ SEARCHPREF \_ dirsync** quando si usa [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span><span class="sxs-lookup"><span data-stu-id="d4432-106">Use the DirSync control through ADSI by specifying the **ADS\_SEARCHPREF\_DIRSYNC** search preference when using [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span></span> <span data-ttu-id="d4432-107">Per altre informazioni e un esempio di codice, vedere [codice di esempio con ADS \_ SEARCHPREF \_ dirsync](example-code-using-ads-searchpref-dirsync.md).</span><span class="sxs-lookup"><span data-stu-id="d4432-107">For more information and a code example, see [Example Code Using ADS\_SEARCHPREF\_DIRSYNC](example-code-using-ads-searchpref-dirsync.md).</span></span> <span data-ttu-id="d4432-108">È anche possibile eseguire una ricerca DirSync usando l'API LDAP.</span><span class="sxs-lookup"><span data-stu-id="d4432-108">You can also perform a DirSync search using the LDAP API.</span></span> <span data-ttu-id="d4432-109">Di seguito viene descritta l'implementazione di ADSI, la maggior parte delle quali si applica anche all'uso diretto di LDAP, fatta eccezione per quanto illustrato alla fine di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="d4432-109">The following describes the ADSI implementation, most of which also applies to using LDAP directly, except as discussed at the end of this topic.</span></span>

<span data-ttu-id="d4432-110">Quando si esegue una ricerca DirSync, si passa un elemento dati specifico del provider (cookie) che identifica lo stato della directory al momento della ricerca DirSync precedente.</span><span class="sxs-lookup"><span data-stu-id="d4432-110">When you perform a DirSync search, you pass in a provider-specific data element (cookie) that identifies the directory state at the time of the previous DirSync search.</span></span> <span data-ttu-id="d4432-111">Per la prima ricerca, viene passato un cookie null e la ricerca restituisce tutti gli oggetti che corrispondono al filtro.</span><span class="sxs-lookup"><span data-stu-id="d4432-111">For the first search, you pass in a null cookie, and the search returns all objects that match the filter.</span></span> <span data-ttu-id="d4432-112">La ricerca restituisce anche un cookie valido.</span><span class="sxs-lookup"><span data-stu-id="d4432-112">The search also returns a valid cookie.</span></span> <span data-ttu-id="d4432-113">Archiviare il cookie nella stessa risorsa di archiviazione che si sta sincronizzando con il server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d4432-113">Store the cookie in the same storage that you are synchronizing with the Active Directory server.</span></span> <span data-ttu-id="d4432-114">Nelle ricerche successive recuperare il cookie dalla risorsa di archiviazione e passarlo alla richiesta di ricerca.</span><span class="sxs-lookup"><span data-stu-id="d4432-114">On subsequent searches, get the cookie from storage and pass it with the search request.</span></span> <span data-ttu-id="d4432-115">I risultati della ricerca ora includono solo gli oggetti e gli attributi che sono stati modificati dopo lo stato precedente identificato dal cookie.</span><span class="sxs-lookup"><span data-stu-id="d4432-115">The search results now include only the objects and attributes that have changed since the previous state identified by the cookie.</span></span> <span data-ttu-id="d4432-116">La ricerca restituisce anche un nuovo cookie da archiviare per la ricerca successiva.</span><span class="sxs-lookup"><span data-stu-id="d4432-116">The search also returns a new cookie to store for the next search.</span></span>

<span data-ttu-id="d4432-117">La tabella seguente elenca i parametri di ricerca che la richiesta di ricerca del client può specificare.</span><span class="sxs-lookup"><span data-stu-id="d4432-117">The following table lists search parameters that the client search request can specify.</span></span>



| <span data-ttu-id="d4432-118">Parametro</span><span class="sxs-lookup"><span data-stu-id="d4432-118">Parameter</span></span>          | <span data-ttu-id="d4432-119">Descrizione</span><span class="sxs-lookup"><span data-stu-id="d4432-119">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d4432-120">Base della ricerca</span><span class="sxs-lookup"><span data-stu-id="d4432-120">Base of the search</span></span> | <span data-ttu-id="d4432-121">La base di una ricerca DirSync deve essere la radice di una partizione di directory, che può essere una partizione di dominio, la partizione di configurazione o la partizione dello schema.</span><span class="sxs-lookup"><span data-stu-id="d4432-121">The base of a DirSync search must be the root of a directory partition, which can be a domain partition, the configuration partition, or the schema partition.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="d4432-122">Ambito</span><span class="sxs-lookup"><span data-stu-id="d4432-122">Scope</span></span>              | <span data-ttu-id="d4432-123">L'ambito di una ricerca DirSync deve essere un sottoalbero dell' **\_ ambito \_ ADS**, ovvero l'intero sottoalbero della partizione.</span><span class="sxs-lookup"><span data-stu-id="d4432-123">The scope of a DirSync search must be **ADS\_SCOPE\_SUBTREE**, that is, the entire subtree of the partition.</span></span> <span data-ttu-id="d4432-124">Tenere presente che per la ricerca di una partizione di dominio, il sottoalbero include le intestazioni, ma non il contenuto, delle partizioni di configurazione e dello schema.</span><span class="sxs-lookup"><span data-stu-id="d4432-124">Be aware that for a search of a domain partition, the subtree includes the heads, but not the contents, of the configuration and schema partitions.</span></span> <span data-ttu-id="d4432-125">Per eseguire il polling delle modifiche in un ambito più piccolo, utilizzare la tecnica **uSNChanged** anziché dirsync.</span><span class="sxs-lookup"><span data-stu-id="d4432-125">To poll for changes in a smaller scope, use the **USNChanged** technique instead of DirSync.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="d4432-126">Filtra</span><span class="sxs-lookup"><span data-stu-id="d4432-126">Filter</span></span>             | <span data-ttu-id="d4432-127">È possibile specificare qualsiasi filtro di ricerca valido.</span><span class="sxs-lookup"><span data-stu-id="d4432-127">You can specify any valid search filter.</span></span> <span data-ttu-id="d4432-128">Per una ricerca iniziale con un cookie null, i risultati includono tutti gli oggetti che corrispondono al filtro.</span><span class="sxs-lookup"><span data-stu-id="d4432-128">For an initial search with a null cookie, the results include all objects that match the filter.</span></span> <span data-ttu-id="d4432-129">Per le ricerche successive con un cookie valido, i risultati della ricerca includono i dati solo per gli oggetti che corrispondono al filtro e sono stati modificati dopo lo stato indicato dal cookie.</span><span class="sxs-lookup"><span data-stu-id="d4432-129">For subsequent searches with a valid cookie, the search results include data only for objects that match the filter and have changed since the state indicated by the cookie.</span></span> <span data-ttu-id="d4432-130">Per ulteriori informazioni sui filtri di ricerca, vedere [creazione di un filtro query](creating-a-query-filter.md).</span><span class="sxs-lookup"><span data-stu-id="d4432-130">For more information about search filters, see [Creating a Query Filter](creating-a-query-filter.md).</span></span>                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="d4432-131">Attributi</span><span class="sxs-lookup"><span data-stu-id="d4432-131">Attributes</span></span>         | <span data-ttu-id="d4432-132">È possibile specificare un elenco di attributi da restituire quando si verifica una modifica.</span><span class="sxs-lookup"><span data-stu-id="d4432-132">You can specify a list of attributes to be returned when a change occurs.</span></span> <span data-ttu-id="d4432-133">Per ogni oggetto, i risultati iniziali includono tutti gli attributi richiesti impostati per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="d4432-133">For each object, the initial results include all the requested attributes set on the object.</span></span> <span data-ttu-id="d4432-134">I risultati della ricerca successivi includono solo gli attributi specificati che sono stati modificati.</span><span class="sxs-lookup"><span data-stu-id="d4432-134">Subsequent search results include only the specified attributes that have changed.</span></span> <span data-ttu-id="d4432-135">Gli attributi non modificati non vengono inclusi nei risultati della ricerca.</span><span class="sxs-lookup"><span data-stu-id="d4432-135">Unchanged attributes are not included in the search results.</span></span> <span data-ttu-id="d4432-136">Nell'implementazione di ADSI i risultati della ricerca includono sempre **objectGUID** e **instanceType** di ogni oggetto.</span><span class="sxs-lookup"><span data-stu-id="d4432-136">In the ADSI implementation, the search results always include the **objectGUID** and **instanceType** of each object.</span></span> <span data-ttu-id="d4432-137">Inoltre, l'elenco di attributi specificato funge da filtro aggiuntivo. i risultati della ricerca iniziale includono solo gli oggetti per i quali è stato impostato almeno uno degli attributi specificati. nelle ricerche successive sono inclusi solo gli oggetti in cui uno o più attributi sono stati modificati (valori aggiunti o eliminati).</span><span class="sxs-lookup"><span data-stu-id="d4432-137">Also, the specified attribute list acts as an additional filter: the initial search results include only objects that have at least one of the specified attributes set; subsequent searches include only objects on which one or more of the attributes have changed (values added or deleted).</span></span> |



 

<span data-ttu-id="d4432-138">Tenere inoltre presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="d4432-138">Also, be aware that:</span></span>

-   <span data-ttu-id="d4432-139">Per le ricerche incrementali, la procedura consigliata consiste nell'associare lo stesso controller di dominio usato nella ricerca precedente, ovvero il controller di dominio che ha generato il cookie.</span><span class="sxs-lookup"><span data-stu-id="d4432-139">For incremental searches, the best practice is to bind to the same domain controller (DC) used in the previous search, that is, the DC that generated the cookie.</span></span> <span data-ttu-id="d4432-140">Se lo stesso controller di dominio non è disponibile, attendere che sia o eseguire un'associazione a un nuovo controller di dominio ed eseguire una sincronizzazione completa.</span><span class="sxs-lookup"><span data-stu-id="d4432-140">If the same DC is unavailable, either wait until it is, or bind to a new DC and perform a full synchronization.</span></span> <span data-ttu-id="d4432-141">Archiviare il nome DNS del controller di dominio nell'archivio secondario con il cookie.</span><span class="sxs-lookup"><span data-stu-id="d4432-141">Store the DNS name of the DC in the secondary storage with the cookie.</span></span>

    <span data-ttu-id="d4432-142">È possibile passare un cookie generato da un controller di dominio a un controller di dominio diverso che ospita una replica della stessa partizione di directory.</span><span class="sxs-lookup"><span data-stu-id="d4432-142">You can pass a cookie generated by one DC to a different DC hosting a replica of the same directory partition.</span></span> <span data-ttu-id="d4432-143">Non è possibile che un client perda le modifiche utilizzando un cookie da un controller di dominio in un altro controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="d4432-143">There is no chance that a client will miss changes by using a cookie from one DC on another DC.</span></span> <span data-ttu-id="d4432-144">Tuttavia, è possibile che i risultati della ricerca del nuovo controller di dominio includano le modifiche segnalate dal DC precedente; in alcuni casi, il nuovo controller di dominio può restituire tutti gli oggetti e gli attributi, come con una sincronizzazione completa.</span><span class="sxs-lookup"><span data-stu-id="d4432-144">However, it is possible that the search results from the new DC may include reported changes by the old DC; in some cases, the new DC may return all objects and attributes, as with a full synchronization.</span></span> <span data-ttu-id="d4432-145">Il client deve semplicemente rendere il proprio database coerente con i risultati della ricerca segnalati per una determinata chiamata a DirSync, ovvero gestire tutti i risultati incrementali come se fossero lo stato più recente.</span><span class="sxs-lookup"><span data-stu-id="d4432-145">The client should just make its database consistent with reported search results for any given DirSync call, that is, handle all incremental results as if they were the latest state.</span></span> <span data-ttu-id="d4432-146">Non è importante sapere se la modifica è stata apportata prima o addirittura a uno stato precedente perché le sincronizzazioni incrementali ripetute convergeranno sulla coerenza.</span><span class="sxs-lookup"><span data-stu-id="d4432-146">It does not matter whether you have seen the change before or are even going back to a previous state because repeated incremental synchronizations will converge on consistency.</span></span>

-   <span data-ttu-id="d4432-147">Quando un oggetto viene rinominato o spostato, i relativi oggetti figlio, se presenti, non vengono inclusi nei risultati della ricerca, anche se i nomi distinti degli oggetti figlio sono stati modificati.</span><span class="sxs-lookup"><span data-stu-id="d4432-147">When an object is renamed or moved, its child objects, if any, are not included in the search results, even though the distinguished names of the child objects have changed.</span></span> <span data-ttu-id="d4432-148">Analogamente, quando una voce ACE ereditabile viene modificata in un descrittore di sicurezza dell'oggetto, gli oggetti figlio dell'oggetto non vengono inclusi nei risultati della ricerca, anche se i descrittori di sicurezza degli oggetti figlio sono stati modificati.</span><span class="sxs-lookup"><span data-stu-id="d4432-148">Similarly, when an inheritable ACE is modified in an object security-descriptor, the child objects of the object are not included in the search results, even though the security-descriptors of the child objects have changed.</span></span>
-   <span data-ttu-id="d4432-149">Usare l'attributo **objectGUID** per identificare gli oggetti rilevati.</span><span class="sxs-lookup"><span data-stu-id="d4432-149">Use the **objectGUID** attribute to identify the tracked objects.</span></span> <span data-ttu-id="d4432-150">Il **objectGUID** di ogni oggetto rimane invariato indipendentemente dalla posizione in cui l'oggetto viene spostato all'interno dell'insieme di strutture.</span><span class="sxs-lookup"><span data-stu-id="d4432-150">The **objectGUID** of each object remains unchanged regardless of where the object is moved within the forest.</span></span>
-   <span data-ttu-id="d4432-151">Tenere presente che i risultati della ricerca di una ricerca DirSync indicano lo stato degli oggetti in una replica della partizione di directory al momento della ricerca.</span><span class="sxs-lookup"><span data-stu-id="d4432-151">Be aware that the search results of a DirSync search indicate the state of the objects on a replica of the directory partition at the time of the search.</span></span> <span data-ttu-id="d4432-152">Ciò significa che le modifiche apportate agli altri controller di dominio non verranno incluse se non sono state replicate nel controller di dominio di destinazione.</span><span class="sxs-lookup"><span data-stu-id="d4432-152">This means that changes made on other DCs will not be included if they have not been replicated to the target DC.</span></span> <span data-ttu-id="d4432-153">Significa anche che gli attributi di un oggetto possono essere stati modificati più volte dalla ricerca DirSync precedente, ma la ricerca visualizzerà solo lo stato finale, non la sequenza di modifiche.</span><span class="sxs-lookup"><span data-stu-id="d4432-153">It also means that an object's attributes may have changed several times since the previous DirSync search, but the search will show only the final state, not the sequence of changes.</span></span>
-   <span data-ttu-id="d4432-154">Nell'implementazione di ADSI, l'applicazione deve gestire il cookie come opaco e non creare presupposti sul valore o sull'organizzazione interna.</span><span class="sxs-lookup"><span data-stu-id="d4432-154">In the ADSI implementation, the application must handle the cookie as opaque and not make any assumptions about its internal organization or value.</span></span>
-   <span data-ttu-id="d4432-155">Tenere presente che il client archivia il cookie, la lunghezza dei cookie e il nome DNS del controller di dominio nella stessa risorsa di archiviazione che contiene i dati dell'oggetto sincronizzato.</span><span class="sxs-lookup"><span data-stu-id="d4432-155">Be aware that the client stores the cookie, cookie length, and DNS name of the DC in the same storage that contains the synchronized object data.</span></span> <span data-ttu-id="d4432-156">In questo modo si garantisce che il cookie e gli altri parametri rimangano sincronizzati con i dati dell'oggetto se l'archiviazione viene ripristinata da un backup.</span><span class="sxs-lookup"><span data-stu-id="d4432-156">This ensures that the cookie and other parameters remain in sync with the object data if the storage is ever restored from a backup.</span></span>
-   <span data-ttu-id="d4432-157">Per recuperare l'attributo [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) , costruito per il controllo DirSync, è anche necessario richiedere l'attributo [**Name**](/windows/desktop/ADSchema/a-name) .</span><span class="sxs-lookup"><span data-stu-id="d4432-157">To retrieve the [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) attribute, which is constructed for the DirSync control, it is also necessary to request the [**name**](/windows/desktop/ADSchema/a-name) attribute.</span></span>

<span data-ttu-id="d4432-158">Per usare il controllo DirSync, il chiamante deve avere il diritto "directory Get Changes" assegnato alla radice della partizione monitorata.</span><span class="sxs-lookup"><span data-stu-id="d4432-158">To use the DirSync control, caller must have the "directory get changes" right assigned on the root of the partition being monitored.</span></span> <span data-ttu-id="d4432-159">Per impostazione predefinita, questo diritto viene assegnato agli account Administrator e LocalSystem nei controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="d4432-159">By default, this right is assigned to the Administrator and LocalSystem accounts on domain controllers.</span></span> <span data-ttu-id="d4432-160">Il chiamante deve avere anche il diritto di accesso per il controllo esteso [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) .</span><span class="sxs-lookup"><span data-stu-id="d4432-160">The caller must also have the [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) extended control access right.</span></span> <span data-ttu-id="d4432-161">Per ulteriori informazioni sull'implementazione di un meccanismo di rilevamento delle modifiche per le applicazioni che devono essere eseguite con un account che non dispone di questo diritto, vedere [polling delle modifiche con uSNChanged](polling-for-changes-using-usnchanged.md).</span><span class="sxs-lookup"><span data-stu-id="d4432-161">For more information about implementing a change-tracking mechanism for applications that must run under an account that does not have this right, see [Polling for Changes Using USNChanged](polling-for-changes-using-usnchanged.md).</span></span> <span data-ttu-id="d4432-162">Per ulteriori informazioni sui privilegi, vedere [privilegi](/windows/desktop/SecAuthZ/privileges).</span><span class="sxs-lookup"><span data-stu-id="d4432-162">For more information about privileges, see [Privileges](/windows/desktop/SecAuthZ/privileges).</span></span>

## <a name="retrieving-deleted-objects-with-a-dirsync-search"></a><span data-ttu-id="d4432-163">Recupero di oggetti eliminati con una ricerca DirSync</span><span class="sxs-lookup"><span data-stu-id="d4432-163">Retrieving Deleted Objects With a DirSync Search</span></span>

<span data-ttu-id="d4432-164">I risultati della ricerca di **Ads \_ SEARCHPREF \_ dirsync** includono automaticamente oggetti eliminati (Tombstone) che corrispondono al filtro di ricerca specificato.</span><span class="sxs-lookup"><span data-stu-id="d4432-164">The **ADS\_SEARCHPREF\_DIRSYNC** search results automatically include deleted objects (tombstones) that match the specified search filter.</span></span> <span data-ttu-id="d4432-165">Tuttavia, un filtro di ricerca che corrisponderà a un oggetto quando è attivo potrebbe non corrispondere all'oggetto dopo l'eliminazione.</span><span class="sxs-lookup"><span data-stu-id="d4432-165">However, a search filter that will match an object when it is live may not match the object after it is deleted.</span></span> <span data-ttu-id="d4432-166">Questo perché la rimozione definitiva mantiene solo un subset degli attributi presenti nell'oggetto originale.</span><span class="sxs-lookup"><span data-stu-id="d4432-166">This is because tombstones retain only a subset of the attributes present on the original object.</span></span> <span data-ttu-id="d4432-167">Ad esempio, si usa in genere il filtro seguente per gli oggetti utente.</span><span class="sxs-lookup"><span data-stu-id="d4432-167">For example, you would typically use the following filter for user objects.</span></span>


```C++
(&(objectClass=user)(objectCategory=person))
```



<span data-ttu-id="d4432-168">L'attributo **objectCategory** viene rimosso quando viene eliminato un oggetto, quindi il filtro precedente non corrisponde ad alcun oggetto contrassegnato per la rimozione definitiva.</span><span class="sxs-lookup"><span data-stu-id="d4432-168">The **objectCategory** attribute is removed when an object is deleted, so the filter above would not match any tombstone objects.</span></span> <span data-ttu-id="d4432-169">Viceversa, l'attributo **objectClass** viene mantenuto sugli oggetti contrassegnati per la rimozione definitiva, quindi un filtro di "(objectClass = user)" corrisponderà a oggetti utente eliminati.</span><span class="sxs-lookup"><span data-stu-id="d4432-169">Conversely, the **objectClass** attribute is retained on tombstone objects, so a filter of "(objectClass=user)" would match deleted user objects.</span></span>

<span data-ttu-id="d4432-170">L'elenco di attributi specificato con una ricerca DirSync funge anche da filtro; i risultati della ricerca includono solo oggetti in cui uno o più attributi specificati sono stati modificati dopo la ricerca DirSync precedente.</span><span class="sxs-lookup"><span data-stu-id="d4432-170">The attribute list that you specify with a DirSync search also acts as a filter; search results include only objects on which one or more of the specified attributes have changed since the previous DirSync search.</span></span> <span data-ttu-id="d4432-171">Se nell'elenco di attributi non sono inclusi attributi conservati per la rimozione definitiva, i risultati della ricerca non includeranno oggetti contrassegnati per la rimozione definitiva.</span><span class="sxs-lookup"><span data-stu-id="d4432-171">If the attribute list does not include any attributes that are retained on tombstones, the search results will not include tombstones.</span></span> <span data-ttu-id="d4432-172">Per gestire questo problema, richiedere tutti gli attributi specificando un elenco di attributi null; in alternativa, è possibile richiedere l'attributo **eliminato** , impostare su **true** per tutte le lapidi.</span><span class="sxs-lookup"><span data-stu-id="d4432-172">To handle this, request all attributes by specifying a null attribute list; or you can request the **isDeleted** attribute, set to **TRUE** on all tombstones.</span></span> <span data-ttu-id="d4432-173">Per gli attributi Tombstone il bit 0x8 è impostato nell'attributo **searchFlags** della definizione **attributeSchema** .</span><span class="sxs-lookup"><span data-stu-id="d4432-173">Tombstone attributes have the 0x8 bit set in the **searchFlags** attribute of the **attributeSchema** definition.</span></span>

<span data-ttu-id="d4432-174">Per ulteriori informazioni, vedere [recupero di oggetti eliminati](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="d4432-174">For more information, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>

## <a name="ldap-implementation-of-the-dirsync-control"></a><span data-ttu-id="d4432-175">Implementazione LDAP del controllo DirSync</span><span class="sxs-lookup"><span data-stu-id="d4432-175">LDAP Implementation of the DirSync Control</span></span>

<span data-ttu-id="d4432-176">È anche possibile eseguire una ricerca DirSync usando l'API LDAP con il controllo [ \_ \_ \_ OID del server LDAP](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) .</span><span class="sxs-lookup"><span data-stu-id="d4432-176">You can also perform a DirSync search by using the LDAP API with the [LDAP\_SERVER\_DIRSYNC\_OID](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) control.</span></span> <span data-ttu-id="d4432-177">Se si usa l'API LDAP, specificare anche l' [ \_ \_ \_ \_ OID del server LDAP esteso](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) e il [server LDAP Visualizza i controlli \_ \_ \_ \_ OID eliminati](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) .</span><span class="sxs-lookup"><span data-stu-id="d4432-177">If you use the LDAP API, also specify the [LDAP\_SERVER\_EXTENDED\_DN\_OID](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) and [LDAP\_SERVER\_SHOW\_DELETED\_OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) controls.</span></span> <span data-ttu-id="d4432-178">Il \_ \_ controllo OID di DN esteso del server LDAP causa la restituzione di una \_ \_ forma estesa del nome distinto che include **objectGUID** e **objectSID** per gli oggetti entità di sicurezza, ad esempio utenti, gruppi e computer.</span><span class="sxs-lookup"><span data-stu-id="d4432-178">The LDAP\_SERVER\_EXTENDED\_DN\_OID control causes an LDAP search to return an extended form of the distinguished name that includes the **objectGUID** and **objectSID** for security principal objects such as users, groups, and computers.</span></span> <span data-ttu-id="d4432-179">Il \_ \_ controllo OID eliminato del server LDAP indica \_ \_ che i risultati della ricerca includono i dati per gli oggetti eliminati.</span><span class="sxs-lookup"><span data-stu-id="d4432-179">The LDAP\_SERVER\_SHOW\_DELETED\_OID control causes the search results to include data for deleted objects.</span></span> <span data-ttu-id="d4432-180">Tenere presente che questi controlli vengono inclusi automaticamente nell'implementazione di ADSI.</span><span class="sxs-lookup"><span data-stu-id="d4432-180">Be aware that these controls are automatically included in the ADSI implementation.</span></span>

 

 