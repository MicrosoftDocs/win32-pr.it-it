---
title: Modalità di registrazione dei nomi SPN da un servizio
description: Prima che un client possa utilizzare un nome SPN per autenticare un'istanza di un servizio, è necessario che il nome SPN sia registrato nell'account utente o computer che verrà utilizzato dall'istanza del servizio per l'accesso.
ms.assetid: 39712c1f-3a9a-4c98-a1cb-879ab0b4cb63
ms.tgt_platform: multiple
keywords:
- Modalità di registrazione di un servizio AD SPN
- nome dell'entità servizio AD, come un servizio registra i relativi nomi SPN
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 74410be3a024fc6accd1d8394e2ba8335be9f550
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/16/2019
ms.locfileid: "103855426"
---
# <a name="how-a-service-registers-its-spns"></a><span data-ttu-id="225df-105">Modalità di registrazione dei nomi SPN da un servizio</span><span class="sxs-lookup"><span data-stu-id="225df-105">How a Service Registers its SPNs</span></span>

<span data-ttu-id="225df-106">Prima che un client possa utilizzare un nome SPN per autenticare un'istanza di un servizio, è necessario che il nome SPN sia registrato nell'account utente o computer che verrà utilizzato dall'istanza del servizio per l'accesso.</span><span class="sxs-lookup"><span data-stu-id="225df-106">Before a client can use an SPN to authenticate an instance of a service, the SPN must be registered on the user or computer account that the service instance will use to log on.</span></span> <span data-ttu-id="225df-107">In genere, la registrazione del nome SPN viene eseguita da un programma di installazione del servizio in esecuzione con privilegi di amministratore di dominio.</span><span class="sxs-lookup"><span data-stu-id="225df-107">Typically, SPN registration is done by a service installation program running with domain administrator privileges.</span></span>

<span data-ttu-id="225df-108">Il programma di installazione del servizio che installa un'istanza del servizio in un computer host esegue in genere la procedura riportata di seguito.</span><span class="sxs-lookup"><span data-stu-id="225df-108">The service installer that installs a service instance on a host computer typically performs the following procedure.</span></span>

<span data-ttu-id="225df-109">**Per registrare i nomi SPN per un'istanza del servizio**</span><span class="sxs-lookup"><span data-stu-id="225df-109">**To register SPNs for a service instance**</span></span>

1.  <span data-ttu-id="225df-110">Chiamare la funzione [**DsGetSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetspna) per creare uno o più nomi SPN univoci per l'istanza del servizio.</span><span class="sxs-lookup"><span data-stu-id="225df-110">Call the [**DsGetSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetspna) function to create one or more unique SPNs for the service instance.</span></span> <span data-ttu-id="225df-111">Per ulteriori informazioni, vedere [formati dei nomi per nomi SPN univoci](name-formats-for-unique-spns.md).</span><span class="sxs-lookup"><span data-stu-id="225df-111">For more information, see [Name Formats for Unique SPNs](name-formats-for-unique-spns.md).</span></span>
2.  <span data-ttu-id="225df-112">Chiamare la funzione [**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna) per registrare i nomi nell'account di accesso del servizio.</span><span class="sxs-lookup"><span data-stu-id="225df-112">Call the [**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna) function to register the names on the service's logon account.</span></span>

<span data-ttu-id="225df-113">[**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna) registra i nomi SPN come proprietà di un oggetto account utente o computer nella directory.</span><span class="sxs-lookup"><span data-stu-id="225df-113">[**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna) registers SPNs as a property of a user or computer account object in the directory.</span></span> <span data-ttu-id="225df-114">gli oggetti **utente** e **computer** hanno un attributo **servicePrincipalName** , che è un attributo multivalore per l'archiviazione di tutti i nomi SPN associati a un account utente o computer.</span><span class="sxs-lookup"><span data-stu-id="225df-114">**user** and **computer** objects have a **servicePrincipalName** attribute, which is a multi-valued attribute for storing all the SPNs associated with a user or computer account.</span></span> <span data-ttu-id="225df-115">Se il servizio viene eseguito con un account utente, i nomi SPN vengono archiviati nell'attributo **servicePrincipalName** di tale account.</span><span class="sxs-lookup"><span data-stu-id="225df-115">If the service runs under a user account, the SPNs are stored in the **servicePrincipalName** attribute of that account.</span></span> <span data-ttu-id="225df-116">Se il servizio viene eseguito nell'account LocalSystem, i nomi SPN vengono archiviati nell'attributo **servicePrincipalName** dell'account del computer host del servizio.</span><span class="sxs-lookup"><span data-stu-id="225df-116">If the service runs in the LocalSystem account, the SPNs are stored in the **servicePrincipalName** attribute of the account of the service's host computer.</span></span> <span data-ttu-id="225df-117">Il chiamante **DsWriteAccountSpn** deve specificare il nome distinto dell'oggetto account in cui sono archiviati i nomi SPN.</span><span class="sxs-lookup"><span data-stu-id="225df-117">The **DsWriteAccountSpn** caller must specify the distinguished name of the account object under which the SPNs are stored.</span></span>

<span data-ttu-id="225df-118">Per assicurarsi che i nomi SPN registrati siano protetti, l'attributo **servicePrincipalName** non può essere scritto direttamente; può essere scritto solo chiamando [**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna).</span><span class="sxs-lookup"><span data-stu-id="225df-118">To ensure that registered SPNs are secure, the **servicePrincipalName** attribute cannot be written directly; it can only be written by calling [**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna).</span></span> <span data-ttu-id="225df-119">Il chiamante deve disporre dell'accesso in scrittura all'attributo **servicePrincipalName** dell'account di destinazione.</span><span class="sxs-lookup"><span data-stu-id="225df-119">The caller must have write-access to the **servicePrincipalName** attribute of the target account.</span></span> <span data-ttu-id="225df-120">Per impostazione predefinita, l'accesso in scrittura viene concesso solo agli amministratori di dominio.</span><span class="sxs-lookup"><span data-stu-id="225df-120">Typically, write access is granted by default only to domain administrators.</span></span> <span data-ttu-id="225df-121">Tuttavia, esiste un caso speciale in cui il sistema consente a un servizio in esecuzione con l'account LocalSystem di registrare i propri nomi SPN nell'account computer dell'host del servizio.</span><span class="sxs-lookup"><span data-stu-id="225df-121">However, there is a special case in which the system allows a service running under the LocalSystem account to register its own SPNs on the computer account of the service's host.</span></span> <span data-ttu-id="225df-122">In questo caso, il nome SPN scritto deve avere il formato " <service class> / <host> " e " &lt; host &gt; " deve corrispondere al nome DNS del computer locale.</span><span class="sxs-lookup"><span data-stu-id="225df-122">In this case, the SPN being written must have the form "<service class>/<host>" and "&lt;host&gt;" must be the DNS name of the local computer.</span></span>

<span data-ttu-id="225df-123">[**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna) può anche rimuovere i nomi SPN da un account.</span><span class="sxs-lookup"><span data-stu-id="225df-123">[**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna) can also remove SPNs from an account.</span></span> <span data-ttu-id="225df-124">Un parametro Operation indica se gli SPN devono essere aggiunti all'account, rimossi dall'account o utilizzati per sostituire completamente tutti i nomi SPN correnti per l'account.</span><span class="sxs-lookup"><span data-stu-id="225df-124">An operation parameter indicates whether the SPNs are to be added to the account, removed from the account, or used to completely replace all current SPNs for the account.</span></span> <span data-ttu-id="225df-125">Quando viene disinstallata un'istanza del servizio, rimuovere tutti i nomi SPN registrati per tale istanza.</span><span class="sxs-lookup"><span data-stu-id="225df-125">When a service instance is uninstalled, remove any SPNs registered for that instance.</span></span>

<span data-ttu-id="225df-126">Per ulteriori informazioni e un esempio di codice che registra o Annulla la registrazione dei nomi SPN di un servizio, vedere [la pagina relativa alla registrazione dei nomi SPN per un servizio](registering-the-spns-for-a-service.md).</span><span class="sxs-lookup"><span data-stu-id="225df-126">For more information and a code example that registers or unregisters a service's SPNs, see [Registering the SPNs for a Service](registering-the-spns-for-a-service.md).</span></span>

<span data-ttu-id="225df-127">I servizi basati su host che usano il formato SPN semplice " <service class> / <host> " hanno la possibilità di usare la funzione [**DsServerRegisterSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsserverregisterspna) , che consente di creare e registrare i nomi SPN per un'istanza del servizio.</span><span class="sxs-lookup"><span data-stu-id="225df-127">Host-based services that use the simple SPN format "<service class>/<host>", have the option of using the [**DsServerRegisterSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsserverregisterspna) function, which both creates and registers SPNs for a service instance.</span></span> <span data-ttu-id="225df-128">**DsServerRegisterSpn** è una funzione di supporto che chiama [**DsGetSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetspna) e [**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna).</span><span class="sxs-lookup"><span data-stu-id="225df-128">**DsServerRegisterSpn** is a helper function that calls [**DsGetSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetspna) and [**DsWriteAccountSpn**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna).</span></span>

<span data-ttu-id="225df-129">Per ulteriori informazioni, vedere [account di accesso al servizio](service-logon-accounts.md).</span><span class="sxs-lookup"><span data-stu-id="225df-129">For more information, see [Service Logon Accounts](service-logon-accounts.md).</span></span>

 

 




