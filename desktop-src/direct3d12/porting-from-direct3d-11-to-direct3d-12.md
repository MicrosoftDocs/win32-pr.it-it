---
title: Conversione da Direct3D 11 a Direct3D 12
description: In questa sezione vengono fornite alcune indicazioni sul porting da un motore di grafica Direct3D 11 personalizzato a Direct3D 12.
ms.assetid: 9EB4AC6B-AFDD-4673-8EB3-54272C151784
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14b5bc6784d6f96c3c1599a601a57bf68b0d612d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/20/2020
ms.locfileid: "104548870"
---
# <a name="porting-from-direct3d-11-to-direct3d-12"></a><span data-ttu-id="20066-103">Conversione da Direct3D 11 a Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="20066-103">Porting from Direct3D 11 to Direct3D 12</span></span>

<span data-ttu-id="20066-104">In questa sezione vengono fornite alcune indicazioni sul porting da un motore di grafica Direct3D 11 personalizzato a Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="20066-104">This section provides some guidance on porting from a custom Direct3D 11 graphics engine to Direct3D 12.</span></span>

-   [<span data-ttu-id="20066-105">Creazione del dispositivo</span><span class="sxs-lookup"><span data-stu-id="20066-105">Device creation</span></span>](#device-creation)
-   [<span data-ttu-id="20066-106">Risorse sottoposte a commit</span><span class="sxs-lookup"><span data-stu-id="20066-106">Committed resources</span></span>](#committed-resources)
-   [<span data-ttu-id="20066-107">Risorse riservate</span><span class="sxs-lookup"><span data-stu-id="20066-107">Reserved resources</span></span>](#reserved-resources)
-   [<span data-ttu-id="20066-108">Caricamento dei dati</span><span class="sxs-lookup"><span data-stu-id="20066-108">Uploading data</span></span>](#uploading-data)
-   [<span data-ttu-id="20066-109">Shader e oggetti shader</span><span class="sxs-lookup"><span data-stu-id="20066-109">Shaders and shader objects</span></span>](#shaders-and-shader-objects)
-   [<span data-ttu-id="20066-110">Invio di lavoro alla GPU</span><span class="sxs-lookup"><span data-stu-id="20066-110">Submitting work to the GPU</span></span>](#submitting-work-to-the-gpu)
-   [<span data-ttu-id="20066-111">Sincronizzazione CPU/GPU</span><span class="sxs-lookup"><span data-stu-id="20066-111">CPU/GPU Synchronization</span></span>](#cpugpu-synchronization)
-   [<span data-ttu-id="20066-112">Associazione di risorse</span><span class="sxs-lookup"><span data-stu-id="20066-112">Resource Binding</span></span>](#resource-binding)
-   [<span data-ttu-id="20066-113">Stato risorsa</span><span class="sxs-lookup"><span data-stu-id="20066-113">Resource state</span></span>](#resource-state)
-   [<span data-ttu-id="20066-114">Le catene</span><span class="sxs-lookup"><span data-stu-id="20066-114">Swapchains</span></span>](#swapchains)
-   [<span data-ttu-id="20066-115">Correzione del rendering della funzione</span><span class="sxs-lookup"><span data-stu-id="20066-115">Fixed function rendering</span></span>](#fixed-function-rendering)
-   [<span data-ttu-id="20066-116">Probabilità e fine</span><span class="sxs-lookup"><span data-stu-id="20066-116">Odds and ends</span></span>](#odds-and-ends)
-   [<span data-ttu-id="20066-117">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="20066-117">Related topics</span></span>](#related-topics)

## <a name="device-creation"></a><span data-ttu-id="20066-118">Creazione del dispositivo</span><span class="sxs-lookup"><span data-stu-id="20066-118">Device creation</span></span>

<span data-ttu-id="20066-119">Direct3D 11 e Direct3D 12 condividono un modello di creazione del dispositivo simile.</span><span class="sxs-lookup"><span data-stu-id="20066-119">Both Direct3D 11 and Direct3D 12 share a simliar device creation pattern.</span></span> <span data-ttu-id="20066-120">I driver Direct3D 12 esistenti sono tutti **D3D_FEATURE_LEVEL_11_0** o meglio, quindi è possibile ignorare i livelli di funzionalità precedenti e i lmitations associati.</span><span class="sxs-lookup"><span data-stu-id="20066-120">Existing Direct3D 12 drivers are all **D3D_FEATURE_LEVEL_11_0** or better, so you can ignore the older feature levels and associated lmitations.</span></span>

<span data-ttu-id="20066-121">Tenere inoltre presente che con Direct3D 12 è necessario enumerare in modo esplicito le informazioni sul dispositivo usando le interfacce DXGI.</span><span class="sxs-lookup"><span data-stu-id="20066-121">Also keep in mind that with Direct3D 12, you should explicitly enumerate device information using DXGI interfaces.</span></span> <span data-ttu-id="20066-122">In Direct3D 11, è possibile *concatenare* il dispositivo DXGI dal dispositivo Direct3D e questa operazione non è supportata per Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="20066-122">In Direct3D 11, you could *chain back* to the DXGI device from the Direct3D device, and this is not supported for Direct3D 12.</span></span>

<span data-ttu-id="20066-123">La creazione di un dispositivo software WARP in Direct3D 12 viene eseguita fornendo una scheda esplicita ottenuta da **IDXGIFcatory4:: EnumWarpAdapter**.</span><span class="sxs-lookup"><span data-stu-id="20066-123">Creating a WARP software device on Direct3D 12 is done by providing an explicit adapter obtained from **IDXGIFcatory4::EnumWarpAdapter**.</span></span> <span data-ttu-id="20066-124">Il dispositivo WARP per Direct3D 12 è disponibile solo nei sistemi con la funzionalità facoltativa **strumenti di grafica** abilitata.</span><span class="sxs-lookup"><span data-stu-id="20066-124">The WARP device for Direct3D 12 is available only on systems with the **Graphics Tools** optional feature enabled.</span></span>

> [!NOTE]
> <span data-ttu-id="20066-125">Non esiste alcun equivalente a **D3D11CreateDeviceAndSwapChain**.</span><span class="sxs-lookup"><span data-stu-id="20066-125">There is no equivalent to **D3D11CreateDeviceAndSwapChain**.</span></span> <span data-ttu-id="20066-126">Anche con Direct3D 11, si sconsiglia l'uso di questa funzione perché è spesso preferibile creare il dispositivo e presentazione catena in passaggi distinti.</span><span class="sxs-lookup"><span data-stu-id="20066-126">Even with Direct3D 11, we discourage the use of this function as it's often better to create the device and swapchain in distinct steps.</span></span>

## <a name="committed-resources"></a><span data-ttu-id="20066-127">Risorse sottoposte a commit</span><span class="sxs-lookup"><span data-stu-id="20066-127">Committed resources</span></span>

<span data-ttu-id="20066-128">Gli oggetti creati con le interfacce seguenti in Direct3D 11, si traducono in quelli denominati "risorse vincolate" in Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="20066-128">Objects created with the following interfaces in Direct3D 11, translate to what are called "committed resources" in Direct3D 12.</span></span> <span data-ttu-id="20066-129">Una risorsa di cui è stato eseguito il commit è una risorsa a cui sono associati sia lo spazio degli indirizzi virtuale che le pagine fisiche.</span><span class="sxs-lookup"><span data-stu-id="20066-129">A committed resource is a resource which has both virtual address space and physical pages associated with it.</span></span> <span data-ttu-id="20066-130">Si tratta di un concetto di modello di memoria di Microsoft Windows Device Driver 2 (WDD2) su cui si basa Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="20066-130">This is a concept of the Microsoft Windows Device Driver 2 (WDD2) Memory Model, on which Direct3D 12 is based.</span></span>

<span data-ttu-id="20066-131">Risorse Direct3D 11:</span><span class="sxs-lookup"><span data-stu-id="20066-131">Direct3D 11 resources:</span></span>

-   [<span data-ttu-id="20066-132">**ID3D11Resource**</span><span class="sxs-lookup"><span data-stu-id="20066-132">**ID3D11Resource**</span></span>](/windows/win32/api/d3d11/nn-d3d11-id3d11resource)
-   <span data-ttu-id="20066-133">[**ID3D11Buffer**](/windows/win32/api/d3d11/nn-d3d11-id3d11buffer) e [ **ID3D11Device:: CreateBuffer**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createbuffer)</span><span class="sxs-lookup"><span data-stu-id="20066-133">[**ID3D11Buffer**](/windows/win32/api/d3d11/nn-d3d11-id3d11buffer) and [**ID3D11Device::CreateBuffer**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createbuffer)</span></span>
-   <span data-ttu-id="20066-134">[**ID3D11Texture1D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture1d) e [ **ID3D11Device: CreateTexture1D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture1d)</span><span class="sxs-lookup"><span data-stu-id="20066-134">[**ID3D11Texture1D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture1d) and [**ID3D11Device:CreateTexture1D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture1d)</span></span>
-   <span data-ttu-id="20066-135">[**ID3D11Texture2D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture2d) e [ **ID3D11Device:: CreateTexture2D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture2d)</span><span class="sxs-lookup"><span data-stu-id="20066-135">[**ID3D11Texture2D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture2d) and [**ID3D11Device::CreateTexture2D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture2d)</span></span>
-   <span data-ttu-id="20066-136">[**ID3D11Texture3D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture3d) e [ **ID3D11Device:: CreateTexture3D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture3d)</span><span class="sxs-lookup"><span data-stu-id="20066-136">[**ID3D11Texture3D**](/windows/win32/api/d3d11/nn-d3d11-id3d11texture3d) and [**ID3D11Device::CreateTexture3D**](/windows/win32/api/d3d11/nf-d3d11-id3d11device-createtexture3d)</span></span>

<span data-ttu-id="20066-137">In Direct3D 12 queste sono tutte rappresentate da [**ID3D12Resource**](/windows/win32/api/d3d12/nn-d3d12-id3d12resource) e [**ID3D12Device:: CreateCommittedResource**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createcommittedresource).</span><span class="sxs-lookup"><span data-stu-id="20066-137">In Direct3D 12 these are all represented by [**ID3D12Resource**](/windows/win32/api/d3d12/nn-d3d12-id3d12resource) and [**ID3D12Device::CreateCommittedResource**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createcommittedresource).</span></span>

## <a name="reserved-resources"></a><span data-ttu-id="20066-138">Risorse riservate</span><span class="sxs-lookup"><span data-stu-id="20066-138">Reserved resources</span></span>

<span data-ttu-id="20066-139">Le risorse riservate sono risorse in cui è stato allocato solo lo spazio degli indirizzi virtuali. la memoria fisica non viene allocata fino a quando non viene chiamata a [**ID3D12Device:: createheap ha provocato**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createheap).</span><span class="sxs-lookup"><span data-stu-id="20066-139">Reserved resources are resources where only virtual address space has been allocated, physical memory is not allocated until there is a call to [**ID3D12Device::CreateHeap**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createheap).</span></span> <span data-ttu-id="20066-140">Si tratta essenzialmente dello stesso concetto di risorse affiancate in Direct3D 11.</span><span class="sxs-lookup"><span data-stu-id="20066-140">This is essentially the same concept as tiled resources in Direct3D 11.</span></span>

<span data-ttu-id="20066-141">Flag ([**d3d11 \_ Resource \_ varie \_ flag**](/windows/win32/api/d3d11/ne-d3d11-d3d11_resource_misc_flag)) usati in Direct3D 11 per configurare le risorse affiancate, quindi eseguirne il mapping alla memoria fisica.</span><span class="sxs-lookup"><span data-stu-id="20066-141">The flags ([**D3D11\_RESOURCE\_MISC\_FLAG**](/windows/win32/api/d3d11/ne-d3d11-d3d11_resource_misc_flag)) used in Direct3D 11 to set up tiled resources, then map them to physical memory.</span></span>

-   <span data-ttu-id="20066-142">\_Varie risorse \_ d3d11 \_ affiancate</span><span class="sxs-lookup"><span data-stu-id="20066-142">D3D11\_RESOURCE\_MISC\_TILED</span></span>
-   <span data-ttu-id="20066-143">\_Pool di \_ \_ sezioni varie della risorsa \_ d3d11</span><span class="sxs-lookup"><span data-stu-id="20066-143">D3D11\_RESOURCE\_MISC\_TILE\_POOL</span></span>

## <a name="uploading-data"></a><span data-ttu-id="20066-144">Caricamento dei dati</span><span class="sxs-lookup"><span data-stu-id="20066-144">Uploading data</span></span>

<span data-ttu-id="20066-145">In Direct3D 11 esiste l'aspetto di una singola sequenza temporale (chiama dopo una sequenza, ad esempio i dati inizializzati con [**\_ \_ i dati della sottorisorsa d3d11**](/windows/win32/api/d3d11/ns-d3d11-d3d11_subresource_data), quindi viene effettuata una chiamata a [**sul ID3D11DeviceContext:: UpdateSubresource**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-updatesubresource)e quindi una chiamata a [**sul ID3D11DeviceContext:: Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map)).</span><span class="sxs-lookup"><span data-stu-id="20066-145">In Direct3D 11 there is the appearance of a single timeline (calls following a sequence, such as data initialized with [**D3D11\_SUBRESOURCE\_DATA**](/windows/win32/api/d3d11/ns-d3d11-d3d11_subresource_data), then a call is made to [**ID3D11DeviceContext::UpdateSubresource**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-updatesubresource), and then a call to [**ID3D11DeviceContext::Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map)).</span></span> <span data-ttu-id="20066-146">Il numero di copie create dai dati non è ovvio per uno sviluppatore Direct3D 11.</span><span class="sxs-lookup"><span data-stu-id="20066-146">The number of copies created of the data is not obvious to a Direct3D 11 developer.</span></span>

<span data-ttu-id="20066-147">In Direct3D 12 sono presenti due sequenze temporali, la sequenza temporale della GPU (configurata dalle chiamate a [**CopyTextureRegion**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-copytextureregion)e [**CopyBufferRegion**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-copybufferregion) da mappabili Memory) e la sequenza temporale della CPU (determinata dalle chiamate a [**Map**](/windows/win32/api/d3d12/nf-d3d12-id3d12resource-map)).</span><span class="sxs-lookup"><span data-stu-id="20066-147">In Direct3D 12 there are two timelines, the GPU timeline (set up by calls to [**CopyTextureRegion**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-copytextureregion), and [**CopyBufferRegion**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-copybufferregion) from mappable memory) and the CPU timeline (determined by calls to [**Map**](/windows/win32/api/d3d12/nf-d3d12-id3d12resource-map)).</span></span> <span data-ttu-id="20066-148">Vengono fornite funzioni di supporto (nel file d3dx12. h) denominate [**updatesubresources con**](updatesubresources1.md) che usano una sequenza temporale condivisa.</span><span class="sxs-lookup"><span data-stu-id="20066-148">Helper functions are provided (in the d3dx12.h file) called [**Updatesubresources**](updatesubresources1.md) that use a shared timeline.</span></span> <span data-ttu-id="20066-149">Esistono diverse varianti di questa funzione helper, una che usa [**ID3D12Device:: GetCopyableFootprints**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-getcopyablefootprints), un'altra che usa un meccanismo di allocazione dell'heap e un'altra che usa un meccanismo di allocazione dello stack.</span><span class="sxs-lookup"><span data-stu-id="20066-149">There are several variations of this helper function, one that uses [**ID3D12Device::GetCopyableFootprints**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-getcopyablefootprints), another that uses a heap-allocating mechanism, and another that uses a stack-allocating mechanism.</span></span> <span data-ttu-id="20066-150">Queste funzioni helper copiano le risorse sia sulla GPU che sulla CPU, tramite un'area di gestione temporanea intermedia di memoria.</span><span class="sxs-lookup"><span data-stu-id="20066-150">These helper functions copy resources to both the GPU and CPU, via an intermediate staging area of memory.</span></span>

<span data-ttu-id="20066-151">In genere, la GPU e la CPU hanno ciascuna una propria copia di una risorsa legata alla propria sequenza temporale.</span><span class="sxs-lookup"><span data-stu-id="20066-151">Typically the GPU and CPU each have their own copy of a resource tied to their own timeline.</span></span> <span data-ttu-id="20066-152">L'approccio della sequenza temporale condivisa gestisce in modo analogo due copie.</span><span class="sxs-lookup"><span data-stu-id="20066-152">The shared timeline approach similarly maintains two copies.</span></span>

## <a name="shaders-and-shader-objects"></a><span data-ttu-id="20066-153">Shader e oggetti shader</span><span class="sxs-lookup"><span data-stu-id="20066-153">Shaders and shader objects</span></span>

<span data-ttu-id="20066-154">In Direct3D 11 sono disponibili numerose attività di creazione di shader e di oggetti di stato e l'impostazione dello stato di tali oggetti, usando i metodi di creazione [**ID3D11Device**](/windows/win32/api/d3d11/nn-d3d11-id3d11device) e i metodi set [**sul ID3D11DeviceContext**](/windows/win32/api/d3d11/nn-d3d11-id3d11devicecontext) .</span><span class="sxs-lookup"><span data-stu-id="20066-154">In Direct3D 11 there is a lot of creation of shader and state objects, and setting the state of those objects, using the [**ID3D11Device**](/windows/win32/api/d3d11/nn-d3d11-id3d11device) creation methods and the [**ID3D11DeviceContext**](/windows/win32/api/d3d11/nn-d3d11-id3d11devicecontext) set methods.</span></span> <span data-ttu-id="20066-155">Viene in genere eseguito un numero elevato di chiamate a questi metodi, che vengono quindi combinati in fase di estrazione dal driver per impostare lo stato corretto della pipeline.</span><span class="sxs-lookup"><span data-stu-id="20066-155">Typically a large number of calls are made to these methods, which are then combined at draw time by the driver to set the correct pipeline state.</span></span>

<span data-ttu-id="20066-156">In Direct3D 12 questa impostazione dello stato della pipeline è stata combinata in un singolo oggetto ([**CreateComputePipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createcomputepipelinestate) per un motore di calcolo e [**CreateGraphicsPipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-creategraphicspipelinestate) per un motore di grafica), che viene quindi collegato a un elenco di comandi prima della chiamata di progetto con una chiamata a [**SetPipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setpipelinestate).</span><span class="sxs-lookup"><span data-stu-id="20066-156">In Direct3D 12 this setting of pipeline state has been combined into a single object ([**CreateComputePipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createcomputepipelinestate) for a compute engine, and [**CreateGraphicsPipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-creategraphicspipelinestate) for a graphics engine), which is then attached to a command list before the draw call with a call to [**SetPipelineState**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setpipelinestate).</span></span>

<span data-ttu-id="20066-157">Queste chiamate sostituiscono tutte le singole chiamate per impostare shader, layout di input, stato di Blend, stato di rasterizzazione, stato di depth stencil e così via, in Direct3D 11</span><span class="sxs-lookup"><span data-stu-id="20066-157">These calls replace all the individual calls to set shaders, input layout, blend state, rasterizer state, depth stencil state, and so on, in Direct3D 11</span></span>

- <span data-ttu-id="20066-158">Metodi Device 11: ``CreateInputLayout`` , ``CreateXShader`` , ``CreateDepthStencilState`` , andd ``CreateRasterizerState`` .</span><span class="sxs-lookup"><span data-stu-id="20066-158">Device 11 methods: ``CreateInputLayout``, ``CreateXShader``, ``CreateDepthStencilState``, andD ``CreateRasterizerState``.</span></span>
- <span data-ttu-id="20066-159">Metodi del contesto di dispositivo 11:  ``IASetInputLayout`` , ``xxSetShader`` , ``OMSetBlendState`` , ``OMSetDepthStencilState`` e ``RSSetState`` .</span><span class="sxs-lookup"><span data-stu-id="20066-159">Device Context 11 methods:  ``IASetInputLayout``, ``xxSetShader``, ``OMSetBlendState``, ``OMSetDepthStencilState``, and ``RSSetState``.</span></span>

<span data-ttu-id="20066-160">Sebbene Direct3D 12 possa supportare i BLOB dello shader compilati meno recenti, gli shader devono essere compilati usando il modello di shader 5,1 con le API FXC/D3DCompile o usando il modello di shader 6 usando il compilatore DXC di DXIL.</span><span class="sxs-lookup"><span data-stu-id="20066-160">While Direct3D 12 can support older compiled shader blobs, shaders should be built using either Shader Model 5.1 with the FXC/D3DCompile APIs, or using Shader Model 6 using the DXIL DXC compiler.</span></span> <span data-ttu-id="20066-161">È necessario convalidare il supporto del modello di shader 6 con [**CheckFeatureSupport**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-checkfeaturesupport) e **D3D12_FEATURE_SHADER_MODEL**.</span><span class="sxs-lookup"><span data-stu-id="20066-161">You should validate Shader Model 6 support with [**CheckFeatureSupport**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-checkfeaturesupport) and **D3D12_FEATURE_SHADER_MODEL**.</span></span>

## <a name="submitting-work-to-the-gpu"></a><span data-ttu-id="20066-162">Invio di lavoro alla GPU</span><span class="sxs-lookup"><span data-stu-id="20066-162">Submitting work to the GPU</span></span>

<span data-ttu-id="20066-163">in Direct3D 11 il controllo sul modo in cui viene inviato il lavoro viene gestito in gran parte dal driver, anche se alcuni controlli sono abilitati tramite le chiamate a [**sul ID3D11DeviceContext:: Flush**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-flush) e [**IDXGISwapChain1::P resent1**](/windows/win32/api/dxgi1_2/nf-dxgi1_2-idxgiswapchain1-present1) .</span><span class="sxs-lookup"><span data-stu-id="20066-163">in Direct3D 11 there is little control over actually how work is submitted, it is largely handled by the driver, though some control is enabled through the [**ID3D11DeviceContext::Flush**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-flush) and [**IDXGISwapChain1::Present1**](/windows/win32/api/dxgi1_2/nf-dxgi1_2-idxgiswapchain1-present1) calls.</span></span>

<span data-ttu-id="20066-164">In Direct3D 12 l'invio del lavoro è molto esplicito e controllato dall'app.</span><span class="sxs-lookup"><span data-stu-id="20066-164">In Direct3D 12 work submission is very explicit and controlled by the app.</span></span> <span data-ttu-id="20066-165">Il costrutto principale per l'invio del lavoro è [**ID3D12GraphicsCommandList**](/windows/win32/api/d3d12/nn-d3d12-id3d12graphicscommandlist), che viene usato per registrare tutti i comandi delle app (ed è molto simile a quello del contesto posticipato di ID3D11).</span><span class="sxs-lookup"><span data-stu-id="20066-165">The primary construct for submitting work is the [**ID3D12GraphicsCommandList**](/windows/win32/api/d3d12/nn-d3d12-id3d12graphicscommandlist), which is used to record all the apps commands (and is quite similar in concept to the ID3D11 deferred context).</span></span> <span data-ttu-id="20066-166">L'archivio di backup per un elenco di comandi viene fornito da [**ID3D12CommandAllocator**](/windows/win32/api/d3d12/nn-d3d12-id3d12commandallocator), che consente all'app di gestire l'utilizzo della memoria dell'elenco di comandi esponendo effettivamente la memoria che il driver Direct3D 12 utilizzerà per archiviare l'elenco dei comandi.</span><span class="sxs-lookup"><span data-stu-id="20066-166">Backing store for a command list is provided by the [**ID3D12CommandAllocator**](/windows/win32/api/d3d12/nn-d3d12-id3d12commandallocator), which enables the app to manage the memory utilization of the command list by actually exposing the memory that the Direct3D 12 driver is going to use to store the command list.</span></span>

<span data-ttu-id="20066-167">Infine, [**ID3D12CommandQueue**](/windows/win32/api/d3d12/nn-d3d12-id3d12commandqueue) è una coda First-in First-out, che archivia l'ordine corretto degli elenchi di comandi per l'invio alla GPU.</span><span class="sxs-lookup"><span data-stu-id="20066-167">Finally the [**ID3D12CommandQueue**](/windows/win32/api/d3d12/nn-d3d12-id3d12commandqueue) is a first-in first-out queue, that stores the correct order of the command lists for submission to the GPU.</span></span> <span data-ttu-id="20066-168">Solo quando un elenco di comandi ha completato l'esecuzione sulla GPU, l'elenco dei comandi successivi dalla coda verrà inviato dal driver.</span><span class="sxs-lookup"><span data-stu-id="20066-168">Only when one command list has completed execution on the GPU, will the next command list from the queue be submitted by the driver.</span></span>

<span data-ttu-id="20066-169">In Direct3D 11 non esiste alcun concetto esplicito di coda dei comandi.</span><span class="sxs-lookup"><span data-stu-id="20066-169">In Direct3D 11 there is no explicit concept of a command queue.</span></span> <span data-ttu-id="20066-170">Nel programma di installazione comune per Direct3D 12, l'elenco di comandi attualmente aperti **D3D12_COMMAND_LIST_TYPE_DIRECT** per il frame corrente può essere considerato analogo al contesto immediato di Direct3D 11.</span><span class="sxs-lookup"><span data-stu-id="20066-170">In the common setup for Direct3D 12, the currently open **D3D12_COMMAND_LIST_TYPE_DIRECT** command list for the current frame can be considered analogous to the Direct3D 11 immediate context.</span></span> <span data-ttu-id="20066-171">In questo modo vengono fornite molte delle stesse funzioni.</span><span class="sxs-lookup"><span data-stu-id="20066-171">This provides many of the same functions.</span></span>


| <span data-ttu-id="20066-172">Su D3D11DeviceContext</span><span class="sxs-lookup"><span data-stu-id="20066-172">D3D11DeviceContext</span></span>                  | <span data-ttu-id="20066-173">Elenco ID3D12GraphicsCommand</span><span class="sxs-lookup"><span data-stu-id="20066-173">ID3D12GraphicsCommand List</span></span>     |
|-------------------------------------|--------------------------------|
| <span data-ttu-id="20066-174">ClearDepthStencilView</span><span class="sxs-lookup"><span data-stu-id="20066-174">ClearDepthStencilView</span></span>               | <span data-ttu-id="20066-175">ClearDepthStencilView</span><span class="sxs-lookup"><span data-stu-id="20066-175">ClearDepthStencilView</span></span>          |
| <span data-ttu-id="20066-176">ClearRenderTargetView</span><span class="sxs-lookup"><span data-stu-id="20066-176">ClearRenderTargetView</span></span>               | <span data-ttu-id="20066-177">ClearRenderTargetView</span><span class="sxs-lookup"><span data-stu-id="20066-177">ClearRenderTargetView</span></span>          |
| <span data-ttu-id="20066-178">ClearUnorderedAccess\*</span><span class="sxs-lookup"><span data-stu-id="20066-178">ClearUnorderedAccess\*</span></span>               | <span data-ttu-id="20066-179">ClearUnorderedAccess\*</span><span class="sxs-lookup"><span data-stu-id="20066-179">ClearUnorderedAccess\*</span></span>          |
| <span data-ttu-id="20066-180">DrawInstanced</span><span class="sxs-lookup"><span data-stu-id="20066-180">Draw, DrawInstanced</span></span>                 | <span data-ttu-id="20066-181">DrawInstanced</span><span class="sxs-lookup"><span data-stu-id="20066-181">DrawInstanced</span></span>                  |
| <span data-ttu-id="20066-182">DrawIndexed, DrawIndexedInstanced</span><span class="sxs-lookup"><span data-stu-id="20066-182">DrawIndexed, DrawIndexedInstanced</span></span>   | <span data-ttu-id="20066-183">DrawIndexedInstanced</span><span class="sxs-lookup"><span data-stu-id="20066-183">DrawIndexedInstanced</span></span>           |
| <span data-ttu-id="20066-184">Dispatch</span><span class="sxs-lookup"><span data-stu-id="20066-184">Dispatch</span></span>                            | <span data-ttu-id="20066-185">Dispatch</span><span class="sxs-lookup"><span data-stu-id="20066-185">Dispatch</span></span>                       |
| <span data-ttu-id="20066-186">IASetInputLayout, xxSetShader e così via.</span><span class="sxs-lookup"><span data-stu-id="20066-186">IASetInputLayout, xxSetShader, etc.</span></span> | <span data-ttu-id="20066-187">SetPipelineState</span><span class="sxs-lookup"><span data-stu-id="20066-187">SetPipelineState</span></span>               |
| <span data-ttu-id="20066-188">OMSetBlendState</span><span class="sxs-lookup"><span data-stu-id="20066-188">OMSetBlendState</span></span>                     | <span data-ttu-id="20066-189">OMSetBlendFactor</span><span class="sxs-lookup"><span data-stu-id="20066-189">OMSetBlendFactor</span></span>               |
| <span data-ttu-id="20066-190">OMSetDepthStencilState</span><span class="sxs-lookup"><span data-stu-id="20066-190">OMSetDepthStencilState</span></span>              | <span data-ttu-id="20066-191">OMSetStencilRef</span><span class="sxs-lookup"><span data-stu-id="20066-191">OMSetStencilRef</span></span>                |
| <span data-ttu-id="20066-192">OMSetRenderTargets</span><span class="sxs-lookup"><span data-stu-id="20066-192">OMSetRenderTargets</span></span>                  | <span data-ttu-id="20066-193">OMSetRenderTargets</span><span class="sxs-lookup"><span data-stu-id="20066-193">OMSetRenderTargets</span></span>             |
| <span data-ttu-id="20066-194">RSSetViewports</span><span class="sxs-lookup"><span data-stu-id="20066-194">RSSetViewports</span></span>                      | <span data-ttu-id="20066-195">RSSetViewports</span><span class="sxs-lookup"><span data-stu-id="20066-195">RSSetViewports</span></span>                 |
| <span data-ttu-id="20066-196">RSSetScissorRects</span><span class="sxs-lookup"><span data-stu-id="20066-196">RSSetScissorRects</span></span>                   | <span data-ttu-id="20066-197">RSSetScissorRects</span><span class="sxs-lookup"><span data-stu-id="20066-197">RSSetScissorRects</span></span>              |
| <span data-ttu-id="20066-198">IASetPrimitiveTopology</span><span class="sxs-lookup"><span data-stu-id="20066-198">IASetPrimitiveTopology</span></span>              | <span data-ttu-id="20066-199">IASetPrimitiveTopology</span><span class="sxs-lookup"><span data-stu-id="20066-199">IASetPrimitiveTopology</span></span>         |
| <span data-ttu-id="20066-200">IASetVertexBuffers</span><span class="sxs-lookup"><span data-stu-id="20066-200">IASetVertexBuffers</span></span>                  | <span data-ttu-id="20066-201">IASetVertexBuffers</span><span class="sxs-lookup"><span data-stu-id="20066-201">IASetVertexBuffers</span></span>             |
| <span data-ttu-id="20066-202">IASetIndexBuffer</span><span class="sxs-lookup"><span data-stu-id="20066-202">IASetIndexBuffer</span></span>                    | <span data-ttu-id="20066-203">IASetIndexBuffer</span><span class="sxs-lookup"><span data-stu-id="20066-203">IASetIndexBuffer</span></span>               |
| <span data-ttu-id="20066-204">ResolveSubresource</span><span class="sxs-lookup"><span data-stu-id="20066-204">ResolveSubresource</span></span>                  | <span data-ttu-id="20066-205">ResolveSubresource</span><span class="sxs-lookup"><span data-stu-id="20066-205">ResolveSubresource</span></span>             |
| <span data-ttu-id="20066-206">CopySubresourceRegion</span><span class="sxs-lookup"><span data-stu-id="20066-206">CopySubresourceRegion</span></span>               | <span data-ttu-id="20066-207">CopyBufferRegion</span><span class="sxs-lookup"><span data-stu-id="20066-207">CopyBufferRegion</span></span>               |
| <span data-ttu-id="20066-208">UpdateSubresource</span><span class="sxs-lookup"><span data-stu-id="20066-208">UpdateSubresource</span></span>                   | <span data-ttu-id="20066-209">CopyTextureRegion</span><span class="sxs-lookup"><span data-stu-id="20066-209">CopyTextureRegion</span></span>              |
| <span data-ttu-id="20066-210">CopyResource</span><span class="sxs-lookup"><span data-stu-id="20066-210">CopyResource</span></span>                        | <span data-ttu-id="20066-211">CopyResource</span><span class="sxs-lookup"><span data-stu-id="20066-211">CopyResource</span></span>                   |

> [!NOTE]
> <span data-ttu-id="20066-212">Un elenco di comandi creato con **D3D12_COMMAND_LIST_TYPE_BUNDLE** viene simile a un contesto posticipato.</span><span class="sxs-lookup"><span data-stu-id="20066-212">A command list created with **D3D12_COMMAND_LIST_TYPE_BUNDLE** is simliar to a deferred context.</span></span> <span data-ttu-id="20066-213">Direct3D 12 supporta inoltre abiilty per accedere ad alcune funzionalità di un *contesto immediato* simultaneamente al rendering tramite **D3D12_COMMAND_LIST_TYPE_COPY** e **D3D12_COMMAND_LIST_TYPE_COMPUTE** tipi di elenco dei comandi.</span><span class="sxs-lookup"><span data-stu-id="20066-213">Direct3D 12 also supports the abiilty to access some features of an *immediate context* simultaneous to rendering via **D3D12_COMMAND_LIST_TYPE_COPY** and **D3D12_COMMAND_LIST_TYPE_COMPUTE** command list types.</span></span>

## <a name="cpugpu-synchronization"></a><span data-ttu-id="20066-214">Sincronizzazione CPU/GPU</span><span class="sxs-lookup"><span data-stu-id="20066-214">CPU/GPU Synchronization</span></span>

<span data-ttu-id="20066-215">In Direct3D 11 la sincronizzazione della CPU/GPU era in gran parte automatica e non era necessario che l'app mantenga lo stato della memoria fisica.</span><span class="sxs-lookup"><span data-stu-id="20066-215">In Direct3D 11 CPU/GPU synchronization was largely automatic, and there was no need for the app to maintain the status of physical memory.</span></span>

<span data-ttu-id="20066-216">in Direct3D 12 l'app deve gestire in modo esplicito le due sequenze temporali (CPU e GPU).</span><span class="sxs-lookup"><span data-stu-id="20066-216">in Direct3D 12 the app must manage the two timelines (CPU and GPU) explicitly.</span></span> <span data-ttu-id="20066-217">Questa operazione richiede che le informazioni debbano essere mantenute, dall'app, sulle risorse richieste dalla GPU e per quanto tempo.</span><span class="sxs-lookup"><span data-stu-id="20066-217">This requires that information needs to be maintained, by the app, on what resources are required by the GPU, and for how long.</span></span> <span data-ttu-id="20066-218">Questo significa anche che l'app è responsabile di garantire che il contenuto delle risorse (ad esempio, risorse sottoposte a commit, heap, allocatori di comandi) non cambi fino a quando la GPU non ne ha terminato l'uso.</span><span class="sxs-lookup"><span data-stu-id="20066-218">This also means that the app is responsible for ensuring the contents of resources (committed resources, heaps, command allocators, for example) do not change until the GPU has finished using them.</span></span>

<span data-ttu-id="20066-219">L'oggetto principale per la sincronizzazione delle sequenze temporali è l'oggetto [**ID3D12Fence**](/windows/win32/api/d3d12/nn-d3d12-id3d12fence) .</span><span class="sxs-lookup"><span data-stu-id="20066-219">The main object for synchronizing the timelines is the [**ID3D12Fence**](/windows/win32/api/d3d12/nn-d3d12-id3d12fence) object.</span></span> <span data-ttu-id="20066-220">L'operazione di recinzione è semplice, ma consente alla GPU di segnalare il completamento di un'attività.</span><span class="sxs-lookup"><span data-stu-id="20066-220">The operation of fences is failry simple, they enable the GPU to signal when it has completed a task.</span></span> <span data-ttu-id="20066-221">La GPU e la CPU possono entrambi segnalare ed è possibile attendere le recinzioni.</span><span class="sxs-lookup"><span data-stu-id="20066-221">The GPU and CPU can both signal, and can both wait on fences.</span></span>

<span data-ttu-id="20066-222">In genere, l'approccio consiste nel fatto che quando si invia un elenco di comandi per l'esecuzione, un segnale di recinzione viene trasmesso dalla GPU al completamento (al termine della lettura dei dati), consentendo alla CPU di riutilizzare o eliminare definitivamente le risorse.</span><span class="sxs-lookup"><span data-stu-id="20066-222">Typically the approach is that when submitting a command list for execution, a fence signal is transmitted by the GPU on completion (when it has finished reading the data), enabling the CPU to reuse or destroy the resources.</span></span>

<span data-ttu-id="20066-223">In Direct3D 11 il flag [**sul ID3D11DeviceContext:: Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map) d3d11 \_ mapping \_ Write \_ Ignora essenzialmente ogni risorsa come una quantità infinita di memoria in cui l'app può scrivere (un processo noto come "ridenominazione").</span><span class="sxs-lookup"><span data-stu-id="20066-223">In Direct3D 11 the [**ID3D11DeviceContext::Map**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-map) flag D3D11\_MAP\_WRITE\_DISCARD essentially treated each resource as an endless supply of memory the app could write to (a process known as "renaming").</span></span> <span data-ttu-id="20066-224">In Direct3D 12 di nuovo il processo è esplicito: è necessario allocare memoria aggiuntiva e usare i limiti per sincronizzare le operazioni.</span><span class="sxs-lookup"><span data-stu-id="20066-224">In Direct3D 12 again the process is explicit: additional memory needs to be allocated, and fences should be used to sync the operations.</span></span> <span data-ttu-id="20066-225">I buffer circolare (costituiti da buffer di grandi dimensioni) potrebbero essere una tecnica efficace, fare riferimento allo scenario di buffer circolare nella [gestione delle risorse basata su recinzioni](fence-based-resource-management.md).</span><span class="sxs-lookup"><span data-stu-id="20066-225">Ring buffers (consisting of large buffers) might be a good technique for this, refer to the ring buffer scenario in [Fence-Based Resource Management](fence-based-resource-management.md).</span></span>

![uso di un buffer circolare](images/ring-buffer-1.png)

## <a name="resource-binding"></a><span data-ttu-id="20066-227">Associazione di risorse</span><span class="sxs-lookup"><span data-stu-id="20066-227">Resource Binding</span></span>

<span data-ttu-id="20066-228">Le visualizzazioni in Direct3D 11 (viste delle risorse dello shader, visualizzazioni della destinazione di rendering e così via) sono state in gran parte sostituite in Direct3D 12 con il concetto di descrittore.</span><span class="sxs-lookup"><span data-stu-id="20066-228">Views in Direct3D 11 (shader resource views, render target views, and so on), have largely been replaced in Direct3D 12 with the concept of a descriptor.</span></span> <span data-ttu-id="20066-229">I metodi di creazione sono ancora presenti in Direct3D 12, ad esempio [**CreateShaderResourceView**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createshaderresourceview) e [**CreateRenderTargetView**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createrendertargetview), che vengono chiamati dopo la creazione dell'heap del descrittore per la scrittura dei dati nell'heap.</span><span class="sxs-lookup"><span data-stu-id="20066-229">The creation methods still exist in Direct3D 12 (such as [**CreateShaderResourceView**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createshaderresourceview) and [**CreateRenderTargetView**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createrendertargetview)), which are called after the descriptor heap has been created, to write the data into the heap.</span></span> <span data-ttu-id="20066-230">Il binding in Direct3D 12 è ora gestito dagli handle di descrittore descritti in una firma radice e inviato usando i metodi [**SetGraphicsRootDescriptorTable**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setgraphicsrootdescriptortable) o [**SetComputeRootDescriptorTable**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setcomputerootdescriptortable) .</span><span class="sxs-lookup"><span data-stu-id="20066-230">Binding in Direct3D 12 is now handled by descriptor handles described in a root signature, and submitted using the [**SetGraphicsRootDescriptorTable**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setgraphicsrootdescriptortable) or [**SetComputeRootDescriptorTable**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setcomputerootdescriptortable) methods.</span></span>

<span data-ttu-id="20066-231">Firme radice Dettagli mapping tra il numero di slot della firma radice e le tabelle descrittore, in cui la tabella descrittore può contenere riferimenti a risorse disponibili per i vertex shader, pixel shader e gli altri shader, ad esempio buffer costanti, visualizzazioni di risorse shader e Samplers.</span><span class="sxs-lookup"><span data-stu-id="20066-231">Root signatures details mappings between the root signature slot number and descriptor tables, where the descriptor table can contain references to resources available to vertex shaders, pixel shaders, and the other shaders, such as constant buffers, shader resource views and samplers.</span></span> <span data-ttu-id="20066-232">Questa flessibilità disconnette lo spazio del registro HLSL dallo spazio di associazione API in Direct3D 12, a differenza di Direct3D 11 in cui è presente un mapping uno-a-uno tra questi.</span><span class="sxs-lookup"><span data-stu-id="20066-232">This flexibility disconnects the HLSL register space from the API binding space in Direct3D 12, unlike Direct3D 11 where there is a one to one mapping between these.</span></span>

<span data-ttu-id="20066-233">Una delle implicazioni di questo sistema è che l'app è responsabile della ridenominazione delle tabelle dei descrittori, che consente agli sviluppatori di comprendere il costo delle prestazioni della modifica anche di un singolo descrittore per ogni chiamata di progetto.</span><span class="sxs-lookup"><span data-stu-id="20066-233">One of the implications of this system is that the app is responsible for renaming descriptor tables, which enables developers to understand the performance cost of changing even a single descriptor per draw call.</span></span>

<span data-ttu-id="20066-234">Una nuova funzionalità di Direct3D 12 è che un'app può controllare quali descrittori sono condivisi tra le fasi dello shader.</span><span class="sxs-lookup"><span data-stu-id="20066-234">A new feature of Direct3D 12 is that an app can control which descriptors are shared between which shader stages.</span></span> <span data-ttu-id="20066-235">Nelle risorse Direct3D 11, ad esempio UAV, vengono condivise tra tutte le fasi dello shader.</span><span class="sxs-lookup"><span data-stu-id="20066-235">In Direct3D 11 resources such as UAVs are shared between all shader stages.</span></span> <span data-ttu-id="20066-236">Consentendo la disabilitazione dei descrittori per determinate fasi dello shader, i registri utilizzati dai descrittori che sono stati disabilitati sono disponibili per essere utilizzati dai descrittori che sono abilitati per una fase particolare dello shader.</span><span class="sxs-lookup"><span data-stu-id="20066-236">By enabling descriptors to be disabled for certain shader stages, the registers used by descriptors that have been disabled are available to be used by descriptors which are enabled for a particular shader stage.</span></span>

<span data-ttu-id="20066-237">Nella tabella seguente viene illustrata una firma radice di esempio.</span><span class="sxs-lookup"><span data-stu-id="20066-237">The following table shows an example root signature.</span></span>



| <span data-ttu-id="20066-238">Slot parametri radice</span><span class="sxs-lookup"><span data-stu-id="20066-238">Root Parameter Slot</span></span> | <span data-ttu-id="20066-239">Voce della tabella descrittore</span><span class="sxs-lookup"><span data-stu-id="20066-239">Descriptor Table Entry</span></span>         |
|---------------------|--------------------------------|
| <span data-ttu-id="20066-240">0</span><span class="sxs-lookup"><span data-stu-id="20066-240">0</span></span>                   | <span data-ttu-id="20066-241">Intervallo descrittore VS B0-B13</span><span class="sxs-lookup"><span data-stu-id="20066-241">VS Descriptor Range b0-b13</span></span>     |
| <span data-ttu-id="20066-242">1</span><span class="sxs-lookup"><span data-stu-id="20066-242">1</span></span>                   | <span data-ttu-id="20066-243">Intervallo descrittore VS T0-T127</span><span class="sxs-lookup"><span data-stu-id="20066-243">VS Descriptor Range t0-t127</span></span>    |
| <span data-ttu-id="20066-244">2</span><span class="sxs-lookup"><span data-stu-id="20066-244">2</span></span>                   | <span data-ttu-id="20066-245">Intervallo descrittore VS S0-S16</span><span class="sxs-lookup"><span data-stu-id="20066-245">VS Descriptor Range s0-s16</span></span>     |
| <span data-ttu-id="20066-246">3</span><span class="sxs-lookup"><span data-stu-id="20066-246">3</span></span>                   | <span data-ttu-id="20066-247">Intervallo descrittore PS B0-B13</span><span class="sxs-lookup"><span data-stu-id="20066-247">PS Descriptor Range b0-b13</span></span>     |
| <span data-ttu-id="20066-248">...</span><span class="sxs-lookup"><span data-stu-id="20066-248">...</span></span>                 |                                |
| <span data-ttu-id="20066-249">14</span><span class="sxs-lookup"><span data-stu-id="20066-249">14</span></span>                  | <span data-ttu-id="20066-250">Intervallo descrittori DS S0-16</span><span class="sxs-lookup"><span data-stu-id="20066-250">DS Descriptor Range s0-16</span></span>      |
| <span data-ttu-id="20066-251">15</span><span class="sxs-lookup"><span data-stu-id="20066-251">15</span></span>                  | <span data-ttu-id="20066-252">Intervallo descrittore condiviso U0-U63</span><span class="sxs-lookup"><span data-stu-id="20066-252">Shared Descriptor Range u0-u63</span></span> |



 

## <a name="resource-state"></a><span data-ttu-id="20066-253">Stato della risorsa</span><span class="sxs-lookup"><span data-stu-id="20066-253">Resource state</span></span>

<span data-ttu-id="20066-254">Lo stato della risorsa Direct3D 11 non viene gestito dall'app, ma dal driver.</span><span class="sxs-lookup"><span data-stu-id="20066-254">In Direct3D 11 resource state is not maintained by the app, but by the driver.</span></span>

<span data-ttu-id="20066-255">In Direct3D 12 la manutenzione dello stato delle risorse diventa la responsabilità dell'app, per abilitare il parallelismo completo nella registrazione degli elenchi di comandi: l'app deve gestire le sequenze temporali di registrazione per gli elenchi di comandi (che possono essere eseguiti in parallelo) e le sequenze temporali di esecuzione che devono essere sequenziali.</span><span class="sxs-lookup"><span data-stu-id="20066-255">In Direct3D 12 maintaining resource state becomes the responsibility of the app, to enable full parallelism in the recording of command lists: the app must handle the recording timelines for command lists (which can be done in parallel), and the execution timelines which must be sequential.</span></span>

<span data-ttu-id="20066-256">Una transizione di stato della risorsa viene gestita dal metodo [**ResourceBarrier**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-resourcebarrier) .</span><span class="sxs-lookup"><span data-stu-id="20066-256">A resource state transition is handled by the [**ResourceBarrier**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-resourcebarrier) method.</span></span> <span data-ttu-id="20066-257">Principalmente l'app deve informare il driver quando l'utilizzo delle risorse è in corso di modifica.</span><span class="sxs-lookup"><span data-stu-id="20066-257">Primarily the app must inform the driver when resource usage is changing.</span></span> <span data-ttu-id="20066-258">Se, ad esempio, una risorsa viene usata come destinazione di rendering e quindi deve essere usata come input per un vertex shader alla successiva chiamata di disegnare, potrebbe essere necessario un breve blocco nell'operazione GPU per completare l'operazione di rendering della destinazione prima di gestire il vertex shader.</span><span class="sxs-lookup"><span data-stu-id="20066-258">For example if a resource is being used as a render target, and then it is to be used as input to a vertex shader on the next draw call, then this might require a short stall in GPU operation to complete the render target operation before handling the vertex shader.</span></span>

<span data-ttu-id="20066-259">Questo sistema consente la sincronizzazione con granularità fine (stalli GPU) della pipeline grafica, nonché gli scaricamenti della cache e possibilmente alcune modifiche al layout della memoria, ad esempio la visualizzazione della destinazione di rendering per depth stencil la decompressione della visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="20066-259">This system enables fine grain synchronization (the GPU stalls) of the graphics pipeline, as well as cache flushes and possibly some memory layout changes (such as render target view to depth stencil view decompression).</span></span>

<span data-ttu-id="20066-260">Questa operazione è nota come barriera di transizione.</span><span class="sxs-lookup"><span data-stu-id="20066-260">This is known as a transition barrier.</span></span> <span data-ttu-id="20066-261">In Direct3D 11 sono disponibili altri tipi di barriere [**: ID3D11DeviceContext2:: TiledResourceBarrier**](/windows/win32/api/d3d11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier) ha abilitato la stessa memoria fisica per l'uso da parte di due risorse affiancate diverse.</span><span class="sxs-lookup"><span data-stu-id="20066-261">There are other kinds of barriers, in Direct3D 11 the [**ID3D11DeviceContext2::TiledResourceBarrier**](/windows/win32/api/d3d11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier) enabled the same physical memory to be used by two different tiled resources.</span></span> <span data-ttu-id="20066-262">In Direct3D 12 questa operazione viene definita "barriera di aliasing".</span><span class="sxs-lookup"><span data-stu-id="20066-262">In Direct3D 12 this is referred to as an "aliasing barrier".</span></span> <span data-ttu-id="20066-263">È possibile usare le barriere alias per le risorse affiancate e posizionate in Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="20066-263">Aliasing barriers can be used for both tiled and placed resources in Direct3D 12.</span></span> <span data-ttu-id="20066-264">Inoltre, è presente la barriera UAV.</span><span class="sxs-lookup"><span data-stu-id="20066-264">Additionally there is the UAV barrier.</span></span> <span data-ttu-id="20066-265">In Direct3D 11 tutte le operazioni di invio e di richiamo di UAV devono essere serializzate, anche se è possibile eseguire la pipeline o lavorare in parallelo.</span><span class="sxs-lookup"><span data-stu-id="20066-265">In Direct3D 11 all UAV dispatch and draw operations are required to be serialized, even though these operations can be pipelined or work in parallel.</span></span> <span data-ttu-id="20066-266">Per Direct3D 12 questa restrizione viene rimossa dall'aggiunta di una barriera UAV.</span><span class="sxs-lookup"><span data-stu-id="20066-266">For Direct3D 12 this restriction is removed by the addition of a UAV barrier.</span></span> <span data-ttu-id="20066-267">Una barriera UAV garantisce che le operazioni UAV siano sequenziali, quindi, se una seconda operazione richiede che il primo completamento, il secondo verrà forzato ad attendere l'aggiunta della barriera.</span><span class="sxs-lookup"><span data-stu-id="20066-267">A UAV barrier ensures that UAV operations are sequential, so if a second operation requires that the first complete, the second will be forced to wait by the addition of the barrier.</span></span> <span data-ttu-id="20066-268">L'operazione predefinita per UAV è semplicemente che le operazioni procedono il più rapidamente possibile.</span><span class="sxs-lookup"><span data-stu-id="20066-268">The default operation for UAVs is simply that the operations will proceed as quickly as possible.</span></span>

<span data-ttu-id="20066-269">Se un carico di lavoro può essere parallelo, è evidente un miglioramento delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="20066-269">Clearly there are performance gains if a workload can be parallelized.</span></span>

## <a name="swapchains"></a><span data-ttu-id="20066-270">Le catene</span><span class="sxs-lookup"><span data-stu-id="20066-270">Swapchains</span></span>

<span data-ttu-id="20066-271">La catena di scambio DXGI è la base per le catene di scambio in Direct3D 11 e 12.</span><span class="sxs-lookup"><span data-stu-id="20066-271">The DXGI swap chain is the basis for swap chains in both Direct3D 11 and 12.</span></span> <span data-ttu-id="20066-272">Vi sono alcune piccole differenze, in Direct3D 11 i tre tipi di catena di scambio sono SEQUENZIAli, SCARTAti e FLIP \_ sequenziali.</span><span class="sxs-lookup"><span data-stu-id="20066-272">There are some minor differences, in Direct3D 11 the three types of swap chain are SEQUENTIAL, DISCARD, and FLIP\_SEQUENTIAL.</span></span> <span data-ttu-id="20066-273">Per Direct3D 12 sono disponibili solo due tipi: CAPOVOLGi \_ sequenziali e Capovolgi \_ Ignora.</span><span class="sxs-lookup"><span data-stu-id="20066-273">For Direct3D 12 there are just two types: FLIP\_SEQUENTIAL and FLIP\_DISCARD.</span></span> <span data-ttu-id="20066-274">Come indicato in precedenza, è necessario creare in modo esplicito il presentazione catena tramite **IDXGIFactory4** o versione successiva e usando la stessa interfaccia per qualsiasi enumerazione di adapter.</span><span class="sxs-lookup"><span data-stu-id="20066-274">As noted above, you should be explicitly creating your swapchain via **IDXGIFactory4**, or later, and using the same interface for any adapter enumeration.</span></span>

<span data-ttu-id="20066-275">In Direct3D 11 è presente la rotazione automatica del buffer: è necessaria una sola visualizzazione della destinazione di rendering per il buffer nascosto 0.</span><span class="sxs-lookup"><span data-stu-id="20066-275">In Direct3D 11 there is automatic backbuffer rotation: only one render target view is needed for back buffer 0.</span></span> <span data-ttu-id="20066-276">In Direct3D 12 la rotazione del buffer è esplicita, deve essere presente una visualizzazione della destinazione di rendering per ogni buffer nascosto.</span><span class="sxs-lookup"><span data-stu-id="20066-276">In Direct3D 12 buffer rotation is explicit, there needs to be a render target view for each back buffer.</span></span> <span data-ttu-id="20066-277">Usare il metodo [**IDXGISwapChain3:: GetCurrentBackBufferIndex**](/windows/win32/api/dxgi1_4/nf-dxgi1_4-idxgiswapchain3-getcurrentbackbufferindex) per selezionare quello in cui eseguire il rendering.</span><span class="sxs-lookup"><span data-stu-id="20066-277">Use the [**IDXGISwapChain3::GetCurrentBackBufferIndex**](/windows/win32/api/dxgi1_4/nf-dxgi1_4-idxgiswapchain3-getcurrentbackbufferindex) method to select which one to render to.</span></span> <span data-ttu-id="20066-278">Questa ulteriore flessibilità consente inoltre una maggiore parallelizzazione.</span><span class="sxs-lookup"><span data-stu-id="20066-278">Again this additional flexibility enables greater parallelization.</span></span>

> [!NOTE]
> <span data-ttu-id="20066-279">Sebbene esistano molti modi per configurare l'applicazione, in genere le applicazioni hanno un **ID3D12CommandAllocator** per ogni buffer a catena di scambio.</span><span class="sxs-lookup"><span data-stu-id="20066-279">While there are numerous ways to set up your application, generally applications have one **ID3D12CommandAllocator** per swap-chain buffer.</span></span> <span data-ttu-id="20066-280">Ciò consente all'applicazione di procedere alla creazione di un set di comandi per il frame successivo mentre la GPU esegue il rendering dell'oggetto precedente.</span><span class="sxs-lookup"><span data-stu-id="20066-280">This allows the application to proceed to building up a set of commands for the next frame while the GPU renders the previous.</span></span>

## <a name="fixed-function-rendering"></a><span data-ttu-id="20066-281">Correzione del rendering della funzione</span><span class="sxs-lookup"><span data-stu-id="20066-281">Fixed function rendering</span></span>

<span data-ttu-id="20066-282">In Direct3D 11 sono disponibili alcuni metodi che semplificano varie operazioni di livello superiore, ad esempio [**GenerateMips**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-generatemips) (creazione di catene MIP complete) e [**DrawAuto**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-drawauto) (usando l'output del flusso come input dello shader senza ulteriore input dall'app).</span><span class="sxs-lookup"><span data-stu-id="20066-282">In Direct3D 11 there were a few methods that simplified various higher level operations, such as [**GenerateMips**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-generatemips) (creating full mip chains) and [**DrawAuto**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-drawauto) (using stream output as shader input without further input from the app).</span></span> <span data-ttu-id="20066-283">Questi metodi non sono disponibili in Direct3D 12, l'app deve gestire queste operazioni creando shader per eseguirle.</span><span class="sxs-lookup"><span data-stu-id="20066-283">These methods are not available in Direct3D 12, the app needs to handle these operations by creating shaders to perform them.</span></span>

## <a name="odds-and-ends"></a><span data-ttu-id="20066-284">Probabilità e fine</span><span class="sxs-lookup"><span data-stu-id="20066-284">Odds and ends</span></span>

<span data-ttu-id="20066-285">La tabella seguente illustra una serie di funzionalità simili tra Direct3D 11 e 12, ma non sono identiche.</span><span class="sxs-lookup"><span data-stu-id="20066-285">The following table shows a number of features that are similar between Direct3D 11 and 12, but are not identical.</span></span>



| <span data-ttu-id="20066-286">Direct3D 11</span><span class="sxs-lookup"><span data-stu-id="20066-286">Direct3D 11</span></span>                                                                            | <span data-ttu-id="20066-287">Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="20066-287">Direct3D 12</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                              |
|----------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="20066-288">**ID3D11Query**</span><span class="sxs-lookup"><span data-stu-id="20066-288">**ID3D11Query**</span></span>](/windows/win32/api/d3d11/nn-d3d11-id3d11query)                                              | <span data-ttu-id="20066-289">[**ID3D12QueryHeap**](/windows/win32/api/d3d12/nn-d3d12-id3d12queryheap) consente di raggruppare le query, riducendo i costi.</span><span class="sxs-lookup"><span data-stu-id="20066-289">[**ID3D12QueryHeap**](/windows/win32/api/d3d12/nn-d3d12-id3d12queryheap) allows queries to be grouped together, reducing the cost.</span></span>                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="20066-290">**ID3D11Predicate**</span><span class="sxs-lookup"><span data-stu-id="20066-290">**ID3D11Predicate**</span></span>](/windows/win32/api/d3d11/nn-d3d11-id3d11predicate)                                      | <span data-ttu-id="20066-291">Predicazione è ora abilitato con dati in un buffer completamente trasparente.</span><span class="sxs-lookup"><span data-stu-id="20066-291">Predication is now enabled by having data in a fully transparent buffer.</span></span> <span data-ttu-id="20066-292">L'oggetto [**ID3D11Predicate**](/windows/win32/api/d3d11/nn-d3d11-id3d11predicate) Direct3D 11 viene sostituito da [**ID3D12Resource:: Map**](/windows/win32/api/d3d12/nf-d3d12-id3d12resource-map), che deve seguire una chiamata a [**ResolveQueryData**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-resolvequerydata) e un'operazione di sincronizzazione GPU usando un limite per attendere che i dati siano pronti.</span><span class="sxs-lookup"><span data-stu-id="20066-292">The Direct3D 11 [**ID3D11Predicate**](/windows/win32/api/d3d11/nn-d3d11-id3d11predicate) object is replaced by [**ID3D12Resource::Map**](/windows/win32/api/d3d12/nf-d3d12-id3d12resource-map), which must follow a call to [**ResolveQueryData**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-resolvequerydata) and a GPU sync operation using a fence to wait for the data to be ready.</span></span> <span data-ttu-id="20066-293">Vedere [predicazione](predication.md).</span><span class="sxs-lookup"><span data-stu-id="20066-293">Refer to [Predication](predication.md).</span></span> |
| <span data-ttu-id="20066-294">Contatore UAV/così nascosto</span><span class="sxs-lookup"><span data-stu-id="20066-294">UAV/SO hidden counter</span></span>                                                                  | <span data-ttu-id="20066-295">L'app è responsabile dell'allocazione e della gestione dei contatori di così/UAV.</span><span class="sxs-lookup"><span data-stu-id="20066-295">The app is responsible for allocation and management of SO/UAV counters.</span></span> <span data-ttu-id="20066-296">Vedere [contatori di output di flusso](stream-output-counters.md) e [contatori UAV](uav-counters.md).</span><span class="sxs-lookup"><span data-stu-id="20066-296">Refer to [Stream Output Counters](stream-output-counters.md) and [UAV Counters](uav-counters.md).</span></span>                                                                                                                                                                                                                                                             |
| <span data-ttu-id="20066-297">MinLOD dinamico risorse (livello minimo di dettaglio)</span><span class="sxs-lookup"><span data-stu-id="20066-297">Resource dynamic MinLOD (minium level of detail)</span></span>                                       | <span data-ttu-id="20066-298">Questa operazione è stata spostata nel MinLOD statico del descrittore SRV.</span><span class="sxs-lookup"><span data-stu-id="20066-298">This has been moved to the SRV descriptor static MinLOD.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="20066-299">Disegnato \* indirect/[**DispatchIndirect**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-dispatchindirect)</span><span class="sxs-lookup"><span data-stu-id="20066-299">Draw\*Indirect/[**DispatchIndirect**](/windows/win32/api/d3d11/nf-d3d11-id3d11devicecontext-dispatchindirect)</span></span> | <span data-ttu-id="20066-300">Il disegno di metodi indiretti viene unito in un unico metodo [**ExecuteIndirect**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-executeindirect) .</span><span class="sxs-lookup"><span data-stu-id="20066-300">Drawing indirect methods are all merged into the one [**ExecuteIndirect**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-executeindirect) method.</span></span>                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="20066-301">I formati DepthStencil sono con interfoliazione</span><span class="sxs-lookup"><span data-stu-id="20066-301">DepthStencil formats are interleaved</span></span>                                                   | <span data-ttu-id="20066-302">I formati DepthStencil sono planari.</span><span class="sxs-lookup"><span data-stu-id="20066-302">DepthStencil formats are planar.</span></span> <span data-ttu-id="20066-303">Ad esempio, un formato di 24 bit di profondità, 8 bit di stencil verranno archiviati nel formato 24/8/24/8... e così via in Direct3D 11, ma come 24/24/24... seguito da 8/8/8... in Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="20066-303">For example a format of 24 bits of depth, 8 bits of stencil would be stored in the format 24/8/24/8... etc in Direct3D 11, but as 24/24/24... followed by 8/8/8... in Direct3D 12.</span></span> <span data-ttu-id="20066-304">Si noti che ogni piano è la propria sottorisorsa in D3D12 (vedere [le sottorisorse](subresources.md)).</span><span class="sxs-lookup"><span data-stu-id="20066-304">Note that each plane is its own subresource in D3D12 (refer to [Subresources](subresources.md)).</span></span>                                                                                                                    |
| [<span data-ttu-id="20066-305">**ResizeTilePool**</span><span class="sxs-lookup"><span data-stu-id="20066-305">**ResizeTilePool**</span></span>](/windows/win32/api/d3d11_2/nf-d3d11_2-id3d11devicecontext2-resizetilepool)                   | <span data-ttu-id="20066-306">È possibile eseguire il mapping delle risorse riservate a più heap.</span><span class="sxs-lookup"><span data-stu-id="20066-306">Reserved resources can be mapped to multiple heaps.</span></span> <span data-ttu-id="20066-307">Quando un pool di sezioni è stato ampliato in D3D11, è possibile allocare un heap aggiuntivo in D3D12.</span><span class="sxs-lookup"><span data-stu-id="20066-307">When a tile pool would have been grown in D3D11, an additional heap can be allocated in D3D12 instead.</span></span>                                                                                                                                                                                                                                                                               |



 

## <a name="related-topics"></a><span data-ttu-id="20066-308">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="20066-308">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="20066-309">Esercitazioni video su DirectX Advanced Learning: Guida al porting di DirectX 11 a DirectX 12</span><span class="sxs-lookup"><span data-stu-id="20066-309">DirectX advanced learning video tutorials : DirectX 11 to DirectX 12 porting guide</span></span>](https://www.youtube.com/watch?v=BV64mdOCgZo)
</dt> <dt>

[<span data-ttu-id="20066-310">Informazioni su Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="20066-310">Understanding Direct3D 12</span></span>](directx-12-getting-started.md)
</dt> <dt>

[<span data-ttu-id="20066-311">Uso di Direct3D 11, Direct3D 10 e Direct2D</span><span class="sxs-lookup"><span data-stu-id="20066-311">Working with Direct3D 11, Direct3D 10 and Direct2D</span></span>](direct3d-12-interop.md)
</dt> </dl>