---
title: Uso di stride per esprimere il layout di riempimento e memoria
description: I tensori DirectML sono descritti dalle proprietà note come *dimensioni* e dagli *stride* del tensore.
ms.custom: Windows 10 May 2019 Update
ms.localizationpriority: high
ms.topic: article
ms.date: 04/19/2019
ms.openlocfilehash: b944b1a2600febe27f209bffcc0e355c6a9fc7db
ms.sourcegitcommit: cba7f424a292fd7f3a8518947b9466439b455419
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/23/2019
ms.locfileid: "104548824"
---
# <a name="using-strides-to-express-padding-and-memory-layout"></a><span data-ttu-id="afbeb-103">Uso di stride per esprimere il layout di riempimento e memoria</span><span class="sxs-lookup"><span data-stu-id="afbeb-103">Using strides to express padding and memory layout</span></span>

<span data-ttu-id="afbeb-104">I tensori DirectML &mdash; che sono supportati dai buffer Direct3D 12 &mdash; sono descritti dalle proprietà note come *dimensioni* e dagli *stride* del tensore.</span><span class="sxs-lookup"><span data-stu-id="afbeb-104">DirectML tensors&mdash;which are are backed by Direct3D 12 buffers&mdash;are described by properties known as the *sizes* and the *strides* of the tensor.</span></span> <span data-ttu-id="afbeb-105">Le *dimensioni* del tensore descrivono le dimensioni logiche del tensore.</span><span class="sxs-lookup"><span data-stu-id="afbeb-105">The tensor's *sizes* describe the logical dimensions of the tensor.</span></span> <span data-ttu-id="afbeb-106">Ad esempio, un tensore 2D potrebbe avere un'altezza di 2 e una larghezza pari a 3.</span><span class="sxs-lookup"><span data-stu-id="afbeb-106">For example, a 2D tensor might have a height of 2 and a width of 3.</span></span> <span data-ttu-id="afbeb-107">Logicamente, il tensore presenta 6 elementi distinti, sebbene le dimensioni non specifichino il modo in cui tali elementi vengono archiviati in memoria.</span><span class="sxs-lookup"><span data-stu-id="afbeb-107">Logically, the tensor has 6 distinct elements, although the sizes don't specify how those elements are stored in memory.</span></span> <span data-ttu-id="afbeb-108">Gli *stride* del tensore descrivono il layout della memoria fisica degli elementi del tensore.</span><span class="sxs-lookup"><span data-stu-id="afbeb-108">The tensor's *strides* describe the physical memory layout of the tensor's elements.</span></span>

## <a name="two-dimensional-2d-arrays"></a><span data-ttu-id="afbeb-109">Matrici bidimensionali (2D)</span><span class="sxs-lookup"><span data-stu-id="afbeb-109">Two-dimensional (2D) arrays</span></span>

<span data-ttu-id="afbeb-110">Si consideri un tensore 2D con altezza 2 e larghezza 3. i dati sono costituiti da caratteri testuali.</span><span class="sxs-lookup"><span data-stu-id="afbeb-110">Consider a 2D tensor that has a height of 2 and a width of 3; the data comprises textual characters.</span></span> <span data-ttu-id="afbeb-111">In C/C++, questo può essere espresso usando una matrice multidimensionale.</span><span class="sxs-lookup"><span data-stu-id="afbeb-111">In C/C++, this might be expressed using a multi-dimensional array.</span></span>

```cpp
constexpr int rows = 2;
constexpr int columns = 3;
char tensor[rows][columns];
tensor[0][0] = 'A';
tensor[0][1] = 'B';
tensor[0][2] = 'C';
tensor[1][0] = 'D';
tensor[1][1] = 'E';
tensor[1][2] = 'F';
```

<span data-ttu-id="afbeb-112">La visualizzazione logica del tensore precedente viene visualizzata sotto.</span><span class="sxs-lookup"><span data-stu-id="afbeb-112">The logical view of the above tensor is visualized below.</span></span>

```console
A B C
D E F
```

<span data-ttu-id="afbeb-113">In C/C++, una matrice multidimensionale viene archiviata in ordine riga-principale.</span><span class="sxs-lookup"><span data-stu-id="afbeb-113">In C/C++, a multi-dimensional array is stored in row-major order.</span></span> <span data-ttu-id="afbeb-114">In altre parole, gli elementi consecutivi lungo la dimensione Width vengono archiviati in modo contiguo nello spazio di memoria lineare.</span><span class="sxs-lookup"><span data-stu-id="afbeb-114">In other words, the consecutive elements along the width dimension are stored contiguously in linear memory space.</span></span>

<span data-ttu-id="afbeb-115">Offset:</span><span class="sxs-lookup"><span data-stu-id="afbeb-115">Offset:</span></span>|<span data-ttu-id="afbeb-116">0</span><span class="sxs-lookup"><span data-stu-id="afbeb-116">0</span></span>|<span data-ttu-id="afbeb-117">1</span><span class="sxs-lookup"><span data-stu-id="afbeb-117">1</span></span>|<span data-ttu-id="afbeb-118">2</span><span class="sxs-lookup"><span data-stu-id="afbeb-118">2</span></span>|<span data-ttu-id="afbeb-119">3</span><span class="sxs-lookup"><span data-stu-id="afbeb-119">3</span></span>|<span data-ttu-id="afbeb-120">4</span><span class="sxs-lookup"><span data-stu-id="afbeb-120">4</span></span>|<span data-ttu-id="afbeb-121">5</span><span class="sxs-lookup"><span data-stu-id="afbeb-121">5</span></span>
-|-|-|-|-|-|-
<span data-ttu-id="afbeb-122">Valore:</span><span class="sxs-lookup"><span data-stu-id="afbeb-122">Value:</span></span>|<span data-ttu-id="afbeb-123">A</span><span class="sxs-lookup"><span data-stu-id="afbeb-123">A</span></span>|<span data-ttu-id="afbeb-124">B</span><span class="sxs-lookup"><span data-stu-id="afbeb-124">B</span></span>|<span data-ttu-id="afbeb-125">C</span><span class="sxs-lookup"><span data-stu-id="afbeb-125">C</span></span>|<span data-ttu-id="afbeb-126">D</span><span class="sxs-lookup"><span data-stu-id="afbeb-126">D</span></span>|<span data-ttu-id="afbeb-127">E</span><span class="sxs-lookup"><span data-stu-id="afbeb-127">E</span></span>|<span data-ttu-id="afbeb-128">F</span><span class="sxs-lookup"><span data-stu-id="afbeb-128">F</span></span>

<span data-ttu-id="afbeb-129">Lo *stride* di una dimensione è il numero di elementi da ignorare per poter accedere all'elemento successivo della dimensione.</span><span class="sxs-lookup"><span data-stu-id="afbeb-129">The *stride* of a dimension is the number of elements to skip in order to access the next element in that dimension.</span></span> <span data-ttu-id="afbeb-130">Gli stride esprimono il layout del tensore nella memoria.</span><span class="sxs-lookup"><span data-stu-id="afbeb-130">Strides express the layout of the tensor in memory.</span></span> <span data-ttu-id="afbeb-131">Con un ordine di riga, lo stride della dimensione Width è sempre 1, poiché gli elementi adiacenti lungo la dimensione vengono archiviati in modo contiguo.</span><span class="sxs-lookup"><span data-stu-id="afbeb-131">With a row-major order, the stride of the width dimension is always 1, since adjacent elements along the dimension are stored contiguously.</span></span> <span data-ttu-id="afbeb-132">Lo stride della dimensione Height dipende dalle dimensioni della dimensione Width; Nell'esempio precedente, la distanza tra gli elementi consecutivi lungo la dimensione Height (ad esempio, a a D) è uguale alla larghezza del tensore (ovvero 3 in questo esempio).</span><span class="sxs-lookup"><span data-stu-id="afbeb-132">The stride of the height dimension depends on the size of the width dimension; in the above example, the distance between consecutive elements along the height dimension (for example, A to D) is equal to the width of the tensor (which is 3 in this example).</span></span>

<span data-ttu-id="afbeb-133">Per illustrare un layout diverso, prendere in considerazione l'ordine delle colonne.</span><span class="sxs-lookup"><span data-stu-id="afbeb-133">To illustrate a different layout, consider column-major order.</span></span> <span data-ttu-id="afbeb-134">In altre parole, gli elementi consecutivi lungo la dimensione Height vengono archiviati in modo contiguo nello spazio di memoria lineare.</span><span class="sxs-lookup"><span data-stu-id="afbeb-134">In other words, the consecutive elements along the height dimension are stored contiguously in linear memory space.</span></span> <span data-ttu-id="afbeb-135">In questo caso, il stride di altezza è sempre 1 e lo stride della larghezza è 2 (dimensione della dimensione dell'altezza).</span><span class="sxs-lookup"><span data-stu-id="afbeb-135">In this case, the height-stride is always 1, and the width-stride is 2 (the size of the height dimension).</span></span>

<span data-ttu-id="afbeb-136">Offset:</span><span class="sxs-lookup"><span data-stu-id="afbeb-136">Offset:</span></span>|<span data-ttu-id="afbeb-137">0</span><span class="sxs-lookup"><span data-stu-id="afbeb-137">0</span></span>|<span data-ttu-id="afbeb-138">1</span><span class="sxs-lookup"><span data-stu-id="afbeb-138">1</span></span>|<span data-ttu-id="afbeb-139">2</span><span class="sxs-lookup"><span data-stu-id="afbeb-139">2</span></span>|<span data-ttu-id="afbeb-140">3</span><span class="sxs-lookup"><span data-stu-id="afbeb-140">3</span></span>|<span data-ttu-id="afbeb-141">4</span><span class="sxs-lookup"><span data-stu-id="afbeb-141">4</span></span>|<span data-ttu-id="afbeb-142">5</span><span class="sxs-lookup"><span data-stu-id="afbeb-142">5</span></span>
-|-|-|-|-|-|-
<span data-ttu-id="afbeb-143">Valore:</span><span class="sxs-lookup"><span data-stu-id="afbeb-143">Value:</span></span>|<span data-ttu-id="afbeb-144">A</span><span class="sxs-lookup"><span data-stu-id="afbeb-144">A</span></span>|<span data-ttu-id="afbeb-145">D</span><span class="sxs-lookup"><span data-stu-id="afbeb-145">D</span></span>|<span data-ttu-id="afbeb-146">B</span><span class="sxs-lookup"><span data-stu-id="afbeb-146">B</span></span>|<span data-ttu-id="afbeb-147">E</span><span class="sxs-lookup"><span data-stu-id="afbeb-147">E</span></span>|<span data-ttu-id="afbeb-148">C</span><span class="sxs-lookup"><span data-stu-id="afbeb-148">C</span></span>|<span data-ttu-id="afbeb-149">F</span><span class="sxs-lookup"><span data-stu-id="afbeb-149">F</span></span>

## <a name="higher-dimensions"></a><span data-ttu-id="afbeb-150">Dimensioni superiori</span><span class="sxs-lookup"><span data-stu-id="afbeb-150">Higher dimensions</span></span>

<span data-ttu-id="afbeb-151">Quando si tratta di un valore maggiore di due dimensioni, è difficile fare riferimento a un layout come riga-principale o colonna-principale.</span><span class="sxs-lookup"><span data-stu-id="afbeb-151">When it comes to greater than two dimensions, it's unwieldy to refer to a layout as either row-major or column-major.</span></span> <span data-ttu-id="afbeb-152">Quindi, nella parte restante di questo argomento vengono usati termini ed etichette, ad esempio.</span><span class="sxs-lookup"><span data-stu-id="afbeb-152">So, the rest of this topic uses terms and labels such as these.</span></span>

- <span data-ttu-id="afbeb-153">2D: l'altezza "HW" &mdash; è la dimensione più ordinata (riga-principale).</span><span class="sxs-lookup"><span data-stu-id="afbeb-153">2D: "HW"&mdash;height is the highest-order dimension (row-major).</span></span>
- <span data-ttu-id="afbeb-154">2D: la larghezza "WH" &mdash; è la dimensione più alta (column-major).</span><span class="sxs-lookup"><span data-stu-id="afbeb-154">2D: "WH"&mdash;width is the highest-order dimension (column-major).</span></span>
- <span data-ttu-id="afbeb-155">3D: la profondità "ACS" &mdash; è la dimensione più ordinata, seguita dall'altezza e quindi dalla larghezza.</span><span class="sxs-lookup"><span data-stu-id="afbeb-155">3D: "DHW"&mdash;depth is the highest-order dimension, followed by height, and then width.</span></span>
- <span data-ttu-id="afbeb-156">3D: la larghezza "WHD" &mdash; è la dimensione più ordinata, seguita dall'altezza e quindi dalla profondità.</span><span class="sxs-lookup"><span data-stu-id="afbeb-156">3D: "WHD"&mdash;width is the highest-order dimension, followed by height, and then depth.</span></span>
- <span data-ttu-id="afbeb-157">4D: "NCHW" &mdash; il numero di immagini (dimensioni batch), il numero di canali, quindi l'altezza e poi la larghezza.</span><span class="sxs-lookup"><span data-stu-id="afbeb-157">4D: "NCHW"&mdash;the number of images (batch size), then the number of channels, then height, then width.</span></span>

<span data-ttu-id="afbeb-158">In generale, lo stride *compresso* di una dimensione è uguale al prodotto delle dimensioni delle dimensioni di ordine inferiore.</span><span class="sxs-lookup"><span data-stu-id="afbeb-158">In general, the *packed* stride of a dimension is equal to the product of the sizes of the lower-order dimensions.</span></span> <span data-ttu-id="afbeb-159">Ad esempio, con un layout "ACS", D-stride è uguale a H \* W; lo stride H è uguale a W; e il W-STRIDE è uguale a 1.</span><span class="sxs-lookup"><span data-stu-id="afbeb-159">For example, with a "DHW" layout, the D-stride is equal to H \* W; the H-stride is equal to W; and the W-stride is equal to 1.</span></span> <span data-ttu-id="afbeb-160">Si dice che gli stride vengono *compressi* quando la dimensione fisica totale del tensore è uguale alla dimensione logica totale del tensore; in altre parole, non c'è spazio aggiuntivo né elementi sovrapposti.</span><span class="sxs-lookup"><span data-stu-id="afbeb-160">Strides are said to be *packed* when the total physical size of the tensor is equal to the total logical size of the tensor; in other words, there's no extra space nor overlapping elements.</span></span>

<span data-ttu-id="afbeb-161">Si estenderà l'esempio 2D a tre dimensioni, in modo da avere un tensore con profondità 2, altezza 2 e larghezza 3 (per un totale di 12 elementi logici).</span><span class="sxs-lookup"><span data-stu-id="afbeb-161">Let's extend the 2D example to three dimensions, so that we have a tensor with depth 2, height 2, and width 3 (for a total of 12 logical elements).</span></span>

```console
A B C
D E F

G H I
J K L
```

<span data-ttu-id="afbeb-162">Con un layout di "ACS", questo tensore viene archiviato come segue.</span><span class="sxs-lookup"><span data-stu-id="afbeb-162">With a "DHW" layout, this tensor is stored as follows.</span></span>

<span data-ttu-id="afbeb-163">Offset:</span><span class="sxs-lookup"><span data-stu-id="afbeb-163">Offset:</span></span>|<span data-ttu-id="afbeb-164">0</span><span class="sxs-lookup"><span data-stu-id="afbeb-164">0</span></span>|<span data-ttu-id="afbeb-165">1</span><span class="sxs-lookup"><span data-stu-id="afbeb-165">1</span></span>|<span data-ttu-id="afbeb-166">2</span><span class="sxs-lookup"><span data-stu-id="afbeb-166">2</span></span>|<span data-ttu-id="afbeb-167">3</span><span class="sxs-lookup"><span data-stu-id="afbeb-167">3</span></span>|<span data-ttu-id="afbeb-168">4</span><span class="sxs-lookup"><span data-stu-id="afbeb-168">4</span></span>|<span data-ttu-id="afbeb-169">5</span><span class="sxs-lookup"><span data-stu-id="afbeb-169">5</span></span>|<span data-ttu-id="afbeb-170">6</span><span class="sxs-lookup"><span data-stu-id="afbeb-170">6</span></span>|<span data-ttu-id="afbeb-171">7</span><span class="sxs-lookup"><span data-stu-id="afbeb-171">7</span></span>|<span data-ttu-id="afbeb-172">8</span><span class="sxs-lookup"><span data-stu-id="afbeb-172">8</span></span>|<span data-ttu-id="afbeb-173">9</span><span class="sxs-lookup"><span data-stu-id="afbeb-173">9</span></span>|<span data-ttu-id="afbeb-174">10</span><span class="sxs-lookup"><span data-stu-id="afbeb-174">10</span></span>|<span data-ttu-id="afbeb-175">11</span><span class="sxs-lookup"><span data-stu-id="afbeb-175">11</span></span>|
-|-|-|-|-|-|-|-|-|-|-|-|-|
<span data-ttu-id="afbeb-176">Valore:</span><span class="sxs-lookup"><span data-stu-id="afbeb-176">Value:</span></span>|<span data-ttu-id="afbeb-177">A</span><span class="sxs-lookup"><span data-stu-id="afbeb-177">A</span></span>|<span data-ttu-id="afbeb-178">B</span><span class="sxs-lookup"><span data-stu-id="afbeb-178">B</span></span>|<span data-ttu-id="afbeb-179">C</span><span class="sxs-lookup"><span data-stu-id="afbeb-179">C</span></span>|<span data-ttu-id="afbeb-180">D</span><span class="sxs-lookup"><span data-stu-id="afbeb-180">D</span></span>|<span data-ttu-id="afbeb-181">E</span><span class="sxs-lookup"><span data-stu-id="afbeb-181">E</span></span>|<span data-ttu-id="afbeb-182">F</span><span class="sxs-lookup"><span data-stu-id="afbeb-182">F</span></span>|<span data-ttu-id="afbeb-183">G</span><span class="sxs-lookup"><span data-stu-id="afbeb-183">G</span></span>|<span data-ttu-id="afbeb-184">H</span><span class="sxs-lookup"><span data-stu-id="afbeb-184">H</span></span>|<span data-ttu-id="afbeb-185">I</span><span class="sxs-lookup"><span data-stu-id="afbeb-185">I</span></span>|<span data-ttu-id="afbeb-186">J</span><span class="sxs-lookup"><span data-stu-id="afbeb-186">J</span></span>|<span data-ttu-id="afbeb-187">K</span><span class="sxs-lookup"><span data-stu-id="afbeb-187">K</span></span>|<span data-ttu-id="afbeb-188">L</span><span class="sxs-lookup"><span data-stu-id="afbeb-188">L</span></span>|

- <span data-ttu-id="afbeb-189">D-stride = Height (2) \* Width (3) = 6 (ad esempio la distanza tra "A" e "G").</span><span class="sxs-lookup"><span data-stu-id="afbeb-189">D-stride = height (2) \* width (3) = 6 (for example, the distance between 'A' and 'G').</span></span>
- <span data-ttu-id="afbeb-190">H-stride = Width (3) = 3 (ad esempio la distanza tra' A ' è d').</span><span class="sxs-lookup"><span data-stu-id="afbeb-190">H-stride = width (3) = 3 (for example, the distance between 'A' and 'D').</span></span>
- <span data-ttu-id="afbeb-191">W-STRIDE = 1 (ad esempio la distanza tra "A" e "B").</span><span class="sxs-lookup"><span data-stu-id="afbeb-191">W-stride = 1 (for example, the distance between 'A' and 'B').</span></span>

<span data-ttu-id="afbeb-192">Il prodotto a virgola degli indici/coordinate di un elemento e degli stride fornisce l'offset a tale elemento nel buffer.</span><span class="sxs-lookup"><span data-stu-id="afbeb-192">The dot product of the indices/coordinates of an element and the strides provides the offset to that element in the buffer.</span></span> <span data-ttu-id="afbeb-193">Ad esempio, l'offset dell'elemento H (d = 1, H = 0, w = 1) è 7.</span><span class="sxs-lookup"><span data-stu-id="afbeb-193">For example, the offset of the H element (d=1, h=0, w=1) is 7.</span></span>

<span data-ttu-id="afbeb-194">{1, 0, 1} ⋅ {6, 3, 1} = 1 \* 6 + 0 \* 3 + 1 \* 1 = 7</span><span class="sxs-lookup"><span data-stu-id="afbeb-194">{1, 0, 1} ⋅ {6, 3, 1} = 1 \* 6 + 0 \* 3 + 1 \* 1 = 7</span></span>

## <a name="packed-tensors"></a><span data-ttu-id="afbeb-195">Tensori confezionati</span><span class="sxs-lookup"><span data-stu-id="afbeb-195">Packed tensors</span></span>

<span data-ttu-id="afbeb-196">Gli esempi precedenti illustrano i tensori *confezionati* .</span><span class="sxs-lookup"><span data-stu-id="afbeb-196">The examples above illustrate *packed* tensors.</span></span> <span data-ttu-id="afbeb-197">Si dice che un tensore viene *compresso* quando la dimensione logica del tensore (in elementi) è uguale alla dimensione fisica del buffer (in elementi) e ogni elemento ha un indirizzo/offset univoco.</span><span class="sxs-lookup"><span data-stu-id="afbeb-197">A tensor is said to be *packed* when the logical size of the tensor (in elements) is equal to the physical size of the buffer (in elements), and each element has a unique address/offset.</span></span> <span data-ttu-id="afbeb-198">Ad esempio, un tensore 2x2x3 viene compresso se il buffer ha una lunghezza di 12 elementi e nessuna coppia di elementi condivide lo stesso offset nel buffer.</span><span class="sxs-lookup"><span data-stu-id="afbeb-198">For example, a 2x2x3 tensor is packed if the buffer is 12 elements in length and no pair of elements share the same offset in the buffer.</span></span> <span data-ttu-id="afbeb-199">I tensori compressi sono i casi più comuni. ma gli stride consentono un layout di memoria più complesso.</span><span class="sxs-lookup"><span data-stu-id="afbeb-199">Packed tensors are the most common case; but strides allow more complex memory layouts.</span></span>

## <a name="broadcasting-with-strides"></a><span data-ttu-id="afbeb-200">Broadcast con stride</span><span class="sxs-lookup"><span data-stu-id="afbeb-200">Broadcasting with strides</span></span>

<span data-ttu-id="afbeb-201">Se le dimensioni del buffer di un tensore (in elementi) sono inferiori al prodotto delle dimensioni logiche, è necessario che sia presente una sovrapposizione di elementi.</span><span class="sxs-lookup"><span data-stu-id="afbeb-201">If a tensor's buffer size (in elements) is smaller than the product of its logical dimensions, then it follows that there must be some overlapping of elements.</span></span> <span data-ttu-id="afbeb-202">Il solito caso per questo è noto come *broadcasting*; dove gli elementi di una dimensione sono duplicati di un'altra dimensione.</span><span class="sxs-lookup"><span data-stu-id="afbeb-202">The usual case for this is known as *broadcasting*; where the elements of a dimension are a duplicate of another dimension.</span></span> <span data-ttu-id="afbeb-203">Ad esempio, è ora di rivedere l'esempio 2D.</span><span class="sxs-lookup"><span data-stu-id="afbeb-203">For example, let's revisit the 2D example.</span></span> <span data-ttu-id="afbeb-204">Supponiamo che si desideri un tensore logicamente 2x3, ma la seconda riga è identica alla prima riga.</span><span class="sxs-lookup"><span data-stu-id="afbeb-204">Let's say that we want a tensor that is logically 2x3, but the second row is identical to the first row.</span></span> <span data-ttu-id="afbeb-205">Ecco come appare.</span><span class="sxs-lookup"><span data-stu-id="afbeb-205">Here's how that looks.</span></span>

```console
A B C
A B C
```

<span data-ttu-id="afbeb-206">Questo può essere archiviato come un tensore HW/row-major compresso.</span><span class="sxs-lookup"><span data-stu-id="afbeb-206">This could be stored as a packed HW/row-major tensor.</span></span> <span data-ttu-id="afbeb-207">Tuttavia, una risorsa di archiviazione più compatta conterrà solo 3 elementi (A, B e C) e utilizzerà uno stride di altezza pari a 0 anziché 3.</span><span class="sxs-lookup"><span data-stu-id="afbeb-207">But a more compact storage would contain only 3 elements (A, B, and C) and use a height-stride of 0 instead of 3.</span></span> <span data-ttu-id="afbeb-208">In questo caso, le dimensioni fisiche del tensore sono 3 elementi, ma la dimensione logica è 6 elementi.</span><span class="sxs-lookup"><span data-stu-id="afbeb-208">In this case, the physical size of the tensor is 3 elements, but the logical size is 6 elements.</span></span>

<span data-ttu-id="afbeb-209">In generale, se lo stride di una dimensione è 0, tutti gli elementi nelle dimensioni di ordine inferiore vengono ripetuti lungo la dimensione broadcast; Se, ad esempio, il tensore è NCHW e C-stride è 0, ogni canale avrà gli stessi valori lungo H e W.</span><span class="sxs-lookup"><span data-stu-id="afbeb-209">In general, if the stride of a dimension is 0, then all elements in the lower-order dimensions are repeated along the broadcasted dimension; for example, if the tensor is NCHW and the C-stride is 0, then each channel has the same values along H and W.</span></span>

## <a name="padding-with-strides"></a><span data-ttu-id="afbeb-210">Riempimento con stride</span><span class="sxs-lookup"><span data-stu-id="afbeb-210">Padding with strides</span></span>

<span data-ttu-id="afbeb-211">Un tensore viene detto riempimento *se la* dimensione fisica è maggiore della dimensione minima necessaria per adattarsi ai propri elementi.</span><span class="sxs-lookup"><span data-stu-id="afbeb-211">A tensor is said to be *padded* if its physical size is larger than the minimum size needed to fit its elements.</span></span> <span data-ttu-id="afbeb-212">Quando non sono presenti elementi broadcast o sovrapposti, le dimensioni minime del tensore (in elementi) sono semplicemente il prodotto delle dimensioni.</span><span class="sxs-lookup"><span data-stu-id="afbeb-212">When there is no broadcasting nor overlapping elements, the minimum size of the tensor (in elements) is simply the product of its dimensions.</span></span> <span data-ttu-id="afbeb-213">È possibile usare la funzione helper `DMLCalcBufferTensorSize` (vedere le [funzioni helper DirectML](dml-helper-functions.md) per un elenco di tale funzione) per calcolare le dimensioni *minime* del buffer per i tensori DirectML.</span><span class="sxs-lookup"><span data-stu-id="afbeb-213">You can use the helper function `DMLCalcBufferTensorSize` (see [DirectML helper functions](dml-helper-functions.md) for a listing of that function) to calculate the *minimum* buffer size for your DirectML tensors.</span></span>

<span data-ttu-id="afbeb-214">Si immagini che un buffer contenga i valori seguenti (gli elementi ' x ' indicano i valori di spaziatura interna).</span><span class="sxs-lookup"><span data-stu-id="afbeb-214">Let's say that a buffer contains the following values (the 'x' elements indicate padding values).</span></span>

<span data-ttu-id="afbeb-215">0</span><span class="sxs-lookup"><span data-stu-id="afbeb-215">0</span></span>|<span data-ttu-id="afbeb-216">1</span><span class="sxs-lookup"><span data-stu-id="afbeb-216">1</span></span>|<span data-ttu-id="afbeb-217">2</span><span class="sxs-lookup"><span data-stu-id="afbeb-217">2</span></span>|<span data-ttu-id="afbeb-218">3</span><span class="sxs-lookup"><span data-stu-id="afbeb-218">3</span></span>|<span data-ttu-id="afbeb-219">4</span><span class="sxs-lookup"><span data-stu-id="afbeb-219">4</span></span>|<span data-ttu-id="afbeb-220">5</span><span class="sxs-lookup"><span data-stu-id="afbeb-220">5</span></span>|<span data-ttu-id="afbeb-221">6</span><span class="sxs-lookup"><span data-stu-id="afbeb-221">6</span></span>|<span data-ttu-id="afbeb-222">7</span><span class="sxs-lookup"><span data-stu-id="afbeb-222">7</span></span>|<span data-ttu-id="afbeb-223">8</span><span class="sxs-lookup"><span data-stu-id="afbeb-223">8</span></span>|<span data-ttu-id="afbeb-224">9</span><span class="sxs-lookup"><span data-stu-id="afbeb-224">9</span></span>|
-|-|-|-|-|-|-|-|-|-|
<span data-ttu-id="afbeb-225">A</span><span class="sxs-lookup"><span data-stu-id="afbeb-225">A</span></span>|<span data-ttu-id="afbeb-226">B</span><span class="sxs-lookup"><span data-stu-id="afbeb-226">B</span></span>|<span data-ttu-id="afbeb-227">C</span><span class="sxs-lookup"><span data-stu-id="afbeb-227">C</span></span>|<span data-ttu-id="afbeb-228">x</span><span class="sxs-lookup"><span data-stu-id="afbeb-228">x</span></span>|<span data-ttu-id="afbeb-229">x</span><span class="sxs-lookup"><span data-stu-id="afbeb-229">x</span></span>|<span data-ttu-id="afbeb-230">D</span><span class="sxs-lookup"><span data-stu-id="afbeb-230">D</span></span>|<span data-ttu-id="afbeb-231">E</span><span class="sxs-lookup"><span data-stu-id="afbeb-231">E</span></span>|<span data-ttu-id="afbeb-232">F</span><span class="sxs-lookup"><span data-stu-id="afbeb-232">F</span></span>|<span data-ttu-id="afbeb-233">x</span><span class="sxs-lookup"><span data-stu-id="afbeb-233">x</span></span>|<span data-ttu-id="afbeb-234">x</span><span class="sxs-lookup"><span data-stu-id="afbeb-234">x</span></span>

<span data-ttu-id="afbeb-235">Il tensore imbottito può essere descritto usando un stride di altezza pari a 5 anziché 3.</span><span class="sxs-lookup"><span data-stu-id="afbeb-235">The padded tensor can be described by using a height-stride of 5 instead of 3.</span></span> <span data-ttu-id="afbeb-236">Anziché eseguire un'istruzione per tre elementi per ottenere la riga successiva, il passaggio è 5 elementi (3 elementi *reali* più 2 elementi di riempimento).</span><span class="sxs-lookup"><span data-stu-id="afbeb-236">Instead of stepping by 3 elements to get to the next row, the step is 5 elements (3 *real* elements plus 2 padding elements).</span></span> <span data-ttu-id="afbeb-237">La spaziatura interna è comune nella grafica del computer, ad esempio, per garantire che un'immagine abbia un allineamento di potenza di due.</span><span class="sxs-lookup"><span data-stu-id="afbeb-237">Padding is common in computer graphics, for example, to ensure that an image has a power-of-two alignment.</span></span>

```console
A B C
D E F
```

## <a name="directml-buffer-tensor-descriptions"></a><span data-ttu-id="afbeb-238">Descrizioni del tensore del buffer DirectML</span><span class="sxs-lookup"><span data-stu-id="afbeb-238">DirectML buffer tensor descriptions</span></span>

<span data-ttu-id="afbeb-239">DirectML può funzionare con un'ampia gamma di layout di tensori fisici, perché la [struttura **DML_BUFFER_TENSOR_DESC**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) dispone di entrambi `Sizes` `Strides` i membri e.</span><span class="sxs-lookup"><span data-stu-id="afbeb-239">DirectML can work with a variety of physical tensor layouts, since the [**DML_BUFFER_TENSOR_DESC** structure](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) has both `Sizes` and `Strides` members.</span></span> <span data-ttu-id="afbeb-240">Alcune implementazioni di operatori potrebbero essere più efficienti con un layout specifico, quindi non è insolito modificare il modo in cui i dati del tensore vengono archiviati per ottenere prestazioni migliori.</span><span class="sxs-lookup"><span data-stu-id="afbeb-240">Some operator implementations might be more efficient with a specific layout, so it's not uncommon to change how tensor data is stored for better performance.</span></span>

<span data-ttu-id="afbeb-241">Per la maggior parte degli operatori DirectML sono richiesti i tensori 4D o 5D e l'ordine dei valori di dimensioni e stride è fisso.</span><span class="sxs-lookup"><span data-stu-id="afbeb-241">Most DirectML operators require either 4D or 5D tensors, and the order of the sizes and strides values is fixed.</span></span> <span data-ttu-id="afbeb-242">Correggendo l'ordine dei valori di dimensioni e stride in una descrizione del tensore, è possibile che DirectML induca diversi layout fisici.</span><span class="sxs-lookup"><span data-stu-id="afbeb-242">By fixing the order of the sizes and stride values in a tensor description, it's possible for DirectML to infer different physical layouts.</span></span>

<span data-ttu-id="afbeb-243">**4D**</span><span class="sxs-lookup"><span data-stu-id="afbeb-243">**4D**</span></span>
- <span data-ttu-id="afbeb-244">[**DML_BUFFER_TENSOR_DESC::**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) sizes = {N-size, C-size, H-size, W-size}</span><span class="sxs-lookup"><span data-stu-id="afbeb-244">[**DML_BUFFER_TENSOR_DESC::Sizes**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) = { N-size, C-size, H-size, W-size }</span></span>
- <span data-ttu-id="afbeb-245">[**DML_BUFFER_TENSOR_DESC:: Strides**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) = {N-stride, C-stride, H-stride, W-STRIDE}</span><span class="sxs-lookup"><span data-stu-id="afbeb-245">[**DML_BUFFER_TENSOR_DESC::Strides**](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc) = { N-stride, C-stride, H-stride, W-stride }</span></span>

<span data-ttu-id="afbeb-246">**5D**</span><span class="sxs-lookup"><span data-stu-id="afbeb-246">**5D**</span></span>
- <span data-ttu-id="afbeb-247">**DML_BUFFER_TENSOR_DESC::** sizes = {N-size, C-size, D-size, H-size, W-size}</span><span class="sxs-lookup"><span data-stu-id="afbeb-247">**DML_BUFFER_TENSOR_DESC::Sizes** = { N-size, C-size, D-size, H-size, W-size }</span></span>
- <span data-ttu-id="afbeb-248">**DML_BUFFER_TENSOR_DESC:: Strides** = {N-stride, C-stride, D-stride, H-stride, W-STRIDE}</span><span class="sxs-lookup"><span data-stu-id="afbeb-248">**DML_BUFFER_TENSOR_DESC::Strides** = { N-stride, C-stride, D-stride, H-stride, W-stride }</span></span>

<span data-ttu-id="afbeb-249">Se un operatore DirectML richiede un tensore 4D o 5D, ma i dati effettivi hanno un rango inferiore (ad esempio, 2D), le dimensioni iniziali devono essere riempite con 1s.</span><span class="sxs-lookup"><span data-stu-id="afbeb-249">If a DirectML operator requires a 4D or a 5D tensor, but the actual data has a smaller rank (for example, 2D), then the leading dimensions should be filled with 1s.</span></span> <span data-ttu-id="afbeb-250">Ad esempio, un tensore "HW" viene impostato usando **DML_BUFFER_TENSOR_DESC:: sizes** = {1, 1, H, W}.</span><span class="sxs-lookup"><span data-stu-id="afbeb-250">For example, an "HW" tensor is set using **DML_BUFFER_TENSOR_DESC::Sizes** = { 1, 1, H, W }.</span></span>

<span data-ttu-id="afbeb-251">Se i dati del tensore sono archiviati in NCHW/NCDHW, non è necessario impostare **DML_BUFFER_TENSOR_DESC:: Strides**, a meno che non si desideri trasmettere o riempire.</span><span class="sxs-lookup"><span data-stu-id="afbeb-251">If tensor data is stored in NCHW/NCDHW, then it's not necessary to set **DML_BUFFER_TENSOR_DESC::Strides**, unless you want broadcasting or padding.</span></span> <span data-ttu-id="afbeb-252">È possibile impostare il campo Strides su `nullptr` .</span><span class="sxs-lookup"><span data-stu-id="afbeb-252">You can set the strides field to `nullptr`.</span></span> <span data-ttu-id="afbeb-253">Tuttavia, se i dati del tensore sono archiviati in un altro layout, ad esempio NHWC, sono necessari stride per esprimere la trasformazione da NCHW a tale layout.</span><span class="sxs-lookup"><span data-stu-id="afbeb-253">However, if the tensor data is stored in another layout, such as NHWC, then you need strides in order to express the transformation from NCHW to that layout.</span></span>

<span data-ttu-id="afbeb-254">Per un esempio semplice, si consideri la descrizione di un tensore 2D con altezza 3 e larghezza 5.</span><span class="sxs-lookup"><span data-stu-id="afbeb-254">For a simple example, consider the description of a 2D tensor with height 3 and width 5.</span></span>

<span data-ttu-id="afbeb-255">**NCHW compresso (stride impliciti)**</span><span class="sxs-lookup"><span data-stu-id="afbeb-255">**Packed NCHW (implicit strides)**</span></span>
- <span data-ttu-id="afbeb-256">**DML_BUFFER_TENSOR_DESC:: sizes** = {1, 1, 3, 5}</span><span class="sxs-lookup"><span data-stu-id="afbeb-256">**DML_BUFFER_TENSOR_DESC::Sizes** = { 1, 1, 3, 5 }</span></span>
- <span data-ttu-id="afbeb-257">**DML_BUFFER_TENSOR_DESC:: stride** = `nullptr`</span><span class="sxs-lookup"><span data-stu-id="afbeb-257">**DML_BUFFER_TENSOR_DESC::Strides** = `nullptr`</span></span>

<span data-ttu-id="afbeb-258">**NCHW compresso (stride espliciti)**</span><span class="sxs-lookup"><span data-stu-id="afbeb-258">**Packed NCHW (explicit strides)**</span></span>
- <span data-ttu-id="afbeb-259">N-stride = C-size \* H-size \* W-size = 1 \* 3 \* 5 = 15</span><span class="sxs-lookup"><span data-stu-id="afbeb-259">N-stride = C-size \* H-size \* W-size = 1 \* 3 \* 5 = 15</span></span>
- <span data-ttu-id="afbeb-260">C-stride = H-size \* W-size = 3 \* 5 = 15</span><span class="sxs-lookup"><span data-stu-id="afbeb-260">C-stride = H-size \* W-size = 3 \* 5 = 15</span></span>
- <span data-ttu-id="afbeb-261">H-stride = W-size = 5</span><span class="sxs-lookup"><span data-stu-id="afbeb-261">H-stride = W-size = 5</span></span>
- <span data-ttu-id="afbeb-262">W-STRIDE = 1</span><span class="sxs-lookup"><span data-stu-id="afbeb-262">W-stride = 1</span></span>
- <span data-ttu-id="afbeb-263">**DML_BUFFER_TENSOR_DESC:: sizes** = {1, 1, 3, 5}</span><span class="sxs-lookup"><span data-stu-id="afbeb-263">**DML_BUFFER_TENSOR_DESC::Sizes** = { 1, 1, 3, 5 }</span></span>
- <span data-ttu-id="afbeb-264">**DML_BUFFER_TENSOR_DESC:: Strides** = {15, 15, 5, 1}</span><span class="sxs-lookup"><span data-stu-id="afbeb-264">**DML_BUFFER_TENSOR_DESC::Strides** = { 15, 15, 5, 1 }</span></span>

<span data-ttu-id="afbeb-265">**NHWC compresso**</span><span class="sxs-lookup"><span data-stu-id="afbeb-265">**Packed NHWC**</span></span>
- <span data-ttu-id="afbeb-266">N-stride = H-size \* W-size \* C-size = 3 \* 5 \* 1 = 15</span><span class="sxs-lookup"><span data-stu-id="afbeb-266">N-stride = H-size \* W-size \* C-size = 3 \* 5 \* 1 = 15</span></span>
- <span data-ttu-id="afbeb-267">H-stride = W-size \* C-size = 5 \* 1 = 5</span><span class="sxs-lookup"><span data-stu-id="afbeb-267">H-stride = W-size \* C-size = 5 \* 1 = 5</span></span>
- <span data-ttu-id="afbeb-268">W-STRIDE = C-size = 1</span><span class="sxs-lookup"><span data-stu-id="afbeb-268">W-stride = C-size = 1</span></span>
- <span data-ttu-id="afbeb-269">C-stride = 1</span><span class="sxs-lookup"><span data-stu-id="afbeb-269">C-stride = 1</span></span>
- <span data-ttu-id="afbeb-270">**DML_BUFFER_TENSOR_DESC:: sizes** = {1, 1, 3, 5}</span><span class="sxs-lookup"><span data-stu-id="afbeb-270">**DML_BUFFER_TENSOR_DESC::Sizes** = { 1, 1, 3, 5 }</span></span>
- <span data-ttu-id="afbeb-271">**DML_BUFFER_TENSOR_DESC:: Strides** = {15, 1, 5, 1}</span><span class="sxs-lookup"><span data-stu-id="afbeb-271">**DML_BUFFER_TENSOR_DESC::Strides** = { 15, 1, 5, 1 }</span></span>

## <a name="see-also"></a><span data-ttu-id="afbeb-272">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="afbeb-272">See also</span></span>

* [<span data-ttu-id="afbeb-273">Funzioni helper DirectML</span><span class="sxs-lookup"><span data-stu-id="afbeb-273">DirectML helper functions</span></span>](dml-helper-functions.md)
* [<span data-ttu-id="afbeb-274">Struttura DML_BUFFER_TENSOR_DESC</span><span class="sxs-lookup"><span data-stu-id="afbeb-274">DML_BUFFER_TENSOR_DESC structure</span></span>](/windows/desktop/api/directml/ns-directml-dml_buffer_tensor_desc)
