---
title: Scambia catene
description: Le catene di scambio controllano la rotazione del buffer indietro, formando la base dell'animazione grafica.
ms.assetid: AABF5FDE-DB49-4B29-BC0E-032E0C7DF9EB
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ebbc7ec1b62ba620b42bc85c1c1f491ff7ba952d
ms.sourcegitcommit: 5b98bf8c68922f8f03c14f793fbe17504900559c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/12/2021
ms.locfileid: "104548839"
---
# <a name="swap-chains"></a><span data-ttu-id="b6c47-103">Scambia catene</span><span class="sxs-lookup"><span data-stu-id="b6c47-103">Swap Chains</span></span>

<span data-ttu-id="b6c47-104">Le catene di scambio controllano la rotazione del buffer indietro, formando la base dell'animazione grafica.</span><span class="sxs-lookup"><span data-stu-id="b6c47-104">Swap chains control the back buffer rotation, forming the basis of graphics animation.</span></span>

## <a name="overview"></a><span data-ttu-id="b6c47-105">Panoramica</span><span class="sxs-lookup"><span data-stu-id="b6c47-105">Overview</span></span>

<span data-ttu-id="b6c47-106">Il modello di programmazione per le catene di scambio in Direct3D 12 non è identico a quello delle versioni precedenti di D3D.</span><span class="sxs-lookup"><span data-stu-id="b6c47-106">The programming model for swap chains in Direct3D 12 is not identical to that in earlier versions of D3D.</span></span> <span data-ttu-id="b6c47-107">La praticità di programmazione, ad esempio, di supportare la rotazione automatica delle risorse che era presente in D3D10 e D3D11 non è ora supportata.</span><span class="sxs-lookup"><span data-stu-id="b6c47-107">The programming convenience, for example, of supporting automatic resource rotation that was present in D3D10 and D3D11 is not now supported.</span></span> <span data-ttu-id="b6c47-108">App automatiche con rotazione delle risorse abilitate per il rendering dello stesso oggetto API mentre la superficie effettiva di cui viene eseguito il rendering cambia ogni frame.</span><span class="sxs-lookup"><span data-stu-id="b6c47-108">Automatic resource rotation enabled apps to render the same API object while the actual surface being rendered changes each frame.</span></span> <span data-ttu-id="b6c47-109">Il comportamento delle catene di scambio è stato modificato con Direct3D 12 per consentire ad altre funzionalità di Direct3D 12 di avere un sovraccarico della CPU ridotto.</span><span class="sxs-lookup"><span data-stu-id="b6c47-109">The behavior of swap chains is changed with Direct3D 12 to enable other features of Direct3D 12 to have low CPU overhead.</span></span> <span data-ttu-id="b6c47-110">La chiave di colore automatica e il campionamento multiplo non sono supportati, anche se in particolare l'allungamento e la rotazione sono ancora.</span><span class="sxs-lookup"><span data-stu-id="b6c47-110">Automatic color key and multisampling are not supported, although notably stretching and rotation still are.</span></span>

### <a name="buffer-lifetime"></a><span data-ttu-id="b6c47-111">Durata buffer</span><span class="sxs-lookup"><span data-stu-id="b6c47-111">Buffer lifetime</span></span>

<span data-ttu-id="b6c47-112">Le app sono autorizzate a archiviare descrittori creati in precedenza che fanno riferimento a buffer indietro questo è abilitato garantendo che il set di buffer di proprietà di una catena di scambio non cambi mai per la durata della catena di scambio.</span><span class="sxs-lookup"><span data-stu-id="b6c47-112">Apps are allowed to store pre-created descriptors which reference back buffers This is enabled by ensuring that the set of buffers owned by a swap chain never changes for the lifetime of the swap chain.</span></span> <span data-ttu-id="b6c47-113">Il set di buffer restituito da [**IDXGISwapChain:: GetBuffer**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getbuffer) non cambia fino a quando non vengono chiamate determinate API:</span><span class="sxs-lookup"><span data-stu-id="b6c47-113">The set of buffers returned by [**IDXGISwapChain::GetBuffer**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getbuffer) doesn't change until certain APIs are called:</span></span>

-   [<span data-ttu-id="b6c47-114">**IDXGISwapChain::ResizeTarget**</span><span class="sxs-lookup"><span data-stu-id="b6c47-114">**IDXGISwapChain::ResizeTarget**</span></span>](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget)
-   [<span data-ttu-id="b6c47-115">**IDXGISwapChain::ResizeBuffers**</span><span class="sxs-lookup"><span data-stu-id="b6c47-115">**IDXGISwapChain::ResizeBuffers**</span></span>](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers)

<span data-ttu-id="b6c47-116">L'ordine dei buffer restituiti da [**GetBuffer**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getbuffer) non viene mai modificato.</span><span class="sxs-lookup"><span data-stu-id="b6c47-116">The order of buffers returned by [**GetBuffer**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getbuffer) never changes.</span></span>

<span data-ttu-id="b6c47-117">[**IDXGISwapChain3:: GetCurrentBackBufferIndex**](/windows/desktop/api/dxgi1_4/nf-dxgi1_4-idxgiswapchain3-getcurrentbackbufferindex) restituisce l'indice del buffer nascosto corrente all'app.</span><span class="sxs-lookup"><span data-stu-id="b6c47-117">[**IDXGISwapChain3::GetCurrentBackBufferIndex**](/windows/desktop/api/dxgi1_4/nf-dxgi1_4-idxgiswapchain3-getcurrentbackbufferindex) returns the index of the current back buffer to the app.</span></span>

### <a name="swap-effects"></a><span data-ttu-id="b6c47-118">Effetti swap</span><span class="sxs-lookup"><span data-stu-id="b6c47-118">Swap effects</span></span>

<span data-ttu-id="b6c47-119">Gli unici effetti di scambio supportati sono [**DXGI_SWAP_EFFECT_FLIP_SEQUENTIAL**](/windows/win32/api/dxgi/ne-dxgi-dxgi_swap_effect) e [**DXGI_SWAP_EFFECT_FLIP_DISCARD**](/windows/win32/api/dxgi/ne-dxgi-dxgi_swap_effect), che richiede che il conteggio del buffer sia maggiore di uno.</span><span class="sxs-lookup"><span data-stu-id="b6c47-119">The only supported swap effects are [**DXGI_SWAP_EFFECT_FLIP_SEQUENTIAL**](/windows/win32/api/dxgi/ne-dxgi-dxgi_swap_effect) and [**DXGI_SWAP_EFFECT_FLIP_DISCARD**](/windows/win32/api/dxgi/ne-dxgi-dxgi_swap_effect), which requires the buffer count to be greater than one.</span></span>

### <a name="transitioning-between-windowed-and-full-screen-modes"></a><span data-ttu-id="b6c47-120">Transizione tra modalità a finestra e a schermo intero</span><span class="sxs-lookup"><span data-stu-id="b6c47-120">Transitioning between windowed and full-screen modes</span></span>

<span data-ttu-id="b6c47-121">Direct3D 12 non supporta la modalità esclusiva a schermo intero (FSE).</span><span class="sxs-lookup"><span data-stu-id="b6c47-121">Direct3D 12 doesn't support full-screen exclusive mode (FSE).</span></span> <span data-ttu-id="b6c47-122">Al contrario, quando un gioco è l'unica applicazione visibile sullo schermo, il sistema operativo usa una strategia denominata ottimizzazioni a schermo intero (FSO) per ottenere un effetto simile a FSE senza svantaggi delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="b6c47-122">Instead, when a game is the only visible application on-screen, the OS uses a strategy called full-screen optimisations (FSO) to achieve a similar effect to FSE without the performance drawbacks.</span></span> <span data-ttu-id="b6c47-123">Per ulteriori informazioni su FSO, vedere [demistificazione di ottimizzazioni a schermo intero](https://devblogs.microsoft.com/directx/demystifying-full-screen-optimizations/).</span><span class="sxs-lookup"><span data-stu-id="b6c47-123">For more info about FSO, see [Demystifying Fullscreen Optimisations](https://devblogs.microsoft.com/directx/demystifying-full-screen-optimizations/).</span></span>

<span data-ttu-id="b6c47-124">Direct3D 12 mantiene la restrizione che le applicazioni devono chiamare [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) dopo la transizione tra le modalità a schermo intero e a schermo intero (le catene di scambio d3d11 flip-model hanno le stesse restrizioni).</span><span class="sxs-lookup"><span data-stu-id="b6c47-124">Direct3D 12 maintains the restriction that applications must call [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) after transitioning between windowed and full-screen modes (D3D11 flip-model swap chains have the same restrictions).</span></span>

<span data-ttu-id="b6c47-125">Le transizioni [**IDXGISwapChain:: SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) non modificano il set di buffer visibili per l'app nella catena di scambio.</span><span class="sxs-lookup"><span data-stu-id="b6c47-125">The [**IDXGISwapChain::SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) transitions do not change the set of app-visible buffers in the swap chain.</span></span> <span data-ttu-id="b6c47-126">Solo le chiamate [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) e [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) creano o eliminano i buffer visibili per l'app.</span><span class="sxs-lookup"><span data-stu-id="b6c47-126">Only the [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) and [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) calls create or destroy app-visible buffers.</span></span> <span data-ttu-id="b6c47-127">Tuttavia, in Direct3D 12 [**IDXGISwapChain:: SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) non entra in modalità esclusiva a schermo intero e modifica semplicemente le risoluzioni e le frequenze di aggiornamento per consentire le ottimizzazioni a schermo intero.</span><span class="sxs-lookup"><span data-stu-id="b6c47-127">However, in Direct3D 12 [**IDXGISwapChain::SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) doesn't enter full-screen exclusive mode, and simply changes resolutions and refresh rates to allow full-screen optimisations.</span></span> <span data-ttu-id="b6c47-128">Queste modifiche possono essere apportate da un'app senza usare questo metodo</span><span class="sxs-lookup"><span data-stu-id="b6c47-128">These changes can be made by an app without the use of this method</span></span>

<span data-ttu-id="b6c47-129">When o [**IDXGISwapChain::P**](/windows/win32/api/dxgi/nf-dxgi-idxgiswapchain-present) restart o [**IDXGISwapChain1::P**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgiswapchain1-present1) reinviate viene chiamato, il buffer nascosto da presentare deve trovarsi nello stato della [**\_ risorsa \_ \_ D3D12**](/windows/desktop/api/d3d12/ne-d3d12-d3d12_resource_states) .</span><span class="sxs-lookup"><span data-stu-id="b6c47-129">When or [**IDXGISwapChain::Present**](/windows/win32/api/dxgi/nf-dxgi-idxgiswapchain-present) or [**IDXGISwapChain1::Present**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgiswapchain1-present1) is called, the back buffer to be presented must be in the [**D3D12\_RESOURCE\_STATE\_PRESENT**](/windows/desktop/api/d3d12/ne-d3d12-d3d12_resource_states) state.</span></span> <span data-ttu-id="b6c47-130">La presente operazione avrà esito negativo con la **\_ chiamata di errore DXGI \_ non valida \_** in caso contrario.</span><span class="sxs-lookup"><span data-stu-id="b6c47-130">Present will fail with **DXGI\_ERROR\_INVALID\_CALL** if this is not the case.</span></span>

<span data-ttu-id="b6c47-131">Le catene di scambio a schermo intero continuano a avere la restrizione che [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate)(false, null) deve essere chiamato prima della versione finale della catena di scambio.</span><span class="sxs-lookup"><span data-stu-id="b6c47-131">Full-screen swap chains continue to have the restriction that [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate)(FALSE, NULL) must be called before the final release of the swap chain.</span></span> <span data-ttu-id="b6c47-132">**SetFullscreenState**(false) ha esito positivo sulle catene di scambio in esecuzione su dispositivi Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="b6c47-132">**SetFullscreenState**(FALSE) succeeds on swap chains running on Direct3D 12 devices.</span></span>

<span data-ttu-id="b6c47-133">Le operazioni presenti si verificano nella coda 3D fornita al momento della creazione del presentazione catena e le app possono presentare contemporaneamente più catene di scambio e registrare ed eseguire elenchi di comandi.</span><span class="sxs-lookup"><span data-stu-id="b6c47-133">Present operations occur on the 3D queue provided at swapchain creation, and apps are free to concurrently present multiple swap chains, and record and execute command lists.</span></span>

<span data-ttu-id="b6c47-134">Quando la parte finale del lavoro grafico (ad esempio, la post-elaborazione dei frame) viene eseguita in una coda di calcolo o non interessa la coda grafica del dispositivo, la creazione di una seconda coda 3D da presentare può risultare utile e impedire la latenza di presentazione che ritarda l'avvio del frame successivo.</span><span class="sxs-lookup"><span data-stu-id="b6c47-134">When the final part of the graphics work (for example, frame postprocessing) is done on a compute queue, or doesn't involve the device's graphics queue, creating a second 3D queue to present on can be beneficial and prevent the latency of presentation delaying the start of the next frame.</span></span> 

### <a name="example"></a><span data-ttu-id="b6c47-135">Esempio</span><span class="sxs-lookup"><span data-stu-id="b6c47-135">Example</span></span>

<span data-ttu-id="b6c47-136">Il codice di esempio seguente sarà presente nel ciclo di rendering principale:</span><span class="sxs-lookup"><span data-stu-id="b6c47-136">The following example code would be present in the main rendering loop:</span></span>

```cpp
void Present()
{
    m_swapChain->Present(0, m_presentFlags);
    m_backBufferIndex = (m_backBufferIndex + 1) % m_backBufferCount;
}
```

### <a name="creating-swap-chains"></a><span data-ttu-id="b6c47-137">Creazione di catene di scambio</span><span class="sxs-lookup"><span data-stu-id="b6c47-137">Creating swap chains</span></span>

<span data-ttu-id="b6c47-138">Quando si usano le chiamate a [**CreateSwapChainForHwnd**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd), [**CreateSwapChainForCoreWindow**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcorewindow)o [**CreateSwapChainForComposition**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcomposition) , si noti che il parametro *PDEVICE* richiede effettivamente un puntatore a una coda di comandi diretta in Direct3D 12 e non a un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b6c47-138">When using the [**CreateSwapChainForHwnd**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd), [**CreateSwapChainForCoreWindow**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcorewindow), or [**CreateSwapChainForComposition**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcomposition) calls, note that the *pDevice* parameter actually requires a pointer to a direct command queue in Direct3D 12, and not a device.</span></span>

### <a name="presenting-on-windows-7"></a><span data-ttu-id="b6c47-139">Presentazione su Windows 7</span><span class="sxs-lookup"><span data-stu-id="b6c47-139">Presenting on Windows 7</span></span>

<span data-ttu-id="b6c47-140">Quando la destinazione è Direct3D 12 in Windows 7, i tipi di DXGI necessari per Direct3D 12 non sono presenti, quindi è necessario usare il **ID3D12CommandQueueDownLevel** fornito da D3D12On7 (sottoposto a query dalla coda dei comandi diretta) per presentare.</span><span class="sxs-lookup"><span data-stu-id="b6c47-140">When targeting Direct3D 12 on Windows 7, the necessary DXGI types for Direct3D 12 are not present, so you must use the D3D12On7-provided **ID3D12CommandQueueDownLevel** (queried off of the direct command queue) to present.</span></span>

<span data-ttu-id="b6c47-141">Si fornisce un elenco di comandi aperti al metodo Windows 7 presente, che verrà quindi usato, chiuso e inviato automaticamente al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b6c47-141">You provide an open command list to the Windows 7 present method, which will then be used, closed, and automatically submitted to the device for you.</span></span> <span data-ttu-id="b6c47-142">È necessario fornire un buffer nascosto che deve essere creato dall'app, deve essere una risorsa di cui è stato eseguito il commit, deve essere un singolo campionamento e deve essere uno dei formati seguenti.</span><span class="sxs-lookup"><span data-stu-id="b6c47-142">You must provide a back buffer which must be app-created, must be a committed resource, must be single-sampled, and must be one of the following formats.</span></span>

* <span data-ttu-id="b6c47-143">**DXGI_FORMAT_R16G16B16A16_FLOAT**</span><span class="sxs-lookup"><span data-stu-id="b6c47-143">**DXGI_FORMAT_R16G16B16A16_FLOAT**</span></span>
* <span data-ttu-id="b6c47-144">**DXGI_FORMAT_R10G10B10A2_UNORM**</span><span class="sxs-lookup"><span data-stu-id="b6c47-144">**DXGI_FORMAT_R10G10B10A2_UNORM**</span></span>
* <span data-ttu-id="b6c47-145">**DXGI_FORMAT_R8G8B8A8_UNORM**</span><span class="sxs-lookup"><span data-stu-id="b6c47-145">**DXGI_FORMAT_R8G8B8A8_UNORM**</span></span>
* <span data-ttu-id="b6c47-146">**DXGI_FORMAT_R8G8B8A8_UNORM_SRGB**</span><span class="sxs-lookup"><span data-stu-id="b6c47-146">**DXGI_FORMAT_R8G8B8A8_UNORM_SRGB**</span></span>
* <span data-ttu-id="b6c47-147">**DXGI_FORMAT_B8G8R8X8_UNORM**</span><span class="sxs-lookup"><span data-stu-id="b6c47-147">**DXGI_FORMAT_B8G8R8X8_UNORM**</span></span>
* <span data-ttu-id="b6c47-148">**DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM**</span><span class="sxs-lookup"><span data-stu-id="b6c47-148">**DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM**</span></span>
* <span data-ttu-id="b6c47-149">**DXGI_FORMAT_B8G8R8A8_UNORM**</span><span class="sxs-lookup"><span data-stu-id="b6c47-149">**DXGI_FORMAT_B8G8R8A8_UNORM**</span></span>
* <span data-ttu-id="b6c47-150">**DXGI_FORMAT_B8G8R8A8_UNORM_SRGB**</span><span class="sxs-lookup"><span data-stu-id="b6c47-150">**DXGI_FORMAT_B8G8R8A8_UNORM_SRGB**</span></span>

## <a name="related-topics"></a><span data-ttu-id="b6c47-151">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="b6c47-151">Related topics</span></span>

* [<span data-ttu-id="b6c47-152">D3D12_HEAP_FLAGS</span><span class="sxs-lookup"><span data-stu-id="b6c47-152">D3D12_HEAP_FLAGS</span></span>](/windows/win32/api/d3d12/ne-d3d12-d3d12_heap_flags)
* [<span data-ttu-id="b6c47-153">Esercitazioni video su DirectX Advanced Learning: framerate non limitato</span><span class="sxs-lookup"><span data-stu-id="b6c47-153">DirectX advanced learning video tutorials : Unthrottled Framerate</span></span>](https://www.youtube.com/watch?v=wn02zCXa9IU)
* [<span data-ttu-id="b6c47-154">Rendering</span><span class="sxs-lookup"><span data-stu-id="b6c47-154">Rendering</span></span>](rendering.md)
